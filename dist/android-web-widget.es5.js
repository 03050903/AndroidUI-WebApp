"use strict";var _get=function get(_x39,_x40,_x41){var _again=true;_function: while(_again) {var object=_x39,property=_x40,receiver=_x41;desc = parent = getter = undefined;_again = false;if(object === null)object = Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc === undefined){var parent=Object.getPrototypeOf(object);if(parent === null){return undefined;}else {_x39 = parent;_x40 = property;_x41 = receiver;_again = true;continue _function;}}else if("value" in desc){return desc.value;}else {var getter=desc.get;if(getter === undefined){return undefined;}return getter.call(receiver);}}};var _createClass=(function(){function defineProperties(target,props){for(var i=0;i < props.length;i++) {var descriptor=props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if("value" in descriptor)descriptor.writable = true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};})();function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i < arr.length;i++) arr2[i] = arr[i];return arr2;}else {return Array.from(arr);}}function _inherits(subClass,superClass){if(typeof superClass !== "function" && superClass !== null){throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);}subClass.prototype = Object.create(superClass && superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__ = superClass;}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}var android;(function(android){var util;(function(util){var SparseArray=(function(){function SparseArray(initialCapacity){_classCallCheck(this,SparseArray);this.map = new Map();}_createClass(SparseArray,[{key:"clone",value:function clone(){var clone=new SparseArray();clone.map = new Map(this.map);return clone;}},{key:"get",value:function get(key){var valueIfKeyNotFound=arguments.length <= 1 || arguments[1] === undefined?null:arguments[1];var value=this.map.get(key);if(value === undefined)return valueIfKeyNotFound;return value;}},{key:"delete",value:function _delete(key){this.map["delete"](key);}},{key:"remove",value:function remove(key){this["delete"](key);}},{key:"removeAt",value:function removeAt(index){this.removeAtRange(index);}},{key:"removeAtRange",value:function removeAtRange(index){var size=arguments.length <= 1 || arguments[1] === undefined?1:arguments[1];var keys=[].concat(_toConsumableArray(this.map.keys()));var end=Math.min(this.map.size,index + size);for(var i=index;i < end;i++) {this.map["delete"](keys[i]);}}},{key:"put",value:function put(key,value){this.map.set(key,value);}},{key:"size",value:function size(){return this.map.size;}},{key:"keyAt",value:function keyAt(index){return [].concat(_toConsumableArray(this.map.keys()))[index];}},{key:"valueAt",value:function valueAt(index){return [].concat(_toConsumableArray(this.map.values()))[index];}},{key:"setValueAt",value:function setValueAt(index,value){var key=this.keyAt(index);this.map.set(key,value);}},{key:"indexOfKey",value:function indexOfKey(key){return [].concat(_toConsumableArray(this.map.keys())).indexOf(key);}},{key:"indexOfValue",value:function indexOfValue(value){return [].concat(_toConsumableArray(this.map.values())).indexOf(value);}},{key:"clear",value:function clear(){this.map.clear();}},{key:"append",value:function append(key,value){this.put(key,value);}}]);return SparseArray;})();util.SparseArray = SparseArray;})(util = android.util || (android.util = {}));})(android || (android = {}));var android;(function(android){var util;(function(util){var Log=(function(){function Log(){_classCallCheck(this,Log);}_createClass(Log,null,[{key:"getPriorityString",value:function getPriorityString(priority){if(priority > Log.PriorityString.length)return "";return Log.PriorityString[priority - 2];}},{key:"v",value:function v(tag,msg,tr){console.log(Log.getLogMsg(Log.VERBOSE,tag,msg));if(tr)console.log(tr);}},{key:"d",value:function d(tag,msg){console.debug(Log.getLogMsg(Log.DEBUG,tag,msg));}},{key:"i",value:function i(tag,msg,tr){console.info(Log.getLogMsg(Log.INFO,tag,msg));if(tr)console.info(tr);}},{key:"w",value:function w(tag,msg,tr){console.warn(Log.getLogMsg(Log.WARN,tag,msg));if(tr)console.warn(tr);}},{key:"e",value:function e(tag,msg,tr){console.error(Log.getLogMsg(Log.ERROR,tag,msg));if(tr)console.error(tr);}},{key:"getLogMsg",value:function getLogMsg(priority,tag,msg){var d=new Date();var dateFormat=d.toLocaleTimeString() + '.' + d.getUTCMilliseconds();return "[" + Log.getPriorityString(priority) + "] " + dateFormat + " \t " + tag + " \t " + msg;}}]);return Log;})();Log.View_DBG = false;Log.VelocityTracker_DBG = false;Log.VERBOSE = 2;Log.DEBUG = 3;Log.INFO = 4;Log.WARN = 5;Log.ERROR = 6;Log.ASSERT = 7;Log.PriorityString = ["VERBOSE","DEBUG","INFO","WARN","ERROR","ASSERT"];util.Log = Log;})(util = android.util || (android.util = {}));})(android || (android = {}));var java;(function(java){var lang;(function(lang){var StringBuilder=(function(){function StringBuilder(arg){_classCallCheck(this,StringBuilder);this.array = [];if(!Number.isInteger(arg) && arg){this.append(arg);}}_createClass(StringBuilder,[{key:"length",value:function length(){return this.array.length;}},{key:"append",value:function append(str){var _array;str = str + "";(_array = this.array).push.apply(_array,_toConsumableArray(str.split('')));return this;}},{key:"setLength",value:function setLength(length){var arrayLength=this.array.length;if(length === arrayLength)return;if(length < arrayLength){this.array = this.array.splice(length,arrayLength - length);}else {for(var i=0;i < arrayLength - length;i++) {this.array.push(' ');}}}},{key:"toString",value:function toString(){return this.array.join("");}}]);return StringBuilder;})();lang.StringBuilder = StringBuilder;})(lang = java.lang || (java.lang = {}));})(java || (java = {})); ///<reference path="../../java/lang/StringBuilder.ts"/>
var android;(function(android){var graphics;(function(graphics){var StringBuilder=java.lang.StringBuilder;var Rect=(function(){function Rect(){_classCallCheck(this,Rect);this.left = 0;this.top = 0;this.right = 0;this.bottom = 0;for(var _len=arguments.length,args=Array(_len),_key=0;_key < _len;_key++) {args[_key] = arguments[_key];}if(args.length === 1){var rect=args[0];this.left = rect.left;this.top = rect.top;this.right = rect.right;this.bottom = rect.bottom;}else if(args.length === 4 || args.length === 0){var _args$0=args[0];var left=_args$0 === undefined?0:_args$0;var _args$1=args[1];var _top=_args$1 === undefined?0:_args$1;var _args$2=args[2];var right=_args$2 === undefined?0:_args$2;var _args$3=args[3];var bottom=_args$3 === undefined?0:_args$3;this.left = left;this.top = _top;this.right = right;this.bottom = bottom;}}_createClass(Rect,[{key:"equals",value:function equals(r){if(this === r)return true;if(!r || !(r instanceof Rect))return false;return this.left === r.left && this.top === r.top && this.right === r.right && this.bottom === r.bottom;}},{key:"toString",value:function toString(){var sb=new StringBuilder();sb.append("Rect(");sb.append(this.left);sb.append(", ");sb.append(this.top);sb.append(" - ");sb.append(this.right);sb.append(", ");sb.append(this.bottom);sb.append(")");return sb.toString();}},{key:"toShortString",value:function toShortString(){var sb=arguments.length <= 0 || arguments[0] === undefined?new StringBuilder():arguments[0];sb.setLength(0);sb.append('[');sb.append(this.left);sb.append(',');sb.append(this.top);sb.append("][");sb.append(this.right);sb.append(',');sb.append(this.bottom);sb.append(']');return sb.toString();}},{key:"flattenToString",value:function flattenToString(){var sb=new StringBuilder(32);sb.append(this.left);sb.append(' ');sb.append(this.top);sb.append(' ');sb.append(this.right);sb.append(' ');sb.append(this.bottom);return sb.toString();}},{key:"isEmpty",value:function isEmpty(){return this.left >= this.right || this.top >= this.bottom;}},{key:"width",value:function width(){return this.right - this.left;}},{key:"height",value:function height(){return this.bottom - this.top;}},{key:"centerX",value:function centerX(){return this.left + this.right >> 1;}},{key:"centerY",value:function centerY(){return this.top + this.bottom >> 1;}},{key:"exactCenterX",value:function exactCenterX(){return (this.left + this.right) * 0.5;}},{key:"exactCenterY",value:function exactCenterY(){return (this.top + this.bottom) * 0.5;}},{key:"setEmpty",value:function setEmpty(){this.left = this.right = this.top = this.bottom = 0;}},{key:"set",value:function set(){for(var _len2=arguments.length,args=Array(_len2),_key2=0;_key2 < _len2;_key2++) {args[_key2] = arguments[_key2];}if(args.length === 1){var rect=args[0];var _ref=[rect.left,rect.top,rect.right,rect.bottom];this.left = _ref[0];this.top = _ref[1];this.right = _ref[2];this.bottom = _ref[3];}else {var _args$02=args[0];var left=_args$02 === undefined?0:_args$02;var _args$12=args[1];var _top2=_args$12 === undefined?0:_args$12;var _args$22=args[2];var right=_args$22 === undefined?0:_args$22;var _args$32=args[3];var bottom=_args$32 === undefined?0:_args$32;this.left = left;this.top = _top2;this.right = right;this.bottom = bottom;}}},{key:"offset",value:function offset(dx,dy){this.left += dx;this.top += dy;this.right += dx;this.bottom += dy;}},{key:"offsetTo",value:function offsetTo(newLeft,newTop){this.right += newLeft - this.left;this.bottom += newTop - this.top;this.left = newLeft;this.top = newTop;}},{key:"inset",value:function inset(dx,dy){this.left += dx;this.top += dy;this.right -= dx;this.bottom -= dy;}},{key:"contains",value:function contains(){for(var _len3=arguments.length,args=Array(_len3),_key3=0;_key3 < _len3;_key3++) {args[_key3] = arguments[_key3];}if(args.length === 1){var r=args[0];return this.left < this.right && this.top < this.bottom && this.left <= r.left && this.top <= r.top && this.right >= r.right && this.bottom >= r.bottom;}else if(args.length === 2){var x=args[0];var y=args[1];return this.left < this.right && this.top < this.bottom && x >= this.left && x < this.right && y >= this.top && y < this.bottom;}else {var _args$03=args[0];var left=_args$03 === undefined?0:_args$03;var _args$13=args[1];var _top3=_args$13 === undefined?0:_args$13;var _args$23=args[2];var right=_args$23 === undefined?0:_args$23;var _args$33=args[3];var bottom=_args$33 === undefined?0:_args$33;return this.left < this.right && this.top < this.bottom && this.left <= left && this.top <= _top3 && this.right >= right && this.bottom >= bottom;}}},{key:"intersect",value:function intersect(){for(var _len4=arguments.length,args=Array(_len4),_key4=0;_key4 < _len4;_key4++) {args[_key4] = arguments[_key4];}if(args.length === 1){var rect=args[0];return this.intersect(rect.left,rect.top,rect.right,rect.bottom);}else {var _args$04=args[0];var left=_args$04 === undefined?0:_args$04;var _args$14=args[1];var t=_args$14 === undefined?0:_args$14;var _args$24=args[2];var right=_args$24 === undefined?0:_args$24;var _args$34=args[3];var bottom=_args$34 === undefined?0:_args$34;if(this.left < right && left < this.right && this.top < bottom && t < this.bottom){if(this.left < left)this.left = left;if(this.top < t)this.top = t;if(this.right > right)this.right = right;if(this.bottom > bottom)this.bottom = bottom;return true;}return false;}}},{key:"intersects",value:function intersects(){for(var _len5=arguments.length,args=Array(_len5),_key5=0;_key5 < _len5;_key5++) {args[_key5] = arguments[_key5];}if(args.length === 1){var rect=args[0];return this.intersects(rect.left,rect.top,rect.right,rect.bottom);}else {var _args$05=args[0];var left=_args$05 === undefined?0:_args$05;var _args$15=args[1];var t=_args$15 === undefined?0:_args$15;var _args$25=args[2];var right=_args$25 === undefined?0:_args$25;var _args$35=args[3];var bottom=_args$35 === undefined?0:_args$35;return this.left < right && left < this.right && this.top < bottom && t < this.bottom;}}},{key:"union",value:function union(){for(var _len6=arguments.length,args=Array(_len6),_key6=0;_key6 < _len6;_key6++) {args[_key6] = arguments[_key6];}if(arguments.length === 1){var rect=args[0];this.union(rect.left,rect.top,rect.right,rect.bottom);}else if(arguments.length === 2){var _args$06=args[0];var x=_args$06 === undefined?0:_args$06;var _args$16=args[1];var y=_args$16 === undefined?0:_args$16;if(x < this.left){this.left = x;}else if(x > this.right){this.right = x;}if(y < this.top){this.top = y;}else if(y > this.bottom){this.bottom = y;}}else {var _args$07=args[0];var left=_args$07 === undefined?0:_args$07;var _args$17=args[1];var _top4=_args$17 === undefined?0:_args$17;var _args$26=args[2];var right=_args$26 === undefined?0:_args$26;var _args$36=args[3];var bottom=_args$36 === undefined?0:_args$36;if(left < right && _top4 < bottom){if(this.left < this.right && this.top < this.bottom){if(this.left > left)this.left = left;if(this.top > _top4)this.top = _top4;if(this.right < right)this.right = right;if(this.bottom < bottom)this.bottom = bottom;}else {this.left = left;this.top = _top4;this.right = right;this.bottom = bottom;}}}}},{key:"sort",value:function sort(){if(this.left > this.right){var _ref2=[this.right,this.left];this.left = _ref2[0];this.right = _ref2[1];}if(this.top > this.bottom){var _ref3=[this.bottom,this.top];this.top = _ref3[0];this.bottom = _ref3[1];}}},{key:"scale",value:function scale(_scale){if(_scale != 1){this.left = this.left * _scale;this.top = this.top * _scale;this.right = this.right * _scale;this.bottom = this.bottom * _scale;}}}],[{key:"unflattenFromString",value:function unflattenFromString(str){var parts=str.split(" ");return new Rect(Number.parseInt(parts[0]),Number.parseInt(parts[1]),Number.parseInt(parts[2]),Number.parseInt(parts[3]));}}]);return Rect;})();graphics.Rect = Rect;})(graphics = android.graphics || (android.graphics = {}));})(android || (android = {}));var android;(function(android){var graphics;(function(graphics){var PixelFormat=function PixelFormat(){_classCallCheck(this,PixelFormat);};PixelFormat.UNKNOWN = 0;PixelFormat.TRANSLUCENT = -3;PixelFormat.TRANSPARENT = -2;PixelFormat.OPAQUE = -1;PixelFormat.RGBA_8888 = 1;PixelFormat.RGBX_8888 = 2;PixelFormat.RGB_888 = 3;PixelFormat.RGB_565 = 4;graphics.PixelFormat = PixelFormat;})(graphics = android.graphics || (android.graphics = {}));})(android || (android = {}));var java;(function(java){var lang;(function(lang){var ref;(function(ref){var WeakReference=(function(){function WeakReference(referent){_classCallCheck(this,WeakReference);this.weakMap = new WeakMap();this.weakMap.set(this,referent);}_createClass(WeakReference,[{key:"get",value:function get(){return this.weakMap.get(this);}},{key:"set",value:function set(value){this.weakMap.set(this,value);}},{key:"clear",value:function clear(){this.weakMap["delete"](this);}}]);return WeakReference;})();ref.WeakReference = WeakReference;})(ref = lang.ref || (lang.ref = {}));})(lang = java.lang || (java.lang = {}));})(java || (java = {}));var java;(function(java){var lang;(function(lang){var System=(function(){function System(){_classCallCheck(this,System);}_createClass(System,null,[{key:"currentTimeMillis",value:function currentTimeMillis(){return new Date().getTime();}},{key:"arraycopy",value:function arraycopy(src,srcPos,dest,destPos,length){var srcLength=src.length;var destLength=dest.length;for(var i=0;i < length;i++) {var srcIndex=i + srcPos;if(srcIndex >= srcLength)return;var destIndex=i + destPos;if(destIndex >= destLength)return;dest[destIndex] = src[srcIndex];}}}]);return System;})();System.out = {println:function println(any){console.log('\n');console.log(any);},print:function print(any){console.log(any);}};lang.System = System;})(lang = java.lang || (java.lang = {}));})(java || (java = {})); /**
 * Created by linfaxin on 15/10/29.
 */ ///<reference path="../../java/lang/System.ts"/>
var android;(function(android){var util;(function(util){var System=java.lang.System;var StateSet=(function(){function StateSet(){_classCallCheck(this,StateSet);}_createClass(StateSet,null,[{key:"isWildCard",value:function isWildCard(stateSetOrSpec){return stateSetOrSpec.length == 0 || stateSetOrSpec[0] == 0;}},{key:"stateSetMatches",value:function stateSetMatches(stateSpec,stateSetOrState){if(Number.isInteger(stateSetOrState)){return StateSet._stateSetMatches_single(stateSpec,stateSetOrState);}var stateSet=stateSetOrState;if(stateSet == null){return stateSpec == null || this.isWildCard(stateSpec);}var stateSpecSize=stateSpec.length;var stateSetSize=stateSet.length;for(var i=0;i < stateSpecSize;i++) {var stateSpecState=stateSpec[i];if(stateSpecState == 0){return true;}var mustMatch=undefined;if(stateSpecState > 0){mustMatch = true;}else {mustMatch = false;stateSpecState = -stateSpecState;}var found=false;for(var j=0;j < stateSetSize;j++) {var state=stateSet[j];if(state == 0){if(mustMatch){return false;}else {break;}}if(state == stateSpecState){if(mustMatch){found = true;break;}else {return false;}}}if(mustMatch && !found){return false;}}return true;}},{key:"_stateSetMatches_single",value:function _stateSetMatches_single(stateSpec,state){var stateSpecSize=stateSpec.length;for(var i=0;i < stateSpecSize;i++) {var stateSpecState=stateSpec[i];if(stateSpecState == 0){return true;}if(stateSpecState > 0){if(state != stateSpecState){return false;}}else {if(state == -stateSpecState){return false;}}}return true;}},{key:"trimStateSet",value:function trimStateSet(states,newSize){if(states.length == newSize){return states;}var trimmedStates=new Array(newSize);System.arraycopy(states,0,trimmedStates,0,newSize);return trimmedStates;}}]);return StateSet;})();StateSet.WILD_CARD = [];StateSet.NOTHING = [0];util.StateSet = StateSet;})(util = android.util || (android.util = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/10/3.
 */ ///<reference path="../Rect.ts"/>
///<reference path="../PixelFormat.ts"/>
///<reference path="../../../java/lang/ref/WeakReference.ts"/>
///<reference path="../../../java/lang/Runnable.ts"/>
///<reference path="../../util/StateSet.ts"/>
var android;(function(android){var graphics;(function(graphics){var drawable;(function(drawable){var Rect=android.graphics.Rect;var PixelFormat=android.graphics.PixelFormat;var WeakReference=java.lang.ref.WeakReference;var StateSet=android.util.StateSet;var Drawable=(function(){function Drawable(){_classCallCheck(this,Drawable);this.mBounds = Drawable.ZERO_BOUNDS_RECT;this.mStateSet = StateSet.WILD_CARD;this.mLevel = 0;this.mVisible = true;}_createClass(Drawable,[{key:"draw",value:function draw(canvas){}},{key:"setBounds",value:function setBounds(){for(var _len7=arguments.length,args=Array(_len7),_key7=0;_key7 < _len7;_key7++) {args[_key7] = arguments[_key7];}if(args.length === 1){var rect=args[0];return this.setBounds(rect.left,rect.top,rect.right,rect.bottom);}else {var _args$08=args[0];var left=_args$08 === undefined?0:_args$08;var _args$18=args[1];var _top5=_args$18 === undefined?0:_args$18;var _args$27=args[2];var right=_args$27 === undefined?0:_args$27;var _args$37=args[3];var bottom=_args$37 === undefined?0:_args$37;var oldBounds=this.mBounds;if(oldBounds == Drawable.ZERO_BOUNDS_RECT){oldBounds = this.mBounds = new Rect();}if(oldBounds.left != left || oldBounds.top != _top5 || oldBounds.right != right || oldBounds.bottom != bottom){if(!oldBounds.isEmpty()){this.invalidateSelf();}this.mBounds.set(left,_top5,right,bottom);this.onBoundsChange(this.mBounds);}}}},{key:"copyBounds",value:function copyBounds(){var bounds=arguments.length <= 0 || arguments[0] === undefined?new Rect():arguments[0];bounds.set(this.mBounds);return bounds;}},{key:"getBounds",value:function getBounds(){if(this.mBounds == Drawable.ZERO_BOUNDS_RECT){this.mBounds = new Rect();}return this.mBounds;}},{key:"setCallback",value:function setCallback(cb){this.mCallback = new WeakReference(cb);}},{key:"getCallback",value:function getCallback(){if(this.mCallback != null){return this.mCallback.get();}return null;}},{key:"invalidateSelf",value:function invalidateSelf(){var callback=this.getCallback();if(callback != null){callback.invalidateDrawable(this);}}},{key:"scheduleSelf",value:function scheduleSelf(what,when){var callback=this.getCallback();if(callback != null){callback.scheduleDrawable(this,what,when);}}},{key:"unscheduleSelf",value:function unscheduleSelf(what){var callback=this.getCallback();if(callback != null){callback.unscheduleDrawable(this,what);}}},{key:"setAlpha",value:function setAlpha(alpha){}},{key:"getAlpha",value:function getAlpha(){return 0xFF;}},{key:"isStateful",value:function isStateful(){return false;}},{key:"setState",value:function setState(stateSet){stateSet = stateSet || [];if(this.mStateSet && stateSet && this.mStateSet.toString() === stateSet.toString()){return false;}this.mStateSet = stateSet;return this.onStateChange(stateSet);}},{key:"getState",value:function getState(){return this.mStateSet;}},{key:"jumpToCurrentState",value:function jumpToCurrentState(){}},{key:"getCurrent",value:function getCurrent(){return this;}},{key:"setLevel",value:function setLevel(level){if(this.mLevel != level){this.mLevel = level;return this.onLevelChange(level);}return false;}},{key:"getLevel",value:function getLevel(){return this.mLevel;}},{key:"setVisible",value:function setVisible(visible,restart){var changed=this.mVisible != visible;if(changed){this.mVisible = visible;this.invalidateSelf();}return changed;}},{key:"isVisible",value:function isVisible(){return this.mVisible;}},{key:"setAutoMirrored",value:function setAutoMirrored(mirrored){}},{key:"isAutoMirrored",value:function isAutoMirrored(){return false;}},{key:"getOpacity",value:function getOpacity(){return PixelFormat.TRANSLUCENT;}},{key:"onStateChange",value:function onStateChange(state){return false;}},{key:"onLevelChange",value:function onLevelChange(level){return false;}},{key:"onBoundsChange",value:function onBoundsChange(bounds){}},{key:"getIntrinsicWidth",value:function getIntrinsicWidth(){return -1;}},{key:"getIntrinsicHeight",value:function getIntrinsicHeight(){return -1;}},{key:"getMinimumWidth",value:function getMinimumWidth(){var intrinsicWidth=this.getIntrinsicWidth();return intrinsicWidth > 0?intrinsicWidth:0;}},{key:"getMinimumHeight",value:function getMinimumHeight(){var intrinsicHeight=this.getIntrinsicHeight();return intrinsicHeight > 0?intrinsicHeight:0;}},{key:"getPadding",value:function getPadding(padding){padding.set(0,0,0,0);return false;}},{key:"mutate",value:function mutate(){return this;}},{key:"getConstantState",value:function getConstantState(){return null;}}],[{key:"resolveOpacity",value:function resolveOpacity(op1,op2){if(op1 == op2){return op1;}if(op1 == PixelFormat.UNKNOWN || op2 == PixelFormat.UNKNOWN){return PixelFormat.UNKNOWN;}if(op1 == PixelFormat.TRANSLUCENT || op2 == PixelFormat.TRANSLUCENT){return PixelFormat.TRANSLUCENT;}if(op1 == PixelFormat.TRANSPARENT || op2 == PixelFormat.TRANSPARENT){return PixelFormat.TRANSPARENT;}return PixelFormat.OPAQUE;}}]);return Drawable;})();Drawable.ZERO_BOUNDS_RECT = new Rect();drawable.Drawable = Drawable;})(drawable = graphics.drawable || (graphics.drawable = {}));})(graphics = android.graphics || (android.graphics = {}));})(android || (android = {}));var android;(function(android){var util;(function(util){var Pools=function Pools(){_classCallCheck(this,Pools);};util.Pools = Pools;(function(Pools){var SimplePool=(function(){function SimplePool(maxPoolSize){_classCallCheck(this,SimplePool);this.mPoolSize = 0;if(maxPoolSize <= 0){throw new Error("The max pool size must be > 0");}this.mPool = new Array(maxPoolSize);}_createClass(SimplePool,[{key:"acquire",value:function acquire(){if(this.mPoolSize > 0){var lastPooledIndex=this.mPoolSize - 1;var instance=this.mPool[lastPooledIndex];this.mPool[lastPooledIndex] = null;this.mPoolSize--;return instance;}return null;}},{key:"release",value:function release(instance){if(this.isInPool(instance)){throw new Error("Already in the pool!");}if(this.mPoolSize < this.mPool.length){this.mPool[this.mPoolSize] = instance;this.mPoolSize++;return true;}return false;}},{key:"isInPool",value:function isInPool(instance){for(var i=0;i < this.mPoolSize;i++) {if(this.mPool[i] == instance){return true;}}return false;}}]);return SimplePool;})();Pools.SimplePool = SimplePool;var SynchronizedPool=(function(_SimplePool){_inherits(SynchronizedPool,_SimplePool);function SynchronizedPool(){_classCallCheck(this,SynchronizedPool);_get(Object.getPrototypeOf(SynchronizedPool.prototype),"constructor",this).apply(this,arguments);}return SynchronizedPool;})(SimplePool);Pools.SynchronizedPool = SynchronizedPool;})(Pools = util.Pools || (util.Pools = {}));})(util = android.util || (android.util = {}));})(android || (android = {}));var android;(function(android){var graphics;(function(graphics){var Color=(function(){function Color(){_classCallCheck(this,Color);}_createClass(Color,null,[{key:"alpha",value:function alpha(color){return color >>> 24;}},{key:"red",value:function red(color){return color >> 16 & 0xFF;}},{key:"green",value:function green(color){return color >> 8 & 0xFF;}},{key:"blue",value:function blue(color){return color & 0xFF;}},{key:"rgb",value:function rgb(red,green,blue){return 0xFF << 24 | red << 16 | green << 8 | blue;}},{key:"argb",value:function argb(alpha,red,green,blue){return alpha << 24 | red << 16 | green << 8 | blue;}},{key:"rgba",value:function rgba(red,green,blue,alpha){return alpha << 24 | red << 16 | green << 8 | blue;}},{key:"parseColor",value:function parseColor(colorString){if(colorString.charAt(0) == '#'){var color=parseInt(colorString.substring(1),16);if(colorString.length == 7){color |= 0x00000000ff000000;}else if(colorString.length != 9){throw new Error("Unknown color");}return color;}else {var color=Color.sColorNameMap.get(colorString.toLowerCase());if(color != null){return color;}}throw new Error("Unknown color");}},{key:"getHtmlColor",value:function getHtmlColor(color){var i=Color.sColorNameMap.get(color.toLowerCase());return i;}}]);return Color;})();Color.BLACK = 0xFF000000;Color.DKGRAY = 0xFF444444;Color.GRAY = 0xFF888888;Color.LTGRAY = 0xFFCCCCCC;Color.WHITE = 0xFFFFFFFF;Color.RED = 0xFFFF0000;Color.GREEN = 0xFF00FF00;Color.BLUE = 0xFF0000FF;Color.YELLOW = 0xFFFFFF00;Color.CYAN = 0xFF00FFFF;Color.MAGENTA = 0xFFFF00FF;Color.TRANSPARENT = 0;Color.sColorNameMap = new Map();graphics.Color = Color;Color.sColorNameMap = new Map();Color.sColorNameMap.set("black",Color.BLACK);Color.sColorNameMap.set("darkgray",Color.DKGRAY);Color.sColorNameMap.set("gray",Color.GRAY);Color.sColorNameMap.set("lightgray",Color.LTGRAY);Color.sColorNameMap.set("white",Color.WHITE);Color.sColorNameMap.set("red",Color.RED);Color.sColorNameMap.set("green",Color.GREEN);Color.sColorNameMap.set("blue",Color.BLUE);Color.sColorNameMap.set("yellow",Color.YELLOW);Color.sColorNameMap.set("cyan",Color.CYAN);Color.sColorNameMap.set("magenta",Color.MAGENTA);Color.sColorNameMap.set("aqua",0xFF00FFFF);Color.sColorNameMap.set("fuchsia",0xFFFF00FF);Color.sColorNameMap.set("darkgrey",Color.DKGRAY);Color.sColorNameMap.set("grey",Color.GRAY);Color.sColorNameMap.set("lightgrey",Color.LTGRAY);Color.sColorNameMap.set("lime",0xFF00FF00);Color.sColorNameMap.set("maroon",0xFF800000);Color.sColorNameMap.set("navy",0xFF000080);Color.sColorNameMap.set("olive",0xFF808000);Color.sColorNameMap.set("purple",0xFF800080);Color.sColorNameMap.set("silver",0xFFC0C0C0);Color.sColorNameMap.set("teal",0xFF008080);})(graphics = android.graphics || (android.graphics = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/10/29.
 */ ///<reference path="Canvas.ts"/>
var android;(function(android){var graphics;(function(graphics){var Paint=(function(){function Paint(){_classCallCheck(this,Paint);}_createClass(Paint,[{key:"getColor",value:function getColor(){return this.mColor;}},{key:"setColor",value:function setColor(color){this.mColor = color;}},{key:"getAlpha",value:function getAlpha(){return this.mAlpha;}},{key:"setAlpha",value:function setAlpha(alpha){this.mAlpha = alpha;}},{key:"_setToCanvasContent",value:function _setToCanvasContent(context){if(Number.isInteger(this.mColor)){var r=graphics.Color.red(this.mColor);var g=graphics.Color.green(this.mColor);var b=graphics.Color.blue(this.mColor);var a=graphics.Color.alpha(this.mColor);context.fillStyle = "rgba(" + r + "," + g + "," + b + "," + a / 255 + ")";}}}]);return Paint;})();graphics.Paint = Paint;})(graphics = android.graphics || (android.graphics = {}));})(android || (android = {})); ///<reference path="../util/Pools.ts"/>
///<reference path="../util/Log.ts"/>
///<reference path="Rect.ts"/>
///<reference path="Color.ts"/>
///<reference path="Paint.ts"/>
var android;(function(android){var graphics;(function(graphics){var Pools=android.util.Pools;var Rect=android.graphics.Rect;var Color=android.graphics.Color;var Canvas=(function(){function Canvas(){_classCallCheck(this,Canvas);this._saveCount = 0;this.shouldDoRectBeforeRestoreMap = new Map();this.mClipStateMap = new Map();for(var _len8=arguments.length,args=Array(_len8),_key8=0;_key8 < _len8;_key8++) {args[_key8] = arguments[_key8];}this.mCanvasElement = args.length === 1?args[0]:document.createElement("canvas");if(args.length === 1){this.mCanvasElement = args[0];}else if(args.length === 2){this.mCanvasElement = document.createElement("canvas");this.mCanvasElement.width = args[0];this.mCanvasElement.height = args[1];}this.init();}_createClass(Canvas,[{key:"init",value:function init(){this._mCanvasContent = this.mCanvasElement.getContext("2d");this.mCurrentClip = new Rect(0,0,this.mCanvasElement.width,this.mCanvasElement.height);this._saveCount = 0;this.fullRectForClip();this._mCanvasContent.clip();this.save();}},{key:"getHeight",value:function getHeight(){return this.mCanvasElement.height;}},{key:"getWidth",value:function getWidth(){return this.mCanvasElement.width;}},{key:"translate",value:function translate(dx,dy){if(this.mCurrentClip)this.mCurrentClip.offset(-dx,-dy);this._mCanvasContent.translate(dx,dy);}},{key:"scale",value:function scale(sx,sy,px,py){if(px && py)this.translate(px,py);this._mCanvasContent.scale(sx,sy);if(px && py)this.translate(-px,-py);}},{key:"rotate",value:function rotate(degrees,px,py){if(px && py)this.translate(px,py);this._mCanvasContent.rotate(degrees);if(px && py)this.translate(-px,-py);}},{key:"drawRGB",value:function drawRGB(r,g,b){this._mCanvasContent.fillStyle = "rgb(" + r + "," + g + "," + b + ")";this._mCanvasContent.fillRect(this.mCurrentClip.left,this.mCurrentClip.top,this.mCurrentClip.width(),this.mCurrentClip.height());}},{key:"drawARGB",value:function drawARGB(a,r,g,b){this._mCanvasContent.fillStyle = "rgba(" + r + "," + g + "," + b + "," + a / 255 + ")";this._mCanvasContent.fillRect(this.mCurrentClip.left,this.mCurrentClip.top,this.mCurrentClip.width(),this.mCurrentClip.height());}},{key:"drawColor",value:function drawColor(color){this.drawARGB(Color.alpha(color),Color.red(color),Color.green(color),Color.blue(color));}},{key:"clearColor",value:function clearColor(){this._mCanvasContent.clearRect(this.mCurrentClip.left,this.mCurrentClip.top,this.mCurrentClip.width(),this.mCurrentClip.height());}},{key:"save",value:function save(){this._mCanvasContent.save();if(this.mCurrentClip)this.mClipStateMap.set(this._saveCount,new Rect(this.mCurrentClip));this._saveCount++;return this._saveCount;}},{key:"restore",value:function restore(){var _this=this;var doRects=this.shouldDoRectBeforeRestoreMap.get(this._saveCount);if(doRects && doRects.length > 0){doRects.forEach(function(rect){_this._mCanvasContent.rect(rect.left,rect.top,rect.width(),rect.height());});if(doRects.length % 2 == 1){this.fullRectForClip();}this.shouldDoRectBeforeRestoreMap["delete"](this._saveCount);}this._saveCount--;this._mCanvasContent.restore();var savedClip=this.mClipStateMap.get(this._saveCount);if(savedClip){this.mClipStateMap["delete"](this._saveCount);this.mCurrentClip.set(savedClip);}}},{key:"restoreToCount",value:function restoreToCount(saveCount){if(saveCount <= 0)throw Error('saveCount can\'t <= 0');while(saveCount <= this._saveCount) {this.restore();}}},{key:"getSaveCount",value:function getSaveCount(){return this._saveCount;}},{key:"fullRectForClip",value:function fullRectForClip(){this._mCanvasContent.rect(Canvas.FullRect.left,Canvas.FullRect.top,Canvas.FullRect.width(),Canvas.FullRect.height());}},{key:"clipRect",value:function clipRect(){var rect=new Rect();for(var _len9=arguments.length,args=Array(_len9),_key9=0;_key9 < _len9;_key9++) {args[_key9] = arguments[_key9];}if(args.length === 1){rect.set(args[0]);}else {var _args$09=args[0];var left=_args$09 === undefined?0:_args$09;var _args$19=args[1];var _top6=_args$19 === undefined?0:_args$19;var _args$28=args[2];var right=_args$28 === undefined?0:_args$28;var _args$38=args[3];var bottom=_args$38 === undefined?0:_args$38;rect.set(left,_top6,right,bottom);}this._mCanvasContent.rect(Math.floor(rect.left),Math.floor(rect.top),Math.ceil(rect.width()),Math.ceil(rect.height()));this.fullRectForClip();this._mCanvasContent.clip('evenodd');var doRects=this.shouldDoRectBeforeRestoreMap.get(this._saveCount);if(!doRects){doRects = [];this.shouldDoRectBeforeRestoreMap.set(this._saveCount,doRects);}doRects.push(rect);this.mCurrentClip.intersect(rect);return rect.isEmpty();}},{key:"getClipBounds",value:function getClipBounds(bounds){if(!this.mCurrentClip)this.mCurrentClip = new Rect();var rect=bounds || new Rect();rect.set(this.mCurrentClip);return rect;}},{key:"quickReject",value:function quickReject(){if(!this.mCurrentClip)return false;for(var _len10=arguments.length,args=Array(_len10),_key10=0;_key10 < _len10;_key10++) {args[_key10] = arguments[_key10];}if(args.length == 1){return !this.mCurrentClip.intersects(args[0]);}else {var _args$010=args[0];var left=_args$010 === undefined?0:_args$010;var _args$110=args[1];var t=_args$110 === undefined?0:_args$110;var _args$29=args[2];var right=_args$29 === undefined?0:_args$29;var _args$39=args[3];var bottom=_args$39 === undefined?0:_args$39;return !this.mCurrentClip.intersects(left,t,right,bottom);}}},{key:"drawCanvas",value:function drawCanvas(canvas,offsetX,offsetY,width,height,canvasOffsetX,canvasOffsetY,canvasImageWidth,canvasImageHeight){this._mCanvasContent.drawImage(canvas.canvasElement,offsetX,offsetY,width,height,canvasOffsetX,canvasOffsetY,canvasImageWidth,canvasImageHeight);}},{key:"drawRect",value:function drawRect(){for(var _len11=arguments.length,args=Array(_len11),_key11=0;_key11 < _len11;_key11++) {args[_key11] = arguments[_key11];}if(args.length == 2){var rect=args[0];this.drawRect(rect.left,rect.top,rect.right,rect.bottom,args[1]);}else {var left=args[0];var _top7=args[1];var right=args[2];var bottom=args[3];var paint=args[4];this._mCanvasContent.save();paint._setToCanvasContent(this._mCanvasContent);this._mCanvasContent.fillRect(left,_top7,right - left,bottom - _top7);this._mCanvasContent.restore();}}},{key:"canvasElement",get:function get(){return this.mCanvasElement;}}]);return Canvas;})();Canvas.FullRect = new Rect(-10000,-10000,10000,10000);Canvas.sPool = new Pools.SynchronizedPool(10);graphics.Canvas = Canvas;})(graphics = android.graphics || (android.graphics = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/10/29.
 */ ///<reference path="Drawable.ts"/>
///<reference path="../Canvas.ts"/>
///<reference path="../Paint.ts"/>
var android;(function(android){var graphics;(function(graphics){var drawable;(function(drawable){var ColorDrawable=(function(_drawable$Drawable){_inherits(ColorDrawable,_drawable$Drawable);function ColorDrawable(color){_classCallCheck(this,ColorDrawable);_get(Object.getPrototypeOf(ColorDrawable.prototype),"constructor",this).call(this);this.mMutated = false;this.mPaint = new graphics.Paint();this.mState = new ColorState();if(color !== undefined){this.setColor(color);}}_createClass(ColorDrawable,[{key:"_setStateCopyFrom",value:function _setStateCopyFrom(state){this.mState = new ColorState(state);}},{key:"mutate",value:function mutate(){if(!this.mMutated && _get(Object.getPrototypeOf(ColorDrawable.prototype),"mutate",this).call(this) == this){this.mState = new ColorState(this.mState);this.mMutated = true;}return this;}},{key:"draw",value:function draw(canvas){if(this.mState.mUseColor >>> 24 != 0){this.mPaint.setColor(this.mState.mUseColor);canvas.drawRect(this.getBounds(),this.mPaint);}}},{key:"getColor",value:function getColor(){return this.mState.mUseColor;}},{key:"setColor",value:function setColor(color){if(this.mState.mBaseColor != color || this.mState.mUseColor != color){this.invalidateSelf();this.mState.mBaseColor = this.mState.mUseColor = color;}}},{key:"getAlpha",value:function getAlpha(){return this.mState.mUseColor >>> 24;}},{key:"setAlpha",value:function setAlpha(alpha){alpha += alpha >> 7;var baseAlpha=this.mState.mBaseColor >>> 24;var useAlpha=baseAlpha * alpha >> 8;var oldUseColor=this.mState.mUseColor;this.mState.mUseColor = this.mState.mBaseColor << 8 >>> 8 | useAlpha << 24;if(oldUseColor != this.mState.mUseColor){this.invalidateSelf();}}},{key:"getOpacity",value:function getOpacity(){switch(this.mState.mUseColor >>> 24){case 255:return graphics.PixelFormat.OPAQUE;case 0:return graphics.PixelFormat.TRANSPARENT;}return graphics.PixelFormat.TRANSLUCENT;}},{key:"getConstantState",value:function getConstantState(){return this.mState;}}]);return ColorDrawable;})(drawable.Drawable);drawable.ColorDrawable = ColorDrawable;var ColorState=(function(){function ColorState(state){_classCallCheck(this,ColorState);this.mBaseColor = 0;this.mUseColor = 0;if(state != null){this.mBaseColor = state.mBaseColor;this.mUseColor = state.mUseColor;}}_createClass(ColorState,[{key:"newDrawable",value:function newDrawable(){var c=new ColorDrawable();c._setStateCopyFrom(this);return c;}}]);return ColorState;})();})(drawable = graphics.drawable || (graphics.drawable = {}));})(graphics = android.graphics || (android.graphics = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/10/30.
 */ ///<reference path="Drawable.ts"/>
///<reference path="../Canvas.ts"/>
var android;(function(android){var graphics;(function(graphics){var drawable;(function(drawable){var Drawable=android.graphics.drawable.Drawable;var ScrollBarDrawable=(function(_Drawable){_inherits(ScrollBarDrawable,_Drawable);function ScrollBarDrawable(){_classCallCheck(this,ScrollBarDrawable);for(var _len12=arguments.length,args=Array(_len12),_key12=0;_key12 < _len12;_key12++) {args[_key12] = arguments[_key12];}_get(Object.getPrototypeOf(ScrollBarDrawable.prototype),"constructor",this).apply(this,args);this.mRange = 0;this.mOffset = 0;this.mExtent = 0;this.mVertical = false;this.mChanged = false;this.mRangeChanged = false;this.mTempBounds = new graphics.Rect();this.mAlwaysDrawHorizontalTrack = false;this.mAlwaysDrawVerticalTrack = false;}_createClass(ScrollBarDrawable,[{key:"setAlwaysDrawHorizontalTrack",value:function setAlwaysDrawHorizontalTrack(alwaysDrawTrack){this.mAlwaysDrawHorizontalTrack = alwaysDrawTrack;}},{key:"setAlwaysDrawVerticalTrack",value:function setAlwaysDrawVerticalTrack(alwaysDrawTrack){this.mAlwaysDrawVerticalTrack = alwaysDrawTrack;}},{key:"getAlwaysDrawVerticalTrack",value:function getAlwaysDrawVerticalTrack(){return this.mAlwaysDrawVerticalTrack;}},{key:"getAlwaysDrawHorizontalTrack",value:function getAlwaysDrawHorizontalTrack(){return this.mAlwaysDrawHorizontalTrack;}},{key:"setParameters",value:function setParameters(range,offset,extent,vertical){if(this.mVertical != vertical){this.mChanged = true;}if(this.mRange != range || this.mOffset != offset || this.mExtent != extent){this.mRangeChanged = true;}this.mRange = range;this.mOffset = offset;this.mExtent = extent;this.mVertical = vertical;}},{key:"draw",value:function draw(canvas){var vertical=this.mVertical;var extent=this.mExtent;var range=this.mRange;var drawTrack=true;var drawThumb=true;if(extent <= 0 || range <= extent){drawTrack = vertical?this.mAlwaysDrawVerticalTrack:this.mAlwaysDrawHorizontalTrack;drawThumb = false;}var r=this.getBounds();if(drawTrack){this.drawTrack(canvas,r,vertical);}if(drawThumb){var size=vertical?r.height():r.width();var thickness=vertical?r.width():r.height();var _length=Math.round(size * extent / range);var offset=Math.round((size - _length) * this.mOffset / (range - extent));var minLength=thickness * 2;if(_length < minLength){_length = minLength;}if(offset + _length > size){offset = size - _length;}this.drawThumb(canvas,r,offset,_length,vertical);}}},{key:"onBoundsChange",value:function onBoundsChange(bounds){_get(Object.getPrototypeOf(ScrollBarDrawable.prototype),"onBoundsChange",this).call(this,bounds);this.mChanged = true;}},{key:"drawTrack",value:function drawTrack(canvas,bounds,vertical){var track=undefined;if(vertical){track = this.mVerticalTrack;}else {track = this.mHorizontalTrack;}if(track != null){if(this.mChanged){track.setBounds(bounds);}track.draw(canvas);}}},{key:"drawThumb",value:function drawThumb(canvas,bounds,offset,length,vertical){var thumbRect=this.mTempBounds;var changed=this.mRangeChanged || this.mChanged;if(changed){if(vertical){thumbRect.set(bounds.left,bounds.top + offset,bounds.right,bounds.top + offset + length);}else {thumbRect.set(bounds.left + offset,bounds.top,bounds.left + offset + length,bounds.bottom);}}if(vertical){var thumb=this.mVerticalThumb;if(changed)thumb.setBounds(thumbRect);thumb.draw(canvas);}else {var thumb=this.mHorizontalThumb;if(changed)thumb.setBounds(thumbRect);thumb.draw(canvas);}}},{key:"setVerticalThumbDrawable",value:function setVerticalThumbDrawable(thumb){if(thumb != null){this.mVerticalThumb = thumb;}}},{key:"setVerticalTrackDrawable",value:function setVerticalTrackDrawable(track){this.mVerticalTrack = track;}},{key:"setHorizontalThumbDrawable",value:function setHorizontalThumbDrawable(thumb){if(thumb != null){this.mHorizontalThumb = thumb;}}},{key:"setHorizontalTrackDrawable",value:function setHorizontalTrackDrawable(track){this.mHorizontalTrack = track;}},{key:"getSize",value:function getSize(vertical){if(vertical){return (this.mVerticalTrack != null?this.mVerticalTrack:this.mVerticalThumb).getIntrinsicWidth();}else {return (this.mHorizontalTrack != null?this.mHorizontalTrack:this.mHorizontalThumb).getIntrinsicHeight();}}},{key:"setAlpha",value:function setAlpha(alpha){if(this.mVerticalTrack != null){this.mVerticalTrack.setAlpha(alpha);}this.mVerticalThumb.setAlpha(alpha);if(this.mHorizontalTrack != null){this.mHorizontalTrack.setAlpha(alpha);}this.mHorizontalThumb.setAlpha(alpha);}},{key:"getAlpha",value:function getAlpha(){return this.mVerticalThumb.getAlpha();}},{key:"getOpacity",value:function getOpacity(){return graphics.PixelFormat.TRANSLUCENT;}},{key:"toString",value:function toString(){return "ScrollBarDrawable: range=" + this.mRange + " offset=" + this.mOffset + " extent=" + this.mExtent + (this.mVertical?" V":" H");}}]);return ScrollBarDrawable;})(Drawable);drawable.ScrollBarDrawable = ScrollBarDrawable;})(drawable = graphics.drawable || (graphics.drawable = {}));})(graphics = android.graphics || (android.graphics = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/10/18.
 */ ///<reference path="Rect.ts"/>
var android;(function(android){var graphics;(function(graphics){var Matrix=(function(){function Matrix(){_classCallCheck(this,Matrix);}_createClass(Matrix,[{key:"isIdentity",value:function isIdentity(){return true;}},{key:"mapRect",value:function mapRect(boundingRect){return false;}}]);return Matrix;})();Matrix.IDENTITY_MATRIX = new Matrix();graphics.Matrix = Matrix;})(graphics = android.graphics || (android.graphics = {}));})(android || (android = {}));var java;(function(java){var lang;(function(lang){var util;(function(util){var concurrent;(function(concurrent){var CopyOnWriteArrayList=(function(){function CopyOnWriteArrayList(){_classCallCheck(this,CopyOnWriteArrayList);this.mData = [];this.isDataNew = true;}_createClass(CopyOnWriteArrayList,[{key:"iterator",value:function iterator(){this.isDataNew = false;return this.mData;}},{key:Symbol.iterator,value:function value(){this.isDataNew = false;return this.mData[Symbol.iterator]();}},{key:"checkNewData",value:function checkNewData(){if(!this.isDataNew){this.isDataNew = true;this.mData = [].concat(_toConsumableArray(this.mData));}}},{key:"size",value:function size(){return this.mData.length;}},{key:"add",value:function add(){var _mData;this.checkNewData();(_mData = this.mData).push.apply(_mData,arguments);}},{key:"addAll",value:function addAll(array){var _mData2;this.checkNewData();(_mData2 = this.mData).push.apply(_mData2,_toConsumableArray(array.mData));}},{key:"remove",value:function remove(item){this.checkNewData();this.mData.splice(this.mData.indexOf(item),1);}}]);return CopyOnWriteArrayList;})();concurrent.CopyOnWriteArrayList = CopyOnWriteArrayList;})(concurrent = util.concurrent || (util.concurrent = {}));})(util = lang.util || (lang.util = {}));})(lang = java.lang || (java.lang = {}));})(java || (java = {}));var java;(function(java){var util;(function(util){var ArrayList=(function(){function ArrayList(){var initialCapacity=arguments.length <= 0 || arguments[0] === undefined?0:arguments[0];_classCallCheck(this,ArrayList);this.array = [];}_createClass(ArrayList,[{key:"size",value:function size(){return this.array.length;}},{key:"isEmpty",value:function isEmpty(){return this.size() === 0;}},{key:"contains",value:function contains(o){return this.indexOf(o) >= 0;}},{key:"indexOf",value:function indexOf(o){return this.array.indexOf(o);}},{key:"lastIndexOf",value:function lastIndexOf(o){return this.array.lastIndexOf(o);}},{key:"clone",value:function clone(){var _arrayList$array;var arrayList=new ArrayList();(_arrayList$array = arrayList.array).push.apply(_arrayList$array,_toConsumableArray(this.array));return arrayList;}},{key:"toArray",value:function toArray(){var a=arguments.length <= 0 || arguments[0] === undefined?new Array(this.size()):arguments[0];var size=this.size();for(var i=0;i < size;i++) {a[i] = this.array[i];}return a;}},{key:"get",value:function get(index){return this.array[index];}},{key:"set",value:function set(index,element){var old=this.array[index];this.array[index] = element;return old;}},{key:"add",value:function add(){var index=undefined,t=undefined;for(var _len13=arguments.length,args=Array(_len13),_key13=0;_key13 < _len13;_key13++) {args[_key13] = arguments[_key13];}if(args.length === 1)t = args[0];else if(args.length === 2){index = args[0];t = args[1];}if(index === undefined)this.array.push(t);else this.array.splice(index,0,t);}},{key:"remove",value:function remove(o){var index=undefined;if(Number.isInteger(o)){index = o;}else {index = this.array.indexOf(o);}var old=this.array[index];this.array.splice(index,1);return old;}},{key:"clear",value:function clear(){this.array = [];}},{key:"addAll",value:function addAll(){var index=undefined,list=undefined;for(var _len14=arguments.length,args=Array(_len14),_key14=0;_key14 < _len14;_key14++) {args[_key14] = arguments[_key14];}if(args.length === 1){list = args[0];}else if(args.length === 2){index = args[0];list = args[1];}if(index === undefined){var _array2;(_array2 = this.array).push.apply(_array2,_toConsumableArray(list.array));}else {var _array3;(_array3 = this.array).splice.apply(_array3,[index,0].concat(_toConsumableArray(list.array)));}}},{key:"removeAll",value:function removeAll(list){var _this2=this;var oldSize=this.size();list.array.forEach(function(item){var index=_this2.array.indexOf(item);_this2.array.splice(index,1);});return this.size() === oldSize;}},{key:Symbol.iterator,value:function value(){return this.array[Symbol.iterator];}},{key:"subList",value:function subList(fromIndex,toIndex){var list=new ArrayList();for(var i=fromIndex;i < toIndex;i++) {list.array.push(this.array[i]);}return list;}},{key:"toString",value:function toString(){return this.array.toString();}}]);return ArrayList;})();util.ArrayList = ArrayList;})(util = java.util || (java.util = {}));})(java || (java = {}));var android;(function(android){var util;(function(util){var Access=(function(){function Access(){_classCallCheck(this,Access);}_createClass(Access,[{key:"get",value:function get(index){return this.mData[index];}},{key:"size",value:function size(){return this.mSize;}}]);return Access;})();var CopyOnWriteArray=(function(){function CopyOnWriteArray(){_classCallCheck(this,CopyOnWriteArray);this.mData = [];this.mAccess = new Access();}_createClass(CopyOnWriteArray,[{key:"getArray",value:function getArray(){if(this.mStart){if(this.mDataCopy == null)this.mDataCopy = [].concat(_toConsumableArray(this.mData));return this.mDataCopy;}return this.mData;}},{key:"start",value:function start(){if(this.mStart)throw new Error("Iteration already started");this.mStart = true;this.mDataCopy = null;this.mAccess.mData = this.mData;this.mAccess.mSize = this.mData.length;return this.mAccess.mData;}},{key:"end",value:function end(){if(!this.mStart)throw new Error("Iteration not started");this.mStart = false;if(this.mDataCopy != null){this.mData = this.mDataCopy;this.mAccess.mData = [];this.mAccess.mSize = 0;}this.mDataCopy = null;}},{key:"size",value:function size(){return this.getArray().length;}},{key:"add",value:function add(){var _getArray;(_getArray = this.getArray()).push.apply(_getArray,arguments);}},{key:"addAll",value:function addAll(array){var _getArray2;(_getArray2 = this.getArray()).push.apply(_getArray2,_toConsumableArray(array.mData));}},{key:"remove",value:function remove(item){this.getArray().splice(this.getArray().indexOf(item),1);}}]);return CopyOnWriteArray;})();util.CopyOnWriteArray = CopyOnWriteArray;})(util = android.util || (android.util = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/10/8.
 */ ///<reference path="../../java/lang/util/concurrent/CopyOnWriteArrayList.ts"/>
///<reference path="../util/CopyOnWriteArray.ts"/>
var android;(function(android){var view;(function(view){var ViewTreeObserver=(function(){function ViewTreeObserver(){_classCallCheck(this,ViewTreeObserver);}_createClass(ViewTreeObserver,[{key:"dispatchOnWindowAttachedChange",value:function dispatchOnWindowAttachedChange(attached){var listeners=this.mOnWindowAttachListeners;if(listeners != null && listeners.size() > 0){var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=listeners[Symbol.iterator](),_step;!(_iteratorNormalCompletion = (_step = _iterator.next()).done);_iteratorNormalCompletion = true) {var listener=_step.value;if(attached)listener.onWindowAttached();else listener.onWindowDetached();}}catch(err) {_didIteratorError = true;_iteratorError = err;}finally {try{if(!_iteratorNormalCompletion && _iterator["return"]){_iterator["return"]();}}finally {if(_didIteratorError){throw _iteratorError;}}}}}},{key:"dispatchOnGlobalLayout",value:function dispatchOnGlobalLayout(){var listeners=this.mOnGlobalLayoutListeners;if(listeners != null && listeners.size() > 0){var access=listeners.start();try{var count=access.length;for(var i=0;i < count;i++) {access[i].onGlobalLayout();}}finally {listeners.end();}}}},{key:"dispatchOnPreDraw",value:function dispatchOnPreDraw(){var cancelDraw=false;var listeners=this.mOnPreDrawListeners;if(listeners != null && listeners.size() > 0){var access=listeners.start();try{var count=access.length;for(var i=0;i < count;i++) {cancelDraw = cancelDraw || !access[i].onPreDraw();}}finally {listeners.end();}}return cancelDraw;}},{key:"dispatchOnScrollChanged",value:function dispatchOnScrollChanged(){var listeners=this.mOnScrollChangedListeners;if(listeners != null && listeners.size() > 0){var access=listeners.start();try{var count=access.length;for(var i=0;i < count;i++) {access[i].onScrollChanged();}}finally {listeners.end();}}}},{key:"dispatchOnDraw",value:function dispatchOnDraw(){if(this.mOnDrawListeners != null){var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=this.mOnDrawListeners[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done);_iteratorNormalCompletion2 = true) {var listener=_step2.value;listener.onDraw();}}catch(err) {_didIteratorError2 = true;_iteratorError2 = err;}finally {try{if(!_iteratorNormalCompletion2 && _iterator2["return"]){_iterator2["return"]();}}finally {if(_didIteratorError2){throw _iteratorError2;}}}}}}]);return ViewTreeObserver;})();view.ViewTreeObserver = ViewTreeObserver;})(view = android.view || (android.view = {}));})(android || (android = {}));var android;(function(android){var util;(function(util){var DisplayMetrics=function DisplayMetrics(){_classCallCheck(this,DisplayMetrics);};DisplayMetrics.DENSITY_LOW = 120;DisplayMetrics.DENSITY_MEDIUM = 160;DisplayMetrics.DENSITY_HIGH = 240;DisplayMetrics.DENSITY_XHIGH = 320;DisplayMetrics.DENSITY_XXHIGH = 480;DisplayMetrics.DENSITY_XXXHIGH = 640;DisplayMetrics.DENSITY_DEFAULT = DisplayMetrics.DENSITY_MEDIUM;util.DisplayMetrics = DisplayMetrics;})(util = android.util || (android.util = {}));})(android || (android = {})); ///<reference path="../../util/DisplayMetrics.ts"/>
var android;(function(android){var content;(function(content){var res;(function(res){var DisplayMetrics=android.util.DisplayMetrics;var Resources=(function(){function Resources(){_classCallCheck(this,Resources);}_createClass(Resources,null,[{key:"getDisplayMetrics",value:function getDisplayMetrics(){if(Resources.displayMetrics)return Resources.displayMetrics;Resources.displayMetrics = new DisplayMetrics();var displayMetrics=Resources.displayMetrics;var density=Resources.density;displayMetrics.xdpi = window.screen.deviceXDPI || DisplayMetrics.DENSITY_DEFAULT;displayMetrics.ydpi = window.screen.deviceYDPI || DisplayMetrics.DENSITY_DEFAULT;displayMetrics.density = density;displayMetrics.densityDpi = density * DisplayMetrics.DENSITY_DEFAULT;displayMetrics.scaledDensity = density;displayMetrics.widthPixels = window.innerWidth * density;displayMetrics.heightPixels = window.innerHeight * density;return displayMetrics;}},{key:"setDensity",value:function setDensity(density){Resources.density = density;Resources.displayMetrics = null;}}]);return Resources;})();Resources.density = 1;res.Resources = Resources;})(res = content.res || (content.res = {}));})(content = android.content || (android.content = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/10/6.
 */ ///<reference path="../content/res/Resources.ts"/>
var android;(function(android){var view;(function(view){var Resources=android.content.res.Resources;var density=Resources.getDisplayMetrics().density;var MotionEvent=(function(){function MotionEvent(e,action){_classCallCheck(this,MotionEvent);this.mAction = 0;this.mDownTime = 0;this.mEventTime = 0;this.mActivePointerId = 0;this.mXOffset = 0;this.mYOffset = 0;this.mViewRootTop = 0;this.mViewRootLeft = 0;this.mAction = action;if(e)this.init(e,action);}_createClass(MotionEvent,[{key:"init",value:function init(event,baseAction){var windowXOffset=arguments.length <= 2 || arguments[2] === undefined?0:arguments[2];var windowYOffset=arguments.length <= 3 || arguments[3] === undefined?0:arguments[3];var e=event;var action=baseAction;var actionIndex=-1;var activeTouch=e.changedTouches[0];var activePointerId=activeTouch.identifier;for(var i=0,_length2=e.touches.length;i < _length2;i++) {if(e.touches[i].identifier === activePointerId){actionIndex = i;MotionEvent.IdIndexCache.set(activePointerId,i);break;}}if(actionIndex < 0 && (baseAction === MotionEvent.ACTION_UP || baseAction === MotionEvent.ACTION_CANCEL)){actionIndex = MotionEvent.IdIndexCache.get(activePointerId);}if(actionIndex < 0)throw Error('not find action index');switch(baseAction){case MotionEvent.ACTION_DOWN:case MotionEvent.ACTION_UP:MotionEvent.TouchMoveRecord.set(activePointerId,[]);break;case MotionEvent.ACTION_MOVE:var moveHistory=MotionEvent.TouchMoveRecord.get(activePointerId);if(moveHistory){activeTouch.mEventTime = e.timeStamp;moveHistory.push(activeTouch);if(moveHistory.length > MotionEvent.HistoryMaxSize)moveHistory.shift();}break;}this.mTouchingPointers = Array.from(e.touches);if(baseAction === MotionEvent.ACTION_UP){this.mTouchingPointers.splice(actionIndex,0,activeTouch);}if(this.mTouchingPointers.length > 1){switch(action){case MotionEvent.ACTION_DOWN:action = MotionEvent.ACTION_POINTER_DOWN;break;case MotionEvent.ACTION_UP:action = MotionEvent.ACTION_POINTER_UP;break;}}this.mAction = actionIndex << MotionEvent.ACTION_POINTER_INDEX_SHIFT | action;this.mActivePointerId = activePointerId;if(activePointerId === 0 && action == MotionEvent.ACTION_DOWN){this.mDownTime = e.timeStamp;}this.mEventTime = e.timeStamp;this.mViewRootLeft = windowXOffset;this.mViewRootTop = windowYOffset;}},{key:"recycle",value:function recycle(){}},{key:"getAction",value:function getAction(){return this.mAction;}},{key:"getActionMasked",value:function getActionMasked(){return this.mAction & MotionEvent.ACTION_MASK;}},{key:"getActionIndex",value:function getActionIndex(){return (this.mAction & MotionEvent.ACTION_POINTER_INDEX_MASK) >> MotionEvent.ACTION_POINTER_INDEX_SHIFT;}},{key:"getDownTime",value:function getDownTime(){return this.mDownTime;}},{key:"getEventTime",value:function getEventTime(){return this.mEventTime;}},{key:"getX",value:function getX(){var pointerIndex=arguments.length <= 0 || arguments[0] === undefined?0:arguments[0];return (this.mTouchingPointers[pointerIndex].pageX - this.mViewRootLeft) * density + this.mXOffset;}},{key:"getY",value:function getY(){var pointerIndex=arguments.length <= 0 || arguments[0] === undefined?0:arguments[0];return (this.mTouchingPointers[pointerIndex].pageY - this.mViewRootTop) * density + this.mYOffset;}},{key:"getPointerCount",value:function getPointerCount(){return this.mTouchingPointers.length;}},{key:"getPointerId",value:function getPointerId(pointerIndex){return this.mTouchingPointers[pointerIndex].identifier;}},{key:"findPointerIndex",value:function findPointerIndex(pointerId){for(var i=0,_length3=this.mTouchingPointers.length;i < _length3;i++) {if(this.mTouchingPointers[i].identifier === pointerId){return i;}}return -1;}},{key:"getRawX",value:function getRawX(){return (this.mTouchingPointers[0].pageX - this.mViewRootLeft) * density;}},{key:"getRawY",value:function getRawY(){return (this.mTouchingPointers[0].pageY - this.mViewRootTop) * density;}},{key:"getHistorySize",value:function getHistorySize(){var id=arguments.length <= 0 || arguments[0] === undefined?this.mActivePointerId:arguments[0];var moveHistory=MotionEvent.TouchMoveRecord.get(id);return moveHistory?moveHistory.length:0;}},{key:"getHistoricalX",value:function getHistoricalX(pointerIndex,pos){var moveHistory=MotionEvent.TouchMoveRecord.get(this.mTouchingPointers[pointerIndex].identifier);return (moveHistory[pos].pageX - this.mViewRootLeft) * density + this.mXOffset;}},{key:"getHistoricalY",value:function getHistoricalY(pointerIndex,pos){var moveHistory=MotionEvent.TouchMoveRecord.get(this.mTouchingPointers[pointerIndex].identifier);return (moveHistory[pos].pageY - this.mViewRootTop) * density + this.mYOffset;}},{key:"getHistoricalEventTime",value:function getHistoricalEventTime(){var pos=undefined,activePointerId=undefined;for(var _len15=arguments.length,args=Array(_len15),_key15=0;_key15 < _len15;_key15++) {args[_key15] = arguments[_key15];}if(args.length === 1){pos = args[0];activePointerId = this.mActivePointerId;}else {pos = args[1];activePointerId = this.getPointerId(args[0]);}var moveHistory=MotionEvent.TouchMoveRecord.get(activePointerId);return moveHistory[pos].mEventTime;}},{key:"setAction",value:function setAction(action){this.mAction = action;}},{key:"offsetLocation",value:function offsetLocation(deltaX,deltaY){this.mXOffset += deltaX;this.mYOffset += deltaY;}},{key:"setLocation",value:function setLocation(x,y){this.mXOffset = x - this.getRawX();this.mYOffset = y - this.getRawY();}},{key:"getPointerIdBits",value:function getPointerIdBits(){var idBits=0;var pointerCount=this.getPointerCount();for(var i=0;i < pointerCount;i++) {idBits |= 1 << this.getPointerId(i);}return idBits;}},{key:"split",value:function split(idBits){var ev=MotionEvent.obtain(this);var oldPointerCount=this.getPointerCount();var oldAction=this.getAction();var oldActionMasked=oldAction & MotionEvent.ACTION_MASK;var newPointerIds=[];for(var i=0;i < oldPointerCount;i++) {var pointerId=this.getPointerId(i);var idBit=1 << pointerId;if((idBit & idBits) != 0){newPointerIds.push(pointerId);}}var newActionPointerIndex=newPointerIds.indexOf(this.mActivePointerId);var newPointerCount=newPointerIds.length;var newAction=undefined;if(oldActionMasked == MotionEvent.ACTION_POINTER_DOWN || oldActionMasked == MotionEvent.ACTION_POINTER_UP){if(newActionPointerIndex < 0){newAction = MotionEvent.ACTION_MOVE;}else if(newPointerCount == 1){newAction = oldActionMasked == MotionEvent.ACTION_POINTER_DOWN?MotionEvent.ACTION_DOWN:MotionEvent.ACTION_UP;}else {newAction = oldActionMasked | newActionPointerIndex << MotionEvent.ACTION_POINTER_INDEX_SHIFT;}}else {newAction = oldAction;}ev.mAction = newAction;ev.mTouchingPointers = this.mTouchingPointers.filter(function(item){return newPointerIds.indexOf(item.identifier) >= 0;});return ev;}},{key:"toString",value:function toString(){return "MotionEvent{action=" + this.getAction() + " x=" + this.getX() + " y=" + this.getY() + "}";}}],[{key:"obtainWithTouchEvent",value:function obtainWithTouchEvent(e,action){return new MotionEvent(e,action);}},{key:"obtain",value:function obtain(event){var newEv=new MotionEvent(null,0);Object.assign(newEv,event);return newEv;}},{key:"obtainWithAction",value:function obtainWithAction(downTime,eventTime,action,x,y){var newEv=new MotionEvent(null,action);newEv.mDownTime = downTime;newEv.mEventTime = eventTime;var touch={identifier:0,target:null,screenX:x,screenY:y,clientX:x,clientY:y,pageX:x,pageY:y};newEv.mTouchingPointers = [touch];return newEv;}}]);return MotionEvent;})();MotionEvent.ACTION_MASK = 0xff;MotionEvent.ACTION_DOWN = 0;MotionEvent.ACTION_UP = 1;MotionEvent.ACTION_MOVE = 2;MotionEvent.ACTION_CANCEL = 3;MotionEvent.ACTION_OUTSIDE = 4;MotionEvent.ACTION_POINTER_DOWN = 5;MotionEvent.ACTION_POINTER_UP = 6;MotionEvent.ACTION_HOVER_MOVE = 7;MotionEvent.ACTION_SCROLL = 8;MotionEvent.ACTION_HOVER_ENTER = 9;MotionEvent.ACTION_HOVER_EXIT = 10;MotionEvent.ACTION_POINTER_INDEX_MASK = 0xff00;MotionEvent.ACTION_POINTER_INDEX_SHIFT = 8;MotionEvent.HistoryMaxSize = 10;MotionEvent.TouchMoveRecord = new Map();MotionEvent.IdIndexCache = new Map();view.MotionEvent = MotionEvent;})(view = android.view || (android.view = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/10/5.
 */ ///<reference path="../util/SparseArray.ts"/>
///<reference path="../content/res/Resources.ts"/>
var android;(function(android){var view;(function(view){var Resources=android.content.res.Resources;var metrics=Resources.getDisplayMetrics();var density=metrics.density;var sizeAndDensity=density;var ViewConfiguration=(function(){function ViewConfiguration(){_classCallCheck(this,ViewConfiguration);this.mEdgeSlop = sizeAndDensity * ViewConfiguration.EDGE_SLOP;this.mFadingEdgeLength = sizeAndDensity * ViewConfiguration.FADING_EDGE_LENGTH;this.mMinimumFlingVelocity = density * ViewConfiguration.MINIMUM_FLING_VELOCITY;this.mMaximumFlingVelocity = density * ViewConfiguration.MAXIMUM_FLING_VELOCITY;this.mScrollbarSize = density * ViewConfiguration.SCROLL_BAR_SIZE;this.mTouchSlop = density * ViewConfiguration.TOUCH_SLOP;this.mDoubleTapTouchSlop = sizeAndDensity * ViewConfiguration.DOUBLE_TAP_TOUCH_SLOP;this.mPagingTouchSlop = density * ViewConfiguration.PAGING_TOUCH_SLOP;this.mDoubleTapSlop = density * ViewConfiguration.DOUBLE_TAP_SLOP;this.mWindowTouchSlop = sizeAndDensity * ViewConfiguration.WINDOW_TOUCH_SLOP;this.mOverscrollDistance = sizeAndDensity * ViewConfiguration.OVERSCROLL_DISTANCE;this.mOverflingDistance = sizeAndDensity * ViewConfiguration.OVERFLING_DISTANCE;}_createClass(ViewConfiguration,[{key:"getScaledScrollBarSize",value:function getScaledScrollBarSize(){return this.mScrollbarSize;}},{key:"getScaledFadingEdgeLength",value:function getScaledFadingEdgeLength(){return this.mFadingEdgeLength;}},{key:"getScaledEdgeSlop",value:function getScaledEdgeSlop(){return this.mEdgeSlop;}},{key:"getScaledTouchSlop",value:function getScaledTouchSlop(){return this.mTouchSlop;}},{key:"getScaledPagingTouchSlop",value:function getScaledPagingTouchSlop(){return this.mPagingTouchSlop;}},{key:"getScaledDoubleTapSlop",value:function getScaledDoubleTapSlop(){return this.mDoubleTapSlop;}},{key:"getScaledWindowTouchSlop",value:function getScaledWindowTouchSlop(){return this.mWindowTouchSlop;}},{key:"getScaledMinimumFlingVelocity",value:function getScaledMinimumFlingVelocity(){return this.mMinimumFlingVelocity;}},{key:"getScaledMaximumFlingVelocity",value:function getScaledMaximumFlingVelocity(){return this.mMaximumFlingVelocity;}},{key:"getScaledOverscrollDistance",value:function getScaledOverscrollDistance(){return this.mOverscrollDistance;}},{key:"getScaledOverflingDistance",value:function getScaledOverflingDistance(){return this.mOverflingDistance;}}],[{key:"get",value:function get(){if(!ViewConfiguration.instance){ViewConfiguration.instance = new ViewConfiguration();}return ViewConfiguration.instance;}},{key:"getScrollBarFadeDuration",value:function getScrollBarFadeDuration(){return ViewConfiguration.SCROLL_BAR_FADE_DURATION;}},{key:"getScrollDefaultDelay",value:function getScrollDefaultDelay(){return ViewConfiguration.SCROLL_BAR_DEFAULT_DELAY;}},{key:"getPressedStateDuration",value:function getPressedStateDuration(){return ViewConfiguration.PRESSED_STATE_DURATION;}},{key:"getLongPressTimeout",value:function getLongPressTimeout(){return ViewConfiguration.DEFAULT_LONG_PRESS_TIMEOUT;}},{key:"getKeyRepeatDelay",value:function getKeyRepeatDelay(){return ViewConfiguration.KEY_REPEAT_DELAY;}},{key:"getTapTimeout",value:function getTapTimeout(){return ViewConfiguration.TAP_TIMEOUT;}},{key:"getJumpTapTimeout",value:function getJumpTapTimeout(){return ViewConfiguration.JUMP_TAP_TIMEOUT;}},{key:"getDoubleTapTimeout",value:function getDoubleTapTimeout(){return ViewConfiguration.DOUBLE_TAP_TIMEOUT;}},{key:"getDoubleTapMinTime",value:function getDoubleTapMinTime(){return ViewConfiguration.DOUBLE_TAP_MIN_TIME;}},{key:"getScrollFriction",value:function getScrollFriction(){return ViewConfiguration.SCROLL_FRICTION;}}]);return ViewConfiguration;})();ViewConfiguration.SCROLL_BAR_SIZE = 10;ViewConfiguration.SCROLL_BAR_FADE_DURATION = 250;ViewConfiguration.SCROLL_BAR_DEFAULT_DELAY = 300;ViewConfiguration.FADING_EDGE_LENGTH = 12;ViewConfiguration.PRESSED_STATE_DURATION = 64;ViewConfiguration.DEFAULT_LONG_PRESS_TIMEOUT = 500;ViewConfiguration.KEY_REPEAT_DELAY = 50;ViewConfiguration.GLOBAL_ACTIONS_KEY_TIMEOUT = 500;ViewConfiguration.TAP_TIMEOUT = 180;ViewConfiguration.JUMP_TAP_TIMEOUT = 500;ViewConfiguration.DOUBLE_TAP_TIMEOUT = 300;ViewConfiguration.DOUBLE_TAP_MIN_TIME = 40;ViewConfiguration.HOVER_TAP_TIMEOUT = 150;ViewConfiguration.HOVER_TAP_SLOP = 20;ViewConfiguration.ZOOM_CONTROLS_TIMEOUT = 3000;ViewConfiguration.EDGE_SLOP = 12;ViewConfiguration.TOUCH_SLOP = 8;ViewConfiguration.DOUBLE_TAP_TOUCH_SLOP = ViewConfiguration.TOUCH_SLOP;ViewConfiguration.PAGING_TOUCH_SLOP = ViewConfiguration.TOUCH_SLOP * 2;ViewConfiguration.DOUBLE_TAP_SLOP = 100;ViewConfiguration.WINDOW_TOUCH_SLOP = 16;ViewConfiguration.MINIMUM_FLING_VELOCITY = 50;ViewConfiguration.MAXIMUM_FLING_VELOCITY = 8000;ViewConfiguration.SCROLL_FRICTION = 0.015;ViewConfiguration.OVERSCROLL_DISTANCE = 800;ViewConfiguration.OVERFLING_DISTANCE = 400;view.ViewConfiguration = ViewConfiguration;})(view = android.view || (android.view = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/10/16.
 */ ///<reference path="View.ts"/>
///<reference path="../graphics/Rect.ts"/>
///<reference path="ViewConfiguration.ts"/>
var android;(function(android){var view;(function(view){var Rect=android.graphics.Rect;var TouchDelegate=(function(){function TouchDelegate(bounds,delegateView){_classCallCheck(this,TouchDelegate);this.mDelegateTargeted = false;this.mSlop = 0;this.mBounds = bounds;this.mSlop = view.ViewConfiguration.get().getScaledTouchSlop();this.mSlopBounds = new Rect(bounds);this.mSlopBounds.inset(-this.mSlop,-this.mSlop);this.mDelegateView = delegateView;}_createClass(TouchDelegate,[{key:"onTouchEvent",value:function onTouchEvent(event){var x=event.getX();var y=event.getY();var sendToDelegate=false;var hit=true;var handled=false;switch(event.getAction()){case view.MotionEvent.ACTION_DOWN:var bounds=this.mBounds;if(bounds.contains(x,y)){this.mDelegateTargeted = true;sendToDelegate = true;}break;case view.MotionEvent.ACTION_UP:case view.MotionEvent.ACTION_MOVE:sendToDelegate = this.mDelegateTargeted;if(sendToDelegate){var slopBounds=this.mSlopBounds;if(!slopBounds.contains(x,y)){hit = false;}}break;case view.MotionEvent.ACTION_CANCEL:sendToDelegate = this.mDelegateTargeted;this.mDelegateTargeted = false;break;}if(sendToDelegate){var delegateView=this.mDelegateView;if(hit){event.setLocation(delegateView.getWidth() / 2,delegateView.getHeight() / 2);}else {var slop=this.mSlop;event.setLocation(-(slop * 2),-(slop * 2));}handled = delegateView.dispatchTouchEvent(event);}return handled;}}]);return TouchDelegate;})();view.TouchDelegate = TouchDelegate;})(view = android.view || (android.view = {}));})(android || (android = {}));var android;(function(android){var os;(function(os){var SystemClock=(function(){function SystemClock(){_classCallCheck(this,SystemClock);}_createClass(SystemClock,null,[{key:"uptimeMillis",value:function uptimeMillis(){return new Date().getTime();}}]);return SystemClock;})();os.SystemClock = SystemClock;})(os = android.os || (android.os = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/10/5.
 */ ///<reference path="Handler.ts"/>
///<reference path="../../java/lang/Runnable.ts"/>
///<reference path="../../java/lang/StringBuilder.ts"/>
///<reference path="../util/Pools.ts"/>
///<reference path="SystemClock.ts"/>
var android;(function(android){var os;(function(os){var StringBuilder=java.lang.StringBuilder;var Pools=android.util.Pools;var Message=(function(){function Message(){_classCallCheck(this,Message);this.what = 0;this.arg1 = 0;this.arg2 = 0;this.when = 0;}_createClass(Message,[{key:"recycle",value:function recycle(){this.clearForRecycle();Message.sPool.release(this);}},{key:"copyFrom",value:function copyFrom(o){this.what = o.what;this.arg1 = o.arg1;this.arg2 = o.arg2;this.obj = o.obj;}},{key:"sendToTarget",value:function sendToTarget(){this.target.sendMessage(this);}},{key:"clearForRecycle",value:function clearForRecycle(){this.what = 0;this.arg1 = 0;this.arg2 = 0;this.obj = null;this.when = 0;this.target = null;this.callback = null;}},{key:"toString",value:function toString(){var now=arguments.length <= 0 || arguments[0] === undefined?os.SystemClock.uptimeMillis():arguments[0];var b=new StringBuilder();b.append("{ what=");b.append(this.what);b.append(" when=");b.append(this.when - now).append("ms");if(this.arg1 != 0){b.append(" arg1=");b.append(this.arg1);}if(this.arg2 != 0){b.append(" arg2=");b.append(this.arg2);}if(this.obj != null){b.append(" obj=");b.append(this.obj);}b.append(" }");return b.toString();}}],[{key:"obtain",value:function obtain(){var m=Message.sPool.acquire();m = m || new Message();for(var _len16=arguments.length,args=Array(_len16),_key16=0;_key16 < _len16;_key16++) {args[_key16] = arguments[_key16];}if(args.length === 1 && args[0] instanceof Message){var orig=args[0];var _ref4=[orig.target,orig.what,orig.arg1,orig.arg2,orig.obj,orig.callback];m.target = _ref4[0];m.what = _ref4[1];m.arg1 = _ref4[2];m.arg2 = _ref4[3];m.obj = _ref4[4];m.callback = _ref4[5];}else if(args.length === 2){var _args$011=args[0];m.what = _args$011 === undefined?0:_args$011;m.callback = args[1];}else if(args.length === 3){var _args$012=args[0];m.what = _args$012 === undefined?0:_args$012;var _args$111=args[1];m.arg1 = _args$111 === undefined?0:_args$111;m.obj = args[2];}else {m.target = args[0];var _args$112=args[1];m.what = _args$112 === undefined?0:_args$112;var _args$210=args[2];m.arg1 = _args$210 === undefined?0:_args$210;var _args$310=args[3];m.arg2 = _args$310 === undefined?0:_args$310;m.obj = args[4];m.callback = args[5];}return m;}}]);return Message;})();Message.sPool = new Pools.SynchronizedPool(10);os.Message = Message;})(os = android.os || (android.os = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/10/5.
 */ ///<reference path="Message.ts"/>
///<reference path="Handler.ts"/>
///<reference path="../../java/lang/Runnable.ts"/>
var android;(function(android){var os;(function(os){var MessageQueue=(function(){function MessageQueue(){_classCallCheck(this,MessageQueue);this.messages = new Map();}_createClass(MessageQueue,[{key:"getMessages",value:function getMessages(h,args,object){var msgs=[];if(h == null){return msgs;}if(typeof args === "number"){var what=args;var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=this.messages.keys()[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done);_iteratorNormalCompletion3 = true) {var p=_step3.value;if(p.target == h && p.what == what && (object == null || p.obj == object)){msgs.push(p);}}}catch(err) {_didIteratorError3 = true;_iteratorError3 = err;}finally {try{if(!_iteratorNormalCompletion3 && _iterator3["return"]){_iterator3["return"]();}}finally {if(_didIteratorError3){throw _iteratorError3;}}}}else {var r=args;var _iteratorNormalCompletion4=true;var _didIteratorError4=false;var _iteratorError4=undefined;try{for(var _iterator4=this.messages.keys()[Symbol.iterator](),_step4;!(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done);_iteratorNormalCompletion4 = true) {var p=_step4.value;if(p.target == h && p.callback == r && (object == null || p.obj == object)){msgs.push(p);}}}catch(err) {_didIteratorError4 = true;_iteratorError4 = err;}finally {try{if(!_iteratorNormalCompletion4 && _iterator4["return"]){_iterator4["return"]();}}finally {if(_didIteratorError4){throw _iteratorError4;}}}}return msgs;}},{key:"hasMessages",value:function hasMessages(h,args,object){return this.getMessages(h,args,object).length > 0;}},{key:"addMessage",value:function addMessage(handler,msg,delayHandleID){this.messages.set(msg,delayHandleID);}},{key:"recycleMessage",value:function recycleMessage(handler,message){try{message.recycle();}catch(e) {}var oldId=this.messages.get(message);if(oldId !== undefined){if(oldId > 0)clearTimeout(oldId);else if(oldId < 0)cancelAnimationFrame(-oldId);this.messages["delete"](message);}}},{key:"removeMessages",value:function removeMessages(h,args,object){var _this3=this;var p=this.getMessages(h,args,object);if(p && p.length > 0){p.forEach(function(item){return _this3.recycleMessage(h,item);});}}},{key:"removeCallbacksAndMessages",value:function removeCallbacksAndMessages(h,object){if(h == null){return;}var _iteratorNormalCompletion5=true;var _didIteratorError5=false;var _iteratorError5=undefined;try{for(var _iterator5=this.messages.keys()[Symbol.iterator](),_step5;!(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done);_iteratorNormalCompletion5 = true) {var p=_step5.value;if(p != null && p.target == h && (object == null || p.obj == object)){this.recycleMessage(h,p);}}}catch(err) {_didIteratorError5 = true;_iteratorError5 = err;}finally {try{if(!_iteratorNormalCompletion5 && _iterator5["return"]){_iterator5["return"]();}}finally {if(_didIteratorError5){throw _iteratorError5;}}}}}]);return MessageQueue;})();os.MessageQueue = MessageQueue;})(os = android.os || (android.os = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/10/5.
 */ ///<reference path="Message.ts"/>
///<reference path="MessageQueue.ts"/>
///<reference path="../../java/lang/Runnable.ts"/>
///<reference path="SystemClock.ts"/>
var android;(function(android){var os;(function(os){var Handler=(function(){function Handler(mCallback){_classCallCheck(this,Handler);this.mQueue = new os.MessageQueue();this.mCallback = mCallback;}_createClass(Handler,[{key:"handleMessage",value:function handleMessage(msg){}},{key:"dispatchMessage",value:function dispatchMessage(msg){if(msg.callback != null){msg.callback.run.call(msg.callback);}else {if(this.mCallback != null){if(this.mCallback.handleMessage(msg)){return;}}this.handleMessage(msg);}}},{key:"obtainMessage",value:function obtainMessage(){for(var _len17=arguments.length,args=Array(_len17),_key17=0;_key17 < _len17;_key17++) {args[_key17] = arguments[_key17];}if(args.length === 2){var what=args[0];var obj=args[1];return os.Message.obtain(this,what,obj);}else {var what=args[0];var arg1=args[1];var arg2=args[2];var obj=args[3];return os.Message.obtain(this,what,arg1,arg2,obj);}}},{key:"post",value:function post(r){return this.sendMessageDelayed(Handler.getPostMessage(r),0);}},{key:"postAtTime",value:function postAtTime(){for(var _len18=arguments.length,args=Array(_len18),_key18=0;_key18 < _len18;_key18++) {args[_key18] = arguments[_key18];}if(args.length === 2){var r=args[0];var uptimeMillis=args[1];return this.sendMessageAtTime(Handler.getPostMessage(r),uptimeMillis);}else {var r=args[0];var token=args[1];var uptimeMillis=args[2];return this.sendMessageAtTime(Handler.getPostMessage(r,token),uptimeMillis);}}},{key:"postDelayed",value:function postDelayed(r,delayMillis){return this.sendMessageDelayed(Handler.getPostMessage(r),delayMillis);}},{key:"postAtFrontOfQueue",value:function postAtFrontOfQueue(r){return this.post(r);}},{key:"removeCallbacks",value:function removeCallbacks(r,token){this.mQueue.removeMessages(this,r,token);}},{key:"sendMessage",value:function sendMessage(msg){return this.sendMessageDelayed(msg,0);}},{key:"sendEmptyMessage",value:function sendEmptyMessage(what){return this.sendEmptyMessageDelayed(what,0);}},{key:"sendEmptyMessageDelayed",value:function sendEmptyMessageDelayed(what,delayMillis){var msg=os.Message.obtain();msg.what = what;return this.sendMessageDelayed(msg,delayMillis);}},{key:"sendEmptyMessageAtTime",value:function sendEmptyMessageAtTime(what,uptimeMillis){var msg=os.Message.obtain();msg.what = what;return this.sendMessageAtTime(msg,uptimeMillis);}},{key:"sendMessageDelayed",value:function sendMessageDelayed(msg,delayMillis){var _this4=this;if(delayMillis < 0){delayMillis = 0;}msg.target = this;var func=function func(){_this4.dispatchMessage(msg);_this4.mQueue.recycleMessage(_this4,msg);};if(delayMillis <= 17){var id=-requestAnimationFrame(func);}else {var id=setTimeout(func,delayMillis);}this.mQueue.addMessage(this,msg,id);return true;}},{key:"sendMessageAtTime",value:function sendMessageAtTime(msg,uptimeMillis){return this.sendMessageDelayed(msg,uptimeMillis - os.SystemClock.uptimeMillis());}},{key:"sendMessageAtFrontOfQueue",value:function sendMessageAtFrontOfQueue(msg){return this.sendMessage(msg);}},{key:"removeMessages",value:function removeMessages(what,object){this.mQueue.removeMessages(this,what,object);}},{key:"removeCallbacksAndMessages",value:function removeCallbacksAndMessages(token){this.mQueue.removeCallbacksAndMessages(this,token);}},{key:"hasMessages",value:function hasMessages(what,object){return this.mQueue.hasMessages(this,what,object);}}],[{key:"getPostMessage",value:function getPostMessage(r,token){var m=os.Message.obtain();m.obj = token;m.callback = r;return m;}}]);return Handler;})();os.Handler = Handler;})(os = android.os || (android.os = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/10/29.
 */ ///<reference path="../../util/SparseArray.ts"/>
///<reference path="../../../java/lang/ref/WeakReference.ts"/>
///<reference path="../../util/StateSet.ts"/>
var android;(function(android){var content;(function(content){var res;(function(res){var SparseArray=android.util.SparseArray;var StateSet=android.util.StateSet;var WeakReference=java.lang.ref.WeakReference;var ColorStateList=(function(){function ColorStateList(states,colors){_classCallCheck(this,ColorStateList);this.mDefaultColor = 0xffff0000;this.mStateSpecs = states;this.mColors = colors;if(states.length > 0){this.mDefaultColor = colors[0];for(var i=0;i < states.length;i++) {if(states[i].length == 0){this.mDefaultColor = colors[i];}}}}_createClass(ColorStateList,[{key:"withAlpha",value:function withAlpha(alpha){var colors=new Array(this.mColors.length);var len=colors.length;for(var i=0;i < len;i++) {colors[i] = this.mColors[i] & 0xFFFFFF | alpha << 24;}return new ColorStateList(this.mStateSpecs,colors);}},{key:"isStateful",value:function isStateful(){return this.mStateSpecs.length > 1;}},{key:"getColorForState",value:function getColorForState(stateSet,defaultColor){var setLength=this.mStateSpecs.length;for(var i=0;i < setLength;i++) {var stateSpec=this.mStateSpecs[i];if(StateSet.stateSetMatches(stateSpec,stateSet)){return this.mColors[i];}}return defaultColor;}},{key:"getDefaultColor",value:function getDefaultColor(){return this.mDefaultColor;}},{key:"toString",value:function toString(){return "ColorStateList{" + "mStateSpecs=" + JSON.stringify(this.mStateSpecs) + "mColors=" + JSON.stringify(this.mColors) + "mDefaultColor=" + this.mDefaultColor + '}';}}],[{key:"valueOf",value:function valueOf(color){var ref=ColorStateList.sCache.get(color);var csl=ref != null?ref.get():null;if(csl != null){return csl;}csl = new ColorStateList(ColorStateList.EMPTY,[color]);ColorStateList.sCache.put(color,new WeakReference(csl));return csl;}}]);return ColorStateList;})();ColorStateList.EMPTY = [[]];ColorStateList.sCache = new SparseArray();res.ColorStateList = ColorStateList;})(res = content.res || (content.res = {}));})(content = android.content || (android.content = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/10/27.
 */ ///<reference path="DisplayMetrics.ts"/>
///<reference path="../content/res/Resources.ts"/>
var android;(function(android){var util;(function(util){var Resources=android.content.res.Resources;var TypedValue=(function(){function TypedValue(){_classCallCheck(this,TypedValue);}_createClass(TypedValue,null,[{key:"initUnit",value:function initUnit(){this.initUnit = null;var temp=document.createElement('div');document.body.appendChild(temp);temp.style.height = 100 + TypedValue.COMPLEX_UNIT_PT;TypedValue.UNIT_SCALE_PT = temp.offsetHeight / 100;temp.style.height = 1 + TypedValue.COMPLEX_UNIT_IN;TypedValue.UNIT_SCALE_IN = temp.offsetHeight;temp.style.height = 100 + TypedValue.COMPLEX_UNIT_MM;TypedValue.UNIT_SCALE_MM = temp.offsetHeight / 100;temp.style.height = 10 + TypedValue.COMPLEX_UNIT_EM;TypedValue.UNIT_SCALE_EM = temp.offsetHeight / 10;temp.style.height = 10 + TypedValue.COMPLEX_UNIT_REM;TypedValue.UNIT_SCALE_REM = temp.offsetHeight / 10;document.body.removeChild(temp);}},{key:"complexToDimensionPixelSize",value:function complexToDimensionPixelSize(valueWithUnit){var baseValue=arguments.length <= 1 || arguments[1] === undefined?0:arguments[1];var metrics=arguments.length <= 2 || arguments[2] === undefined?Resources.getDisplayMetrics():arguments[2];if(this.initUnit)this.initUnit();if(valueWithUnit === undefined || valueWithUnit === null)return 0;if(valueWithUnit === '' + Number.parseInt(valueWithUnit))return Number.parseInt(valueWithUnit);if(typeof valueWithUnit !== 'string')valueWithUnit = valueWithUnit + "";var scale=1;if(valueWithUnit.endsWith(TypedValue.COMPLEX_UNIT_PX)){valueWithUnit = valueWithUnit.replace(TypedValue.COMPLEX_UNIT_PX,"");}else if(valueWithUnit.endsWith(TypedValue.COMPLEX_UNIT_DP)){valueWithUnit = valueWithUnit.replace(TypedValue.COMPLEX_UNIT_DP,"");scale = metrics.density;}else if(valueWithUnit.endsWith(TypedValue.COMPLEX_UNIT_DIP)){valueWithUnit = valueWithUnit.replace(TypedValue.COMPLEX_UNIT_DIP,"");scale = metrics.density;}else if(valueWithUnit.endsWith(TypedValue.COMPLEX_UNIT_SP)){valueWithUnit = valueWithUnit.replace(TypedValue.COMPLEX_UNIT_SP,"");scale = metrics.density * TypedValue.UNIT_SCALE_SP;}else if(valueWithUnit.endsWith(TypedValue.COMPLEX_UNIT_PT)){valueWithUnit = valueWithUnit.replace(TypedValue.COMPLEX_UNIT_PT,"");scale = TypedValue.UNIT_SCALE_PT;}else if(valueWithUnit.endsWith(TypedValue.COMPLEX_UNIT_IN)){valueWithUnit = valueWithUnit.replace(TypedValue.COMPLEX_UNIT_IN,"");scale = TypedValue.UNIT_SCALE_IN;}else if(valueWithUnit.endsWith(TypedValue.COMPLEX_UNIT_MM)){valueWithUnit = valueWithUnit.replace(TypedValue.COMPLEX_UNIT_MM,"");scale = TypedValue.UNIT_SCALE_MM;}else if(valueWithUnit.endsWith(TypedValue.COMPLEX_UNIT_EM)){valueWithUnit = valueWithUnit.replace(TypedValue.COMPLEX_UNIT_EM,"");scale = TypedValue.UNIT_SCALE_EM;}else if(valueWithUnit.endsWith(TypedValue.COMPLEX_UNIT_REM)){valueWithUnit = valueWithUnit.replace(TypedValue.COMPLEX_UNIT_REM,"");scale = TypedValue.UNIT_SCALE_REM;}else if(valueWithUnit.endsWith(TypedValue.COMPLEX_UNIT_VH)){valueWithUnit = valueWithUnit.replace(TypedValue.COMPLEX_UNIT_VH,"");scale = metrics.heightPixels / 100;}else if(valueWithUnit.endsWith(TypedValue.COMPLEX_UNIT_VW)){valueWithUnit = valueWithUnit.replace(TypedValue.COMPLEX_UNIT_VW,"");scale = metrics.widthPixels / 100;}else if(valueWithUnit.endsWith(TypedValue.COMPLEX_UNIT_FRACTION)){valueWithUnit = valueWithUnit.replace(TypedValue.COMPLEX_UNIT_FRACTION,"");scale = Number.parseInt(valueWithUnit) / 100;if(Number.isNaN(scale))return 0;valueWithUnit = baseValue;}var value=Number.parseInt(valueWithUnit);if(Number.isNaN(value))return 0;return value * scale;}}]);return TypedValue;})();TypedValue.COMPLEX_UNIT_PX = 'px';TypedValue.COMPLEX_UNIT_DP = 'dp';TypedValue.COMPLEX_UNIT_DIP = 'dip';TypedValue.COMPLEX_UNIT_SP = 'sp';TypedValue.COMPLEX_UNIT_PT = 'pt';TypedValue.COMPLEX_UNIT_IN = 'in';TypedValue.COMPLEX_UNIT_MM = 'mm';TypedValue.COMPLEX_UNIT_EM = 'em';TypedValue.COMPLEX_UNIT_REM = 'rem';TypedValue.COMPLEX_UNIT_VH = 'vh';TypedValue.COMPLEX_UNIT_VW = 'vw';TypedValue.COMPLEX_UNIT_FRACTION = '%';TypedValue.UNIT_SCALE_SP = 1;util.TypedValue = TypedValue;})(util = android.util || (android.util = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/10/9.
 */ ///<reference path="../graphics/Rect.ts"/>
var android;(function(android){var view;(function(view){var Gravity=(function(){function Gravity(){_classCallCheck(this,Gravity);}_createClass(Gravity,null,[{key:"apply",value:function apply(gravity,w,h,container,outRect){var xAdj=0,yAdj=0;switch(gravity & (Gravity.AXIS_PULL_BEFORE | Gravity.AXIS_PULL_AFTER) << Gravity.AXIS_X_SHIFT){case 0:outRect.left = container.left + (container.right - container.left - w) / 2 + xAdj;outRect.right = outRect.left + w;if((gravity & Gravity.AXIS_CLIP << Gravity.AXIS_X_SHIFT) == Gravity.AXIS_CLIP << Gravity.AXIS_X_SHIFT){if(outRect.left < container.left){outRect.left = container.left;}if(outRect.right > container.right){outRect.right = container.right;}}break;case Gravity.AXIS_PULL_BEFORE << Gravity.AXIS_X_SHIFT:outRect.left = container.left + xAdj;outRect.right = outRect.left + w;if((gravity & Gravity.AXIS_CLIP << Gravity.AXIS_X_SHIFT) == Gravity.AXIS_CLIP << Gravity.AXIS_X_SHIFT){if(outRect.right > container.right){outRect.right = container.right;}}break;case Gravity.AXIS_PULL_AFTER << Gravity.AXIS_X_SHIFT:outRect.right = container.right - xAdj;outRect.left = outRect.right - w;if((gravity & Gravity.AXIS_CLIP << Gravity.AXIS_X_SHIFT) == Gravity.AXIS_CLIP << Gravity.AXIS_X_SHIFT){if(outRect.left < container.left){outRect.left = container.left;}}break;default:outRect.left = container.left + xAdj;outRect.right = container.right + xAdj;break;}switch(gravity & (Gravity.AXIS_PULL_BEFORE | Gravity.AXIS_PULL_AFTER) << Gravity.AXIS_Y_SHIFT){case 0:outRect.top = container.top + (container.bottom - container.top - h) / 2 + yAdj;outRect.bottom = outRect.top + h;if((gravity & Gravity.AXIS_CLIP << Gravity.AXIS_Y_SHIFT) == Gravity.AXIS_CLIP << Gravity.AXIS_Y_SHIFT){if(outRect.top < container.top){outRect.top = container.top;}if(outRect.bottom > container.bottom){outRect.bottom = container.bottom;}}break;case Gravity.AXIS_PULL_BEFORE << Gravity.AXIS_Y_SHIFT:outRect.top = container.top + yAdj;outRect.bottom = outRect.top + h;if((gravity & Gravity.AXIS_CLIP << Gravity.AXIS_Y_SHIFT) == Gravity.AXIS_CLIP << Gravity.AXIS_Y_SHIFT){if(outRect.bottom > container.bottom){outRect.bottom = container.bottom;}}break;case Gravity.AXIS_PULL_AFTER << Gravity.AXIS_Y_SHIFT:outRect.bottom = container.bottom - yAdj;outRect.top = outRect.bottom - h;if((gravity & Gravity.AXIS_CLIP << Gravity.AXIS_Y_SHIFT) == Gravity.AXIS_CLIP << Gravity.AXIS_Y_SHIFT){if(outRect.top < container.top){outRect.top = container.top;}}break;default:outRect.top = container.top + yAdj;outRect.bottom = container.bottom + yAdj;break;}}}]);return Gravity;})();Gravity.NO_GRAVITY = 0x0000;Gravity.AXIS_SPECIFIED = 0x0001;Gravity.AXIS_PULL_BEFORE = 0x0002;Gravity.AXIS_PULL_AFTER = 0x0004;Gravity.AXIS_CLIP = 0x0008;Gravity.AXIS_X_SHIFT = 0;Gravity.AXIS_Y_SHIFT = 4;Gravity.TOP = (Gravity.AXIS_PULL_BEFORE | Gravity.AXIS_SPECIFIED) << Gravity.AXIS_Y_SHIFT;Gravity.BOTTOM = (Gravity.AXIS_PULL_AFTER | Gravity.AXIS_SPECIFIED) << Gravity.AXIS_Y_SHIFT;Gravity.LEFT = (Gravity.AXIS_PULL_BEFORE | Gravity.AXIS_SPECIFIED) << Gravity.AXIS_X_SHIFT;Gravity.RIGHT = (Gravity.AXIS_PULL_AFTER | Gravity.AXIS_SPECIFIED) << Gravity.AXIS_X_SHIFT;Gravity.CENTER_VERTICAL = Gravity.AXIS_SPECIFIED << Gravity.AXIS_Y_SHIFT;Gravity.FILL_VERTICAL = Gravity.TOP | Gravity.BOTTOM;Gravity.CENTER_HORIZONTAL = Gravity.AXIS_SPECIFIED << Gravity.AXIS_X_SHIFT;Gravity.FILL_HORIZONTAL = Gravity.LEFT | Gravity.RIGHT;Gravity.CENTER = Gravity.CENTER_VERTICAL | Gravity.CENTER_HORIZONTAL;Gravity.FILL = Gravity.FILL_VERTICAL | Gravity.FILL_HORIZONTAL;Gravity.CLIP_VERTICAL = Gravity.AXIS_CLIP << Gravity.AXIS_Y_SHIFT;Gravity.CLIP_HORIZONTAL = Gravity.AXIS_CLIP << Gravity.AXIS_X_SHIFT;Gravity.HORIZONTAL_GRAVITY_MASK = (Gravity.AXIS_SPECIFIED | Gravity.AXIS_PULL_BEFORE | Gravity.AXIS_PULL_AFTER) << Gravity.AXIS_X_SHIFT;Gravity.VERTICAL_GRAVITY_MASK = (Gravity.AXIS_SPECIFIED | Gravity.AXIS_PULL_BEFORE | Gravity.AXIS_PULL_AFTER) << Gravity.AXIS_Y_SHIFT;Gravity.DISPLAY_CLIP_VERTICAL = 0x10000000;Gravity.DISPLAY_CLIP_HORIZONTAL = 0x01000000;view.Gravity = Gravity;})(view = android.view || (android.view = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/11/1.
 */ ///<reference path="Interpolator.ts"/>
var android;(function(android){var view;(function(view){var animation;(function(animation){var LinearInterpolator=(function(){function LinearInterpolator(){_classCallCheck(this,LinearInterpolator);}_createClass(LinearInterpolator,[{key:"getInterpolation",value:function getInterpolation(input){return input;}}]);return LinearInterpolator;})();animation.LinearInterpolator = LinearInterpolator;})(animation = view.animation || (view.animation = {}));})(view = android.view || (android.view = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/11/1.
 */ ///<reference path="../../os/SystemClock.ts"/>
var android;(function(android){var view;(function(view){var animation;(function(animation){var SystemClock=android.os.SystemClock;var AnimationUtils=(function(){function AnimationUtils(){_classCallCheck(this,AnimationUtils);}_createClass(AnimationUtils,null,[{key:"currentAnimationTimeMillis",value:function currentAnimationTimeMillis(){return SystemClock.uptimeMillis();}}]);return AnimationUtils;})();animation.AnimationUtils = AnimationUtils;})(animation = view.animation || (view.animation = {}));})(view = android.view || (android.view = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/9/27.
 */ ///<reference path="../util/SparseArray.ts"/>
///<reference path="../util/Log.ts"/>
///<reference path="../graphics/drawable/Drawable.ts"/>
///<reference path="../graphics/drawable/ColorDrawable.ts"/>
///<reference path="../graphics/drawable/ScrollBarDrawable.ts"/>
///<reference path="../graphics/PixelFormat.ts"/>
///<reference path="../graphics/Matrix.ts"/>
///<reference path="../graphics/Color.ts"/>
///<reference path="../graphics/Paint.ts"/>
///<reference path="../../java/lang/StringBuilder.ts"/>
///<reference path="../../java/lang/Runnable.ts"/>
///<reference path="../../java/lang/util/concurrent/CopyOnWriteArrayList.ts"/>
///<reference path="../../java/util/ArrayList.ts"/>
///<reference path="ViewRootImpl.ts"/>
///<reference path="ViewParent.ts"/>
///<reference path="ViewGroup.ts"/>
///<reference path="ViewOverlay.ts"/>
///<reference path="ViewTreeObserver.ts"/>
///<reference path="MotionEvent.ts"/>
///<reference path="TouchDelegate.ts"/>
///<reference path="../os/Handler.ts"/>
///<reference path="../os/SystemClock.ts"/>
///<reference path="../content/res/Resources.ts"/>
///<reference path="../content/res/ColorStateList.ts"/>
///<reference path="../graphics/Rect.ts"/>
///<reference path="../graphics/Canvas.ts"/>
///<reference path="../util/Pools.ts"/>
///<reference path="../util/TypedValue.ts"/>
///<reference path="Gravity.ts"/>
///<reference path="../view/animation/LinearInterpolator.ts"/>
///<reference path="../view/animation/AnimationUtils.ts"/>
var android;(function(android){var view;(function(view_1){var SparseArray=android.util.SparseArray;var ColorDrawable=android.graphics.drawable.ColorDrawable;var ScrollBarDrawable=android.graphics.drawable.ScrollBarDrawable;var PixelFormat=android.graphics.PixelFormat;var Matrix=android.graphics.Matrix;var Color=android.graphics.Color;var StringBuilder=java.lang.StringBuilder;var SystemClock=android.os.SystemClock;var Log=android.util.Log;var Rect=android.graphics.Rect;var CopyOnWriteArrayList=java.lang.util.concurrent.CopyOnWriteArrayList;var ArrayList=java.util.ArrayList;var Resources=android.content.res.Resources;var ColorStateList=android.content.res.ColorStateList;var Pools=android.util.Pools;var TypedValue=android.util.TypedValue;var LinearInterpolator=android.view.animation.LinearInterpolator;var AnimationUtils=android.view.animation.AnimationUtils;var View=(function(){function View(){var _this5=this;_classCallCheck(this,View);this.mPrivateFlags = 0;this.mPrivateFlags2 = 0;this.mPrivateFlags3 = 0;this.mOldWidthMeasureSpec = Number.MIN_SAFE_INTEGER;this.mOldHeightMeasureSpec = Number.MIN_SAFE_INTEGER;this.mMeasuredWidth = 0;this.mMeasuredHeight = 0;this.mBackgroundSizeChanged = false;this.mHasPerformedLongPress = false;this.mMinWidth = 0;this.mMinHeight = 0;this.mTouchSlop = 0;this.mVerticalScrollFactor = 0;this.mOverScrollMode = 0;this.mViewFlags = 0;this.mLayerType = View.LAYER_TYPE_NONE;this.mWindowAttachCount = 0;this.mLastIsOpaque = false;this.mLeft = 0;this.mRight = 0;this.mTop = 0;this.mBottom = 0;this.mScrollX = 0;this.mScrollY = 0;this.mPaddingLeft = 0;this.mPaddingRight = 0;this.mPaddingTop = 0;this.mPaddingBottom = 0;this._DOMAttrModifiedEvent = function(event){if(event.attrChange){_this5.onBindElementAttributeChanged(event.attrName,event.prevValue,event.newValue,_this5.getViewRootImpl().mContext);}};this._attrChangeHandler = new View.AttrChangeHandler();this.mTouchSlop = view_1.ViewConfiguration.get().getScaledTouchSlop();this.initializeScrollbars();}_createClass(View,[{key:"createAttrChangeHandler",value:function createAttrChangeHandler(mergeHandler){var view=this;mergeHandler.add(Object.defineProperties({},{background:{set:function set(value){var bg=mergeHandler.parseDrawable(value);if(bg)view.mBackground = bg;},configurable:true,enumerable:true},padding:{set:function set(value){view._setPaddingWithUnit(value,value,value,value);},configurable:true,enumerable:true},paddingLeft:{set:function set(value){view._setPaddingWithUnit(value,view.mPaddingTop,view.mPaddingRight,view.mPaddingBottom);},configurable:true,enumerable:true},paddingTop:{set:function set(value){view._setPaddingWithUnit(view.mPaddingLeft,value,view.mPaddingRight,view.mPaddingBottom);},configurable:true,enumerable:true},paddingRight:{set:function set(value){view._setPaddingWithUnit(view.mPaddingLeft,view.mPaddingTop,value,view.mPaddingBottom);},configurable:true,enumerable:true},paddingBottom:{set:function set(value){view._setPaddingWithUnit(view.mPaddingLeft,view.mPaddingTop,view.mPaddingRight,value);},configurable:true,enumerable:true},scrollX:{set:function set(value){value = Number.parseInt(value);if(Number.isInteger(value))view.scrollTo(value,view.mScrollY);},configurable:true,enumerable:true},scrollY:{set:function set(value){value = Number.parseInt(value);if(Number.isInteger(value))view.scrollTo(view.mScrollX,value);},configurable:true,enumerable:true},alpha:{set:function set(value){value = Number.parseInt(value);if(Number.isInteger(value)){};},configurable:true,enumerable:true},transformPivotX:{set:function set(value){value = Number.parseInt(value);if(Number.isInteger(value)){};},configurable:true,enumerable:true},transformPivotY:{set:function set(value){value = Number.parseInt(value);if(Number.isInteger(value)){};},configurable:true,enumerable:true},translationX:{set:function set(value){value = Number.parseInt(value);if(Number.isInteger(value)){};},configurable:true,enumerable:true},translationY:{set:function set(value){value = Number.parseInt(value);if(Number.isInteger(value)){};},configurable:true,enumerable:true},rotation:{set:function set(value){value = Number.parseInt(value);if(Number.isInteger(value)){};},configurable:true,enumerable:true},rotationX:{set:function set(value){value = Number.parseInt(value);if(Number.isInteger(value)){};},configurable:true,enumerable:true},rotationY:{set:function set(value){value = Number.parseInt(value);if(Number.isInteger(value)){};},configurable:true,enumerable:true},scaleX:{set:function set(value){value = Number.parseInt(value);if(Number.isInteger(value)){};},configurable:true,enumerable:true},scaleY:{set:function set(value){value = Number.parseInt(value);if(Number.isInteger(value)){};},configurable:true,enumerable:true},tag:{set:function set(value){},configurable:true,enumerable:true},id:{set:function set(value){view.bindElement.id = value;},configurable:true,enumerable:true},focusable:{set:function set(value){if(View.AttrChangeHandler.parseBoolean(value,false)){view.setFlags(View.FOCUSABLE,View.FOCUSABLE_MASK);}},configurable:true,enumerable:true},focusableInTouchMode:{set:function set(value){if(View.AttrChangeHandler.parseBoolean(value,false)){view.setFlags(View.FOCUSABLE_IN_TOUCH_MODE | View.FOCUSABLE,View.FOCUSABLE_IN_TOUCH_MODE | View.FOCUSABLE_MASK);}},configurable:true,enumerable:true},clickable:{set:function set(value){if(View.AttrChangeHandler.parseBoolean(value,false)){view.setFlags(View.CLICKABLE,View.CLICKABLE);}},configurable:true,enumerable:true},longClickable:{set:function set(value){if(View.AttrChangeHandler.parseBoolean(value,false)){view.setFlags(View.LONG_CLICKABLE,View.LONG_CLICKABLE);}},configurable:true,enumerable:true},saveEnabled:{set:function set(value){if(View.AttrChangeHandler.parseBoolean(value,false)){}},configurable:true,enumerable:true},duplicateParentState:{set:function set(value){if(View.AttrChangeHandler.parseBoolean(value,false)){view.setFlags(View.DUPLICATE_PARENT_STATE,View.DUPLICATE_PARENT_STATE);}},configurable:true,enumerable:true},visibility:{set:function set(value){if(value === 'gone')view.setVisibility(View.GONE);else if(value === 'invisible')view.setVisibility(View.INVISIBLE);else if(value === 'visible')view.setVisibility(View.VISIBLE);},configurable:true,enumerable:true},scrollbars:{set:function set(value){},configurable:true,enumerable:true},isScrollContainer:{set:function set(value){if(View.AttrChangeHandler.parseBoolean(value,false)){this.setScrollContainer(true);}},configurable:true,enumerable:true},minWidth:{set:function set(value){view.mMinWidth = value;},configurable:true,enumerable:true},minHeight:{set:function set(value){view.mMinHeight = value;},configurable:true,enumerable:true},onClick:{set:function set(value){view.setOnClickListener({onClick:function onClick(v){var activity=view.getViewRootImpl().mContext;if(activity && typeof activity[value] === 'function'){activity[value].call(activity,v);}}});},configurable:true,enumerable:true},overScrollMode:{set:function set(value){var scrollMode=View[('OVER_SCROLL_' + value).toUpperCase()];if(scrollMode === undefined)scrollMode = View.OVER_SCROLL_IF_CONTENT_SCROLLS;view.setOverScrollMode(scrollMode);},configurable:true,enumerable:true},layerType:{set:function set(value){},configurable:true,enumerable:true}}));mergeHandler.isCallSuper = true;}},{key:"getWidth",value:function getWidth(){return this.mRight - this.mLeft;}},{key:"getHeight",value:function getHeight(){return this.mBottom - this.mTop;}},{key:"getTop",value:function getTop(){return this.mTop;}},{key:"setTop",value:function setTop(top){if(top != this.mTop){if(this.mAttachInfo != null){var minTop=undefined;var yLoc=undefined;if(top < this.mTop){minTop = top;yLoc = top - this.mTop;}else {minTop = this.mTop;yLoc = 0;}this.invalidate(0,yLoc,this.mRight - this.mLeft,this.mBottom - minTop);}var width=this.mRight - this.mLeft;var oldHeight=this.mBottom - this.mTop;this.mTop = top;this.sizeChange(width,this.mBottom - this.mTop,width,oldHeight);this.mBackgroundSizeChanged = true;}}},{key:"getBottom",value:function getBottom(){return this.mBottom;}},{key:"setBottom",value:function setBottom(bottom){if(bottom != this.mBottom){if(this.mAttachInfo != null){var maxBottom=undefined;if(bottom < this.mBottom){maxBottom = this.mBottom;}else {maxBottom = bottom;}this.invalidate(0,0,this.mRight - this.mLeft,maxBottom - this.mTop);}var width=this.mRight - this.mLeft;var oldHeight=this.mBottom - this.mTop;this.mBottom = bottom;this.sizeChange(width,this.mBottom - this.mTop,width,oldHeight);this.mBackgroundSizeChanged = true;}}},{key:"getLeft",value:function getLeft(){return this.mLeft;}},{key:"setLeft",value:function setLeft(left){if(left != this.mLeft){if(this.mAttachInfo != null){var minLeft=undefined;var xLoc=undefined;if(left < this.mLeft){minLeft = left;xLoc = left - this.mLeft;}else {minLeft = this.mLeft;xLoc = 0;}this.invalidate(xLoc,0,this.mRight - minLeft,this.mBottom - this.mTop);}var oldWidth=this.mRight - this.mLeft;var height=this.mBottom - this.mTop;this.mLeft = left;this.sizeChange(this.mRight - this.mLeft,height,oldWidth,height);this.mBackgroundSizeChanged = true;}}},{key:"getRight",value:function getRight(){return this.mRight;}},{key:"setRight",value:function setRight(right){if(right != this.mRight){if(this.mAttachInfo != null){var maxRight=undefined;if(right < this.mRight){maxRight = this.mRight;}else {maxRight = right;}this.invalidate(0,0,maxRight - this.mLeft,this.mBottom - this.mTop);}var oldWidth=this.mRight - this.mLeft;var height=this.mBottom - this.mTop;this.mRight = right;this.sizeChange(this.mRight - this.mLeft,height,oldWidth,height);this.mBackgroundSizeChanged = true;}}},{key:"getPaddingLeft",value:function getPaddingLeft(){return this.mPaddingLeft;}},{key:"getPaddingTop",value:function getPaddingTop(){return this.mPaddingTop;}},{key:"getPaddingRight",value:function getPaddingRight(){return this.mPaddingRight;}},{key:"getPaddingBottom",value:function getPaddingBottom(){return this.mPaddingBottom;}},{key:"setPaddingLeft",value:function setPaddingLeft(left){if(this.mPaddingLeft != left){this.mPaddingLeft = left;this.requestLayout();}}},{key:"setPaddingTop",value:function setPaddingTop(top){if(this.mPaddingTop != top){this.mPaddingTop = top;this.requestLayout();}}},{key:"setPaddingRight",value:function setPaddingRight(right){if(this.mPaddingRight != right){this.mPaddingRight = right;this.requestLayout();}}},{key:"setPaddingBottom",value:function setPaddingBottom(bottom){if(this.mPaddingBottom != bottom){this.mPaddingBottom = bottom;this.requestLayout();}}},{key:"setPadding",value:function setPadding(left,top,right,bottom){var changed=false;if(this.mPaddingLeft != left){changed = true;this.mPaddingLeft = left;}if(this.mPaddingTop != top){changed = true;this.mPaddingTop = top;}if(this.mPaddingRight != right){changed = true;this.mPaddingRight = right;}if(this.mPaddingBottom != bottom){changed = true;this.mPaddingBottom = bottom;}if(changed){this.requestLayout();}}},{key:"_setPaddingWithUnit",value:function _setPaddingWithUnit(left,top,right,bottom){var view=this;var dm=Resources.getDisplayMetrics();var width=view.getWidth();var height=view.getHeight();var padLeft=TypedValue.complexToDimensionPixelSize(left,width,dm);var padTop=TypedValue.complexToDimensionPixelSize(top,height,dm);var padRight=TypedValue.complexToDimensionPixelSize(right,width,dm);var padBottom=TypedValue.complexToDimensionPixelSize(bottom,height,dm);view.setPadding(padLeft,padTop,padRight,padBottom);var unit=TypedValue.COMPLEX_UNIT_FRACTION;if(typeof left === 'string' && left.endsWith(unit) || typeof top === 'string' && top.endsWith(unit) || typeof right === 'string' && right.endsWith(unit) || typeof bottom === 'string' && bottom.endsWith(unit)){view.post({run:function run(){var width=view.getWidth();var height=view.getHeight();var padLeftN=TypedValue.complexToDimensionPixelSize(left,width,dm);var padTopN=TypedValue.complexToDimensionPixelSize(top,height,dm);var padRightN=TypedValue.complexToDimensionPixelSize(right,width,dm);var padBottomN=TypedValue.complexToDimensionPixelSize(bottom,height,dm);view.setPadding(padLeftN,padTopN,padRightN,padBottomN);}});}}},{key:"setScrollX",value:function setScrollX(value){this.scrollTo(value,this.mScrollY);}},{key:"setScrollY",value:function setScrollY(value){this.scrollTo(this.mScrollX,value);}},{key:"getScrollX",value:function getScrollX(){return this.mScrollX;}},{key:"getScrollY",value:function getScrollY(){return this.mScrollY;}},{key:"getFinalAlpha",value:function getFinalAlpha(){return 1;}},{key:"getMatrix",value:function getMatrix(){return Matrix.IDENTITY_MATRIX;}},{key:"hasIdentityMatrix",value:function hasIdentityMatrix(){return true;}},{key:"transformRect",value:function transformRect(rect){if(!this.getMatrix().isIdentity()){var boundingRect=this.mAttachInfo.mTmpTransformRect;boundingRect.set(rect);this.getMatrix().mapRect(boundingRect);rect.set(boundingRect);}}},{key:"pointInView",value:function pointInView(localX,localY){var slop=arguments.length <= 2 || arguments[2] === undefined?0:arguments[2];return localX >= -slop && localY >= -slop && localX < this.mRight - this.mLeft + slop && localY < this.mBottom - this.mTop + slop;}},{key:"getHandler",value:function getHandler(){var attachInfo=this.mAttachInfo;if(attachInfo != null){return attachInfo.mHandler;}return null;}},{key:"getViewRootImpl",value:function getViewRootImpl(){if(this.mAttachInfo != null){return this.mAttachInfo.mViewRootImpl;}return null;}},{key:"post",value:function post(action){var attachInfo=this.mAttachInfo;if(attachInfo != null){return attachInfo.mHandler.post(action);}view_1.ViewRootImpl.getRunQueue().post(action);return true;}},{key:"postDelayed",value:function postDelayed(action,delayMillis){var attachInfo=this.mAttachInfo;if(attachInfo != null){return attachInfo.mHandler.postDelayed(action,delayMillis);}view_1.ViewRootImpl.getRunQueue().postDelayed(action,delayMillis);return true;}},{key:"postOnAnimation",value:function postOnAnimation(action){return this.post(action);}},{key:"postOnAnimationDelayed",value:function postOnAnimationDelayed(action,delayMillis){return this.postDelayed(action,delayMillis);}},{key:"removeCallbacks",value:function removeCallbacks(action){if(action != null){var attachInfo=this.mAttachInfo;if(attachInfo != null){attachInfo.mHandler.removeCallbacks(action);}else {view_1.ViewRootImpl.getRunQueue().removeCallbacks(action);}}return true;}},{key:"getParent",value:function getParent(){return this.mParent;}},{key:"setFlags",value:function setFlags(flags,mask){var old=this.mViewFlags;this.mViewFlags = this.mViewFlags & ~mask | flags & mask;var changed=this.mViewFlags ^ old;if(changed == 0){return;}var privateFlags=this.mPrivateFlags;var newVisibility=flags & View.VISIBILITY_MASK;if(newVisibility == View.VISIBLE){if((changed & View.VISIBILITY_MASK) != 0){this.mPrivateFlags |= View.PFLAG_DRAWN;this.invalidate(true);if(this.mParent != null && this.mBottom > this.mTop && this.mRight > this.mLeft){this.mParent.focusableViewAvailable(this);}}}if((changed & View.GONE) != 0){this.requestLayout();if((this.mViewFlags & View.VISIBILITY_MASK) == View.GONE){if(this.hasFocus())this.clearFocus();this.destroyDrawingCache();if(this.mParent instanceof View){this.mParent.invalidate(true);}this.mPrivateFlags |= View.PFLAG_DRAWN;}if(this.mAttachInfo != null){this.mAttachInfo.mViewVisibilityChanged = true;}}if((changed & View.INVISIBLE) != 0){this.mPrivateFlags |= View.PFLAG_DRAWN;if((this.mViewFlags & View.VISIBILITY_MASK) == View.INVISIBLE){if(this.getRootView() != this){if(this.hasFocus())this.clearFocus();}}if(this.mAttachInfo != null){this.mAttachInfo.mViewVisibilityChanged = true;}}if((changed & View.VISIBILITY_MASK) != 0){if(newVisibility != View.VISIBLE){this.cleanupDraw();}if(this.mParent instanceof view_1.ViewGroup){this.mParent.onChildVisibilityChanged(this,changed & View.VISIBILITY_MASK,newVisibility);this.mParent.invalidate(true);}else if(this.mParent != null){this.mParent.invalidateChild(this,null);}this.dispatchVisibilityChanged(this,newVisibility);}if((changed & View.WILL_NOT_CACHE_DRAWING) != 0){this.destroyDrawingCache();}if((changed & View.DRAWING_CACHE_ENABLED) != 0){this.destroyDrawingCache();this.mPrivateFlags &= ~View.PFLAG_DRAWING_CACHE_VALID;this.invalidateParentCaches();}if((changed & View.DRAW_MASK) != 0){if((this.mViewFlags & View.WILL_NOT_DRAW) != 0){if(this.mBackground != null){this.mPrivateFlags &= ~View.PFLAG_SKIP_DRAW;this.mPrivateFlags |= View.PFLAG_ONLY_DRAWS_BACKGROUND;}else {this.mPrivateFlags |= View.PFLAG_SKIP_DRAW;}}else {this.mPrivateFlags &= ~View.PFLAG_SKIP_DRAW;}this.requestLayout();this.invalidate(true);}}},{key:"bringToFront",value:function bringToFront(){if(this.mParent != null){this.mParent.bringChildToFront(this);}}},{key:"onScrollChanged",value:function onScrollChanged(l,t,oldl,oldt){this.mBackgroundSizeChanged = true;var ai=this.mAttachInfo;if(ai != null){ai.mViewScrollChanged = true;}}},{key:"onSizeChanged",value:function onSizeChanged(w,h,oldw,oldh){}},{key:"isFocusable",value:function isFocusable(){return View.FOCUSABLE == (this.mViewFlags & View.FOCUSABLE_MASK);}},{key:"isFocusableInTouchMode",value:function isFocusableInTouchMode(){return View.FOCUSABLE_IN_TOUCH_MODE == (this.mViewFlags & View.FOCUSABLE_IN_TOUCH_MODE);}},{key:"hasFocus",value:function hasFocus(){return (this.mPrivateFlags & View.PFLAG_FOCUSED) != 0;}},{key:"hasFocusable",value:function hasFocusable(){return (this.mViewFlags & View.VISIBILITY_MASK) == View.VISIBLE && this.isFocusable();}},{key:"clearFocus",value:function clearFocus(){}},{key:"findFocus",value:function findFocus(){return (this.mPrivateFlags & View.PFLAG_FOCUSED) != 0?this:null;}},{key:"isFocused",value:function isFocused(){return (this.mPrivateFlags & View.PFLAG_FOCUSED) != 0;}},{key:"getVisibility",value:function getVisibility(){return this.mViewFlags & View.VISIBILITY_MASK;}},{key:"setVisibility",value:function setVisibility(visibility){this.setFlags(visibility,View.VISIBILITY_MASK);if(this.mBackground != null)this.mBackground.setVisible(visibility == View.VISIBLE,false);}},{key:"dispatchVisibilityChanged",value:function dispatchVisibilityChanged(changedView,visibility){this.onVisibilityChanged(changedView,visibility);}},{key:"onVisibilityChanged",value:function onVisibilityChanged(changedView,visibility){if(visibility == View.VISIBLE){if(this.mAttachInfo != null){this.initialAwakenScrollBars();}else {this.mPrivateFlags |= View.PFLAG_AWAKEN_SCROLL_BARS_ON_ATTACH;}}}},{key:"isEnabled",value:function isEnabled(){return (this.mViewFlags & View.ENABLED_MASK) == View.ENABLED;}},{key:"setEnabled",value:function setEnabled(enabled){if(enabled == this.isEnabled())return;this.setFlags(enabled?View.ENABLED:View.DISABLED,View.ENABLED_MASK);this.refreshDrawableState();this.invalidate(true);}},{key:"resetPressedState",value:function resetPressedState(){if((this.mViewFlags & View.ENABLED_MASK) == View.DISABLED){return;}if(this.isPressed()){this.setPressed(false);if(!this.mHasPerformedLongPress){this.removeLongPressCallback();}}}},{key:"dispatchTouchEvent",value:function dispatchTouchEvent(event){if(this.onFilterTouchEventForSecurity(event)){var li=this.mListenerInfo;if(li != null && li.mOnTouchListener != null && (this.mViewFlags & View.ENABLED_MASK) == View.ENABLED && li.mOnTouchListener.onTouch(this,event)){return true;}if(this.onTouchEvent(event)){return true;}}return false;}},{key:"onFilterTouchEventForSecurity",value:function onFilterTouchEventForSecurity(event){return true;}},{key:"onTouchEvent",value:function onTouchEvent(event){var viewFlags=this.mViewFlags;if((viewFlags & View.ENABLED_MASK) == View.DISABLED){if(event.getAction() == view_1.MotionEvent.ACTION_UP && (this.mPrivateFlags & View.PFLAG_PRESSED) != 0){this.setPressed(false);}return (viewFlags & View.CLICKABLE) == View.CLICKABLE || (viewFlags & View.LONG_CLICKABLE) == View.LONG_CLICKABLE;}if(this.mTouchDelegate != null){if(this.mTouchDelegate.onTouchEvent(event)){return true;}}if((viewFlags & View.CLICKABLE) == View.CLICKABLE || (viewFlags & View.LONG_CLICKABLE) == View.LONG_CLICKABLE){switch(event.getAction()){case view_1.MotionEvent.ACTION_UP:var prepressed=(this.mPrivateFlags & View.PFLAG_PREPRESSED) != 0;if((this.mPrivateFlags & View.PFLAG_PRESSED) != 0 || prepressed){var focusTaken=false;if(prepressed){this.setPressed(true);}if(!this.mHasPerformedLongPress){this.removeLongPressCallback();if(!focusTaken){if(this.mPerformClick == null){this.mPerformClick = new PerformClick(this);}if(!this.post(this.mPerformClick)){this.performClick();}}}if(this.mUnsetPressedState == null){this.mUnsetPressedState = new UnsetPressedState(this);}if(prepressed){this.postDelayed(this.mUnsetPressedState,view_1.ViewConfiguration.getPressedStateDuration());}else if(!this.post(this.mUnsetPressedState)){this.mUnsetPressedState.run();}this.removeTapCallback();}break;case view_1.MotionEvent.ACTION_DOWN:this.mHasPerformedLongPress = false;var isInScrollingContainer=this.isInScrollingContainer();if(isInScrollingContainer){this.mPrivateFlags |= View.PFLAG_PREPRESSED;if(this.mPendingCheckForTap == null){this.mPendingCheckForTap = new CheckForTap(this);}this.postDelayed(this.mPendingCheckForTap,view_1.ViewConfiguration.getTapTimeout());}else {this.setPressed(true);this.checkForLongClick(0);}break;case view_1.MotionEvent.ACTION_CANCEL:this.setPressed(false);this.removeTapCallback();this.removeLongPressCallback();break;case view_1.MotionEvent.ACTION_MOVE:var x=event.getX();var y=event.getY();if(!this.pointInView(x,y,this.mTouchSlop)){this.removeTapCallback();if((this.mPrivateFlags & View.PFLAG_PRESSED) != 0){this.removeLongPressCallback();this.setPressed(false);}}break;}return true;}return false;}},{key:"isInScrollingContainer",value:function isInScrollingContainer(){var p=this.getParent();while(p != null && p instanceof view_1.ViewGroup) {if(p.shouldDelayChildPressedState()){return true;}p = p.getParent();}return false;}},{key:"removeLongPressCallback",value:function removeLongPressCallback(){if(this.mPendingCheckForLongPress != null){this.removeCallbacks(this.mPendingCheckForLongPress);}}},{key:"removePerformClickCallback",value:function removePerformClickCallback(){if(this.mPerformClick != null){this.removeCallbacks(this.mPerformClick);}}},{key:"removeUnsetPressCallback",value:function removeUnsetPressCallback(){if((this.mPrivateFlags & View.PFLAG_PRESSED) != 0 && this.mUnsetPressedState != null){this.setPressed(false);this.removeCallbacks(this.mUnsetPressedState);}}},{key:"removeTapCallback",value:function removeTapCallback(){if(this.mPendingCheckForTap != null){this.mPrivateFlags &= ~View.PFLAG_PREPRESSED;this.removeCallbacks(this.mPendingCheckForTap);}}},{key:"cancelLongPress",value:function cancelLongPress(){this.removeLongPressCallback();this.removeTapCallback();}},{key:"setTouchDelegate",value:function setTouchDelegate(delegate){this.mTouchDelegate = delegate;}},{key:"getTouchDelegate",value:function getTouchDelegate(){return this.mTouchDelegate;}},{key:"getListenerInfo",value:function getListenerInfo(){if(this.mListenerInfo != null){return this.mListenerInfo;}this.mListenerInfo = new View.ListenerInfo();return this.mListenerInfo;}},{key:"addOnLayoutChangeListener",value:function addOnLayoutChangeListener(listener){var li=this.getListenerInfo();if(li.mOnLayoutChangeListeners == null){li.mOnLayoutChangeListeners = new ArrayList();}if(!li.mOnLayoutChangeListeners.contains(listener)){li.mOnLayoutChangeListeners.add(listener);}}},{key:"removeOnLayoutChangeListener",value:function removeOnLayoutChangeListener(listener){var li=this.mListenerInfo;if(li == null || li.mOnLayoutChangeListeners == null){return;}li.mOnLayoutChangeListeners.remove(listener);}},{key:"addOnAttachStateChangeListener",value:function addOnAttachStateChangeListener(listener){var li=this.getListenerInfo();if(li.mOnAttachStateChangeListeners == null){li.mOnAttachStateChangeListeners = new CopyOnWriteArrayList();}li.mOnAttachStateChangeListeners.add(listener);}},{key:"removeOnAttachStateChangeListener",value:function removeOnAttachStateChangeListener(listener){var li=this.mListenerInfo;if(li == null || li.mOnAttachStateChangeListeners == null){return;}li.mOnAttachStateChangeListeners.remove(listener);}},{key:"setOnClickListener",value:function setOnClickListener(l){if(!this.isClickable()){this.setClickable(true);}this.getListenerInfo().mOnClickListener = l;}},{key:"hasOnClickListeners",value:function hasOnClickListeners(){var li=this.mListenerInfo;return li != null && li.mOnClickListener != null;}},{key:"setOnLongClickListener",value:function setOnLongClickListener(l){if(!this.isLongClickable()){this.setLongClickable(true);}this.getListenerInfo().mOnLongClickListener = l;}},{key:"performClick",value:function performClick(){var li=this.mListenerInfo;if(li != null && li.mOnClickListener != null){li.mOnClickListener.onClick(this);return true;}return false;}},{key:"callOnClick",value:function callOnClick(){var li=this.mListenerInfo;if(li != null && li.mOnClickListener != null){li.mOnClickListener.onClick(this);return true;}return false;}},{key:"performLongClick",value:function performLongClick(){var handled=false;var li=this.mListenerInfo;if(li != null && li.mOnLongClickListener != null){handled = li.mOnLongClickListener.onLongClick(this);}return handled;}},{key:"checkForLongClick",value:function checkForLongClick(){var delayOffset=arguments.length <= 0 || arguments[0] === undefined?0:arguments[0];if((this.mViewFlags & View.LONG_CLICKABLE) == View.LONG_CLICKABLE){this.mHasPerformedLongPress = false;if(this.mPendingCheckForLongPress == null){this.mPendingCheckForLongPress = new CheckForLongPress(this);}this.mPendingCheckForLongPress.rememberWindowAttachCount();this.postDelayed(this.mPendingCheckForLongPress,view_1.ViewConfiguration.getLongPressTimeout() - delayOffset);}}},{key:"setOnTouchListener",value:function setOnTouchListener(l){this.getListenerInfo().mOnTouchListener = l;}},{key:"isClickable",value:function isClickable(){return (this.mViewFlags & View.CLICKABLE) == View.CLICKABLE;}},{key:"setClickable",value:function setClickable(clickable){this.setFlags(clickable?View.CLICKABLE:0,View.CLICKABLE);}},{key:"isLongClickable",value:function isLongClickable(){return (this.mViewFlags & View.LONG_CLICKABLE) == View.LONG_CLICKABLE;}},{key:"setLongClickable",value:function setLongClickable(longClickable){this.setFlags(longClickable?View.LONG_CLICKABLE:0,View.LONG_CLICKABLE);}},{key:"setPressed",value:function setPressed(pressed){}},{key:"isPressed",value:function isPressed(){return (this.mPrivateFlags & View.PFLAG_PRESSED) == View.PFLAG_PRESSED;}},{key:"setSelected",value:function setSelected(selected){if((this.mPrivateFlags & View.PFLAG_SELECTED) != 0 != selected){this.mPrivateFlags = this.mPrivateFlags & ~View.PFLAG_SELECTED | (selected?View.PFLAG_SELECTED:0);if(!selected)this.resetPressedState();this.invalidate(true);this.refreshDrawableState();this.dispatchSetSelected(selected);}}},{key:"dispatchSetSelected",value:function dispatchSetSelected(selected){}},{key:"isSelected",value:function isSelected(){return (this.mPrivateFlags & View.PFLAG_SELECTED) != 0;}},{key:"setActivated",value:function setActivated(activated){if((this.mPrivateFlags & View.PFLAG_ACTIVATED) != 0 != activated){this.mPrivateFlags = this.mPrivateFlags & ~View.PFLAG_ACTIVATED | (activated?View.PFLAG_ACTIVATED:0);this.invalidate(true);this.refreshDrawableState();this.dispatchSetActivated(activated);}}},{key:"dispatchSetActivated",value:function dispatchSetActivated(activated){}},{key:"isActivated",value:function isActivated(){return (this.mPrivateFlags & View.PFLAG_ACTIVATED) != 0;}},{key:"getViewTreeObserver",value:function getViewTreeObserver(){if(this.mAttachInfo != null){return this.mAttachInfo.mTreeObserver;}if(this.mFloatingTreeObserver == null){this.mFloatingTreeObserver = new view_1.ViewTreeObserver();}return this.mFloatingTreeObserver;}},{key:"isLayoutRtl",value:function isLayoutRtl(){return false;}},{key:"getBaseline",value:function getBaseline(){return -1;}},{key:"isLayoutRequested",value:function isLayoutRequested(){return (this.mPrivateFlags & View.PFLAG_FORCE_LAYOUT) == View.PFLAG_FORCE_LAYOUT;}},{key:"getLayoutParams",value:function getLayoutParams(){return this.mLayoutParams;}},{key:"setLayoutParams",value:function setLayoutParams(params){if(params == null){throw new Error("Layout parameters cannot be null");}this.mLayoutParams = params;var p=this.mParent;if(p instanceof view_1.ViewGroup){p.onSetLayoutParams(this,params);}this.requestLayout();}},{key:"requestLayout",value:function requestLayout(){if(this.mMeasureCache != null)this.mMeasureCache.clear();if(this.mAttachInfo != null && this.mAttachInfo.mViewRequestingLayout == null){var viewRoot=this.getViewRootImpl();if(viewRoot != null && viewRoot.isInLayout()){if(!viewRoot.requestLayoutDuringLayout(this)){return;}}this.mAttachInfo.mViewRequestingLayout = this;}this.mPrivateFlags |= View.PFLAG_FORCE_LAYOUT;this.mPrivateFlags |= View.PFLAG_INVALIDATED;if(this.mParent != null && !this.mParent.isLayoutRequested()){this.mParent.requestLayout();}}},{key:"forceLayout",value:function forceLayout(){if(this.mMeasureCache != null)this.mMeasureCache.clear();this.mPrivateFlags |= View.PFLAG_FORCE_LAYOUT;this.mPrivateFlags |= View.PFLAG_INVALIDATED;}},{key:"isLaidOut",value:function isLaidOut(){return (this.mPrivateFlags3 & View.PFLAG3_IS_LAID_OUT) == View.PFLAG3_IS_LAID_OUT;}},{key:"layout",value:function layout(l,t,r,b){if((this.mPrivateFlags3 & View.PFLAG3_MEASURE_NEEDED_BEFORE_LAYOUT) != 0){this.onMeasure(this.mOldWidthMeasureSpec,this.mOldHeightMeasureSpec);this.mPrivateFlags3 &= ~View.PFLAG3_MEASURE_NEEDED_BEFORE_LAYOUT;}var oldL=this.mLeft;var oldT=this.mTop;var oldB=this.mBottom;var oldR=this.mRight;var changed=this.setFrame(l,t,r,b);if(changed)this.syncBoundToElement();if(changed || (this.mPrivateFlags & View.PFLAG_LAYOUT_REQUIRED) == View.PFLAG_LAYOUT_REQUIRED){this.onLayout(changed,l,t,r,b);this.mPrivateFlags &= ~View.PFLAG_LAYOUT_REQUIRED;var li=this.mListenerInfo;if(li != null && li.mOnLayoutChangeListeners != null){var listenersCopy=li.mOnLayoutChangeListeners.clone();var numListeners=listenersCopy.size();for(var i=0;i < numListeners;++i) {listenersCopy.get(i).onLayoutChange(this,l,t,r,b,oldL,oldT,oldR,oldB);}}}this.mPrivateFlags &= ~View.PFLAG_FORCE_LAYOUT;this.mPrivateFlags3 |= View.PFLAG3_IS_LAID_OUT;}},{key:"onLayout",value:function onLayout(changed,left,top,right,bottom){}},{key:"setFrame",value:function setFrame(left,top,right,bottom){var changed=false;if(View.DBG){Log.i("View",this + " View.setFrame(" + left + "," + top + "," + right + "," + bottom + ")");}if(this.mLeft != left || this.mRight != right || this.mTop != top || this.mBottom != bottom){changed = true;var drawn=this.mPrivateFlags & View.PFLAG_DRAWN;var oldWidth=this.mRight - this.mLeft;var oldHeight=this.mBottom - this.mTop;var newWidth=right - left;var newHeight=bottom - top;var sizeChanged=newWidth != oldWidth || newHeight != oldHeight;this.invalidate(sizeChanged);this.mLeft = left;this.mTop = top;this.mRight = right;this.mBottom = bottom;this.mPrivateFlags |= View.PFLAG_HAS_BOUNDS;if(sizeChanged){if((this.mPrivateFlags & View.PFLAG_PIVOT_EXPLICITLY_SET) == 0){}this.sizeChange(newWidth,newHeight,oldWidth,oldHeight);}if((this.mViewFlags & View.VISIBILITY_MASK) == View.VISIBLE){this.mPrivateFlags |= View.PFLAG_DRAWN;this.invalidate(sizeChanged);}this.mPrivateFlags |= drawn;this.mBackgroundSizeChanged = true;}return changed;}},{key:"sizeChange",value:function sizeChange(newWidth,newHeight,oldWidth,oldHeight){this.onSizeChanged(newWidth,newHeight,oldWidth,oldHeight);if(this.mOverlay != null){this.mOverlay.getOverlayView().setRight(newWidth);this.mOverlay.getOverlayView().setBottom(newHeight);}}},{key:"getDrawingRect",value:function getDrawingRect(outRect){outRect.left = this.mScrollX;outRect.top = this.mScrollY;outRect.right = this.mScrollX + (this.mRight - this.mLeft);outRect.bottom = this.mScrollY + (this.mBottom - this.mTop);}},{key:"getMeasuredWidth",value:function getMeasuredWidth(){return this.mMeasuredWidth & View.MEASURED_SIZE_MASK;}},{key:"getMeasuredWidthAndState",value:function getMeasuredWidthAndState(){return this.mMeasuredWidth;}},{key:"getMeasuredHeight",value:function getMeasuredHeight(){return this.mMeasuredHeight & View.MEASURED_SIZE_MASK;}},{key:"getMeasuredHeightAndState",value:function getMeasuredHeightAndState(){return this.mMeasuredHeight;}},{key:"getMeasuredState",value:function getMeasuredState(){return this.mMeasuredWidth & View.MEASURED_STATE_MASK | this.mMeasuredHeight >> View.MEASURED_HEIGHT_STATE_SHIFT & View.MEASURED_STATE_MASK >> View.MEASURED_HEIGHT_STATE_SHIFT;}},{key:"measure",value:function measure(widthMeasureSpec,heightMeasureSpec){var key=widthMeasureSpec << 32 | heightMeasureSpec & 0xffffffff;if(this.mMeasureCache == null)this.mMeasureCache = new SparseArray();if((this.mPrivateFlags & View.PFLAG_FORCE_LAYOUT) == View.PFLAG_FORCE_LAYOUT || widthMeasureSpec != this.mOldWidthMeasureSpec || heightMeasureSpec != this.mOldHeightMeasureSpec){this.mPrivateFlags &= ~View.PFLAG_MEASURED_DIMENSION_SET;var cacheIndex=(this.mPrivateFlags & View.PFLAG_FORCE_LAYOUT) == View.PFLAG_FORCE_LAYOUT?-1:this.mMeasureCache.indexOfKey(key);if(cacheIndex < 0){this.onMeasure(widthMeasureSpec,heightMeasureSpec);this.mPrivateFlags3 &= ~View.PFLAG3_MEASURE_NEEDED_BEFORE_LAYOUT;}else {var value=this.mMeasureCache.valueAt(cacheIndex);this.setMeasuredDimension(value >> 32,value);this.mPrivateFlags3 |= View.PFLAG3_MEASURE_NEEDED_BEFORE_LAYOUT;}if((this.mPrivateFlags & View.PFLAG_MEASURED_DIMENSION_SET) != View.PFLAG_MEASURED_DIMENSION_SET){throw new Error("onMeasure() did not set the" + " measured dimension by calling" + " setMeasuredDimension()");}this.mPrivateFlags |= View.PFLAG_LAYOUT_REQUIRED;}this.mOldWidthMeasureSpec = widthMeasureSpec;this.mOldHeightMeasureSpec = heightMeasureSpec;this.mMeasureCache.put(key,this.mMeasuredWidth << 32 | this.mMeasuredHeight & 0xffffffff);}},{key:"onMeasure",value:function onMeasure(widthMeasureSpec,heightMeasureSpec){this.setMeasuredDimension(View.getDefaultSize(this.getSuggestedMinimumWidth(),widthMeasureSpec),View.getDefaultSize(this.getSuggestedMinimumHeight(),heightMeasureSpec));}},{key:"setMeasuredDimension",value:function setMeasuredDimension(measuredWidth,measuredHeight){this.mMeasuredWidth = measuredWidth;this.mMeasuredHeight = measuredHeight;this.mPrivateFlags |= View.PFLAG_MEASURED_DIMENSION_SET;}},{key:"getSuggestedMinimumHeight",value:function getSuggestedMinimumHeight(){return this.mBackground == null?this.mMinHeight:Math.max(this.mMinHeight,this.mBackground.getMinimumHeight());}},{key:"getSuggestedMinimumWidth",value:function getSuggestedMinimumWidth(){return this.mBackground == null?this.mMinWidth:Math.max(this.mMinWidth,this.mBackground.getMinimumWidth());}},{key:"getMinimumHeight",value:function getMinimumHeight(){return this.mMinHeight;}},{key:"setMinimumHeight",value:function setMinimumHeight(minHeight){this.mMinHeight = minHeight;this.requestLayout();}},{key:"getMinimumWidth",value:function getMinimumWidth(){return this.mMinWidth;}},{key:"setMinimumWidth",value:function setMinimumWidth(minWidth){this.mMinWidth = minWidth;this.requestLayout();}},{key:"_invalidateRect",value:function _invalidateRect(l,t,r,b){if(this.skipInvalidate()){return;}if((this.mPrivateFlags & (View.PFLAG_DRAWN | View.PFLAG_HAS_BOUNDS)) == (View.PFLAG_DRAWN | View.PFLAG_HAS_BOUNDS) || (this.mPrivateFlags & View.PFLAG_DRAWING_CACHE_VALID) == View.PFLAG_DRAWING_CACHE_VALID || (this.mPrivateFlags & View.PFLAG_INVALIDATED) != View.PFLAG_INVALIDATED){this.mPrivateFlags &= ~View.PFLAG_DRAWING_CACHE_VALID;this.mPrivateFlags |= View.PFLAG_INVALIDATED;this.mPrivateFlags |= View.PFLAG_DIRTY;var p=this.mParent;var ai=this.mAttachInfo;if(p != null && ai != null && l < r && t < b){var _scrollX=this.mScrollX;var _scrollY=this.mScrollY;var tmpr=ai.mTmpInvalRect;tmpr.set(l - _scrollX,t - _scrollY,r - _scrollX,b - _scrollY);p.invalidateChild(this,tmpr);}}}},{key:"_invalidateCache",value:function _invalidateCache(){var invalidateCache=arguments.length <= 0 || arguments[0] === undefined?true:arguments[0];if(this.skipInvalidate()){return;}if((this.mPrivateFlags & (View.PFLAG_DRAWN | View.PFLAG_HAS_BOUNDS)) == (View.PFLAG_DRAWN | View.PFLAG_HAS_BOUNDS) || invalidateCache && (this.mPrivateFlags & View.PFLAG_DRAWING_CACHE_VALID) == View.PFLAG_DRAWING_CACHE_VALID || (this.mPrivateFlags & View.PFLAG_INVALIDATED) != View.PFLAG_INVALIDATED || this.isOpaque() != this.mLastIsOpaque){this.mLastIsOpaque = this.isOpaque();this.mPrivateFlags &= ~View.PFLAG_DRAWN;this.mPrivateFlags |= View.PFLAG_DIRTY;if(invalidateCache){this.mPrivateFlags |= View.PFLAG_INVALIDATED;this.mPrivateFlags &= ~View.PFLAG_DRAWING_CACHE_VALID;}var ai=this.mAttachInfo;var p=this.mParent;if(p != null && ai != null){var r=ai.mTmpInvalRect;r.set(0,0,this.mRight - this.mLeft,this.mBottom - this.mTop);p.invalidateChild(this,r);}}}},{key:"invalidate",value:function invalidate(){for(var _len19=arguments.length,args=Array(_len19),_key19=0;_key19 < _len19;_key19++) {args[_key19] = arguments[_key19];}if(args.length === 0 || args.length === 1 && typeof args[0] === 'boolean'){this._invalidateCache(args[0]);}else if(args.length === 1 && args[0] instanceof Rect){var rect=args[0];this._invalidateRect(rect.left,rect.top,rect.right,rect.bottom);}else if(args.length === 4){this._invalidateRect.apply(this,args);}}},{key:"invalidateViewProperty",value:function invalidateViewProperty(invalidateParent,forceRedraw){if((this.mPrivateFlags & View.PFLAG_DRAW_ANIMATION) == View.PFLAG_DRAW_ANIMATION){if(invalidateParent){this.invalidateParentCaches();}if(forceRedraw){this.mPrivateFlags |= View.PFLAG_DRAWN;}this.invalidate(false);}else {var ai=this.mAttachInfo;var p=this.mParent;if(p != null && ai != null){var r=ai.mTmpInvalRect;r.set(0,0,this.mRight - this.mLeft,this.mBottom - this.mTop);if(this.mParent instanceof view_1.ViewGroup){this.mParent.invalidateChildFast(this,r);}else {this.mParent.invalidateChild(this,r);}}}}},{key:"invalidateParentCaches",value:function invalidateParentCaches(){if(this.mParent instanceof View){this.mParent.mPrivateFlags |= View.PFLAG_INVALIDATED;}}},{key:"invalidateParentIfNeeded",value:function invalidateParentIfNeeded(){}},{key:"postInvalidate",value:function postInvalidate(l,t,r,b){this.postInvalidateDelayed(0,l,t,r,b);}},{key:"postInvalidateDelayed",value:function postInvalidateDelayed(delayMilliseconds,left,top,right,bottom){var attachInfo=this.mAttachInfo;if(attachInfo != null){if(!Number.isInteger(left) || !Number.isInteger(top) || !Number.isInteger(right) || !Number.isInteger(bottom)){attachInfo.mViewRootImpl.dispatchInvalidateDelayed(this,delayMilliseconds);}else {var info=View.AttachInfo.InvalidateInfo.obtain();info.target = this;info.left = left;info.top = top;info.right = right;info.bottom = bottom;attachInfo.mViewRootImpl.dispatchInvalidateRectDelayed(info,delayMilliseconds);}}}},{key:"postInvalidateOnAnimation",value:function postInvalidateOnAnimation(left,top,right,bottom){var attachInfo=this.mAttachInfo;if(attachInfo != null){if(!Number.isInteger(left) || !Number.isInteger(top) || !Number.isInteger(right) || !Number.isInteger(bottom)){attachInfo.mViewRootImpl.dispatchInvalidateOnAnimation(this);}else {var info=View.AttachInfo.InvalidateInfo.obtain();info.target = this;info.left = left;info.top = top;info.right = right;info.bottom = bottom;attachInfo.mViewRootImpl.dispatchInvalidateRectOnAnimation(info);}}}},{key:"skipInvalidate",value:function skipInvalidate(){return (this.mViewFlags & View.VISIBILITY_MASK) != View.VISIBLE;}},{key:"isOpaque",value:function isOpaque(){return (this.mPrivateFlags & View.PFLAG_OPAQUE_MASK) == View.PFLAG_OPAQUE_MASK && this.getFinalAlpha() >= 1;}},{key:"computeOpaqueFlags",value:function computeOpaqueFlags(){ // Opaque if:
//   - Has a background
//   - Background is opaque
//   - Doesn't have scrollbars or scrollbars overlay
if(this.mBackground != null && this.mBackground.getOpacity() == PixelFormat.OPAQUE){this.mPrivateFlags |= View.PFLAG_OPAQUE_BACKGROUND;}else {this.mPrivateFlags &= ~View.PFLAG_OPAQUE_BACKGROUND;}var flags=this.mViewFlags;if((flags & View.SCROLLBARS_VERTICAL) == 0 && (flags & View.SCROLLBARS_HORIZONTAL) == 0){this.mPrivateFlags |= View.PFLAG_OPAQUE_SCROLLBARS;}else {this.mPrivateFlags &= ~View.PFLAG_OPAQUE_SCROLLBARS;}}},{key:"getLayerType",value:function getLayerType(){return this.mLayerType;}},{key:"setClipBounds",value:function setClipBounds(clipBounds){if(clipBounds != null){if(clipBounds.equals(this.mClipBounds)){return;}if(this.mClipBounds == null){this.invalidate();this.mClipBounds = new Rect(clipBounds);}else {this.invalidate(Math.min(this.mClipBounds.left,clipBounds.left),Math.min(this.mClipBounds.top,clipBounds.top),Math.max(this.mClipBounds.right,clipBounds.right),Math.max(this.mClipBounds.bottom,clipBounds.bottom));this.mClipBounds.set(clipBounds);}}else {if(this.mClipBounds != null){this.invalidate();this.mClipBounds = null;}}}},{key:"getClipBounds",value:function getClipBounds(){return this.mClipBounds != null?new Rect(this.mClipBounds):null;}},{key:"getDrawingTime",value:function getDrawingTime(){return this.mAttachInfo != null?this.mAttachInfo.mDrawingTime:0;}},{key:"drawFromParent",value:function drawFromParent(canvas,parent,drawingTime){var useDisplayListProperties=false;var more=false;var childHasIdentityMatrix=true;var flags=parent.mGroupFlags;var scalingRequired=false;var concatMatrix=false;var caching=false;var layerType=this.getLayerType();if((flags & view_1.ViewGroup.FLAG_CHILDREN_DRAWN_WITH_CACHE) != 0 || (flags & view_1.ViewGroup.FLAG_ALWAYS_DRAWN_WITH_CACHE) != 0){caching = true;}else {caching = layerType != View.LAYER_TYPE_NONE;}concatMatrix == concatMatrix || !childHasIdentityMatrix;this.mPrivateFlags |= View.PFLAG_DRAWN;if(!concatMatrix && (flags & (view_1.ViewGroup.FLAG_SUPPORT_STATIC_TRANSFORMATIONS | view_1.ViewGroup.FLAG_CLIP_CHILDREN)) == view_1.ViewGroup.FLAG_CLIP_CHILDREN && canvas.quickReject(this.mLeft,this.mTop,this.mRight,this.mBottom) && (this.mPrivateFlags & View.PFLAG_DRAW_ANIMATION) == 0){this.mPrivateFlags2 |= View.PFLAG2_VIEW_QUICK_REJECTED;return more;}this.mPrivateFlags2 &= ~View.PFLAG2_VIEW_QUICK_REJECTED;var cache=null;if(caching){if(layerType != View.LAYER_TYPE_NONE){layerType = View.LAYER_TYPE_SOFTWARE;}}this.computeScroll();var sx=this.mScrollX;var sy=this.mScrollY;this.syncScrollToElement();var hasNoCache=cache == null;var offsetForScroll=cache == null;var restoreTo=canvas.save();if(offsetForScroll){canvas.translate(this.mLeft - sx,this.mTop - sy);}else {canvas.translate(this.mLeft,this.mTop);}var alpha=1;if((flags & view_1.ViewGroup.FLAG_CLIP_CHILDREN) == view_1.ViewGroup.FLAG_CLIP_CHILDREN && !useDisplayListProperties && cache == null){if(offsetForScroll){canvas.clipRect(sx,sy,sx + (this.mRight - this.mLeft),sy + (this.mBottom - this.mTop));}else {if(!scalingRequired || cache == null){canvas.clipRect(0,0,this.mRight - this.mLeft,this.mBottom - this.mTop);}else {canvas.clipRect(0,0,cache.getWidth(),cache.getHeight());}}}if(hasNoCache){if((this.mPrivateFlags & View.PFLAG_SKIP_DRAW) == View.PFLAG_SKIP_DRAW){this.mPrivateFlags &= ~View.PFLAG_DIRTY_MASK;this.dispatchDraw(canvas);}else {this.draw(canvas);}}else if(cache != null){this.mPrivateFlags &= ~View.PFLAG_DIRTY_MASK;if(alpha < 1){parent.mGroupFlags |= view_1.ViewGroup.FLAG_ALPHA_LOWER_THAN_ONE;}else if((flags & view_1.ViewGroup.FLAG_ALPHA_LOWER_THAN_ONE) != 0){parent.mGroupFlags &= ~view_1.ViewGroup.FLAG_ALPHA_LOWER_THAN_ONE;}canvas.drawCanvas(cache,0,0);}if(restoreTo >= 0){canvas.restoreToCount(restoreTo);}return more;}},{key:"draw",value:function draw(canvas){if(this.mClipBounds != null){canvas.clipRect(this.mClipBounds);}var privateFlags=this.mPrivateFlags;var dirtyOpaque=(privateFlags & View.PFLAG_DIRTY_MASK) == View.PFLAG_DIRTY_OPAQUE && (this.mAttachInfo == null || !this.mAttachInfo.mIgnoreDirtyState);this.mPrivateFlags = privateFlags & ~View.PFLAG_DIRTY_MASK | View.PFLAG_DRAWN;if(!dirtyOpaque){var background=this.mBackground;if(background != null){var _scrollX2=this.mScrollX;var _scrollY2=this.mScrollY;if(this.mBackgroundSizeChanged){background.setBounds(0,0,this.mRight - this.mLeft,this.mBottom - this.mTop);this.mBackgroundSizeChanged = false;}if((_scrollX2 | _scrollY2) == 0){background.draw(canvas);}else {canvas.translate(_scrollX2,_scrollY2);background.draw(canvas);canvas.translate(-_scrollX2,-_scrollY2);}}}if(!dirtyOpaque)this.onDraw(canvas);this.dispatchDraw(canvas);this.onDrawScrollBars(canvas);if(this.mOverlay != null && !this.mOverlay.isEmpty()){this.mOverlay.getOverlayView().dispatchDraw(canvas);}}},{key:"onDraw",value:function onDraw(canvas){}},{key:"dispatchDraw",value:function dispatchDraw(canvas){}},{key:"onDrawScrollBars",value:function onDrawScrollBars(canvas){var cache=this.mScrollCache;if(cache != null){var state=cache.state;if(state == ScrollabilityCache.OFF){return;}var invalidate=false;if(state == ScrollabilityCache.FADING){cache._computeAlphaToScrollBar();invalidate = true;}else {cache.scrollBar.setAlpha(255);}var viewFlags=this.mViewFlags;var drawHorizontalScrollBar=(viewFlags & View.SCROLLBARS_HORIZONTAL) == View.SCROLLBARS_HORIZONTAL;var drawVerticalScrollBar=(viewFlags & View.SCROLLBARS_VERTICAL) == View.SCROLLBARS_VERTICAL && !this.isVerticalScrollBarHidden();if(drawVerticalScrollBar || drawHorizontalScrollBar){var width=this.mRight - this.mLeft;var height=this.mBottom - this.mTop;var scrollBar=cache.scrollBar;var _scrollX3=this.mScrollX;var _scrollY3=this.mScrollY;var inside=true;var left=undefined;var _top8=undefined;var right=undefined;var bottom=undefined;if(drawHorizontalScrollBar){var size=scrollBar.getSize(false);if(size <= 0){size = cache.scrollBarSize;}scrollBar.setParameters(this.computeHorizontalScrollRange(),this.computeHorizontalScrollOffset(),this.computeHorizontalScrollExtent(),false);var verticalScrollBarGap=drawVerticalScrollBar?this.getVerticalScrollbarWidth():0;_top8 = _scrollY3 + height - size;left = _scrollX3 + this.mPaddingLeft;right = _scrollX3 + width - -verticalScrollBarGap;bottom = _top8 + size;this.onDrawHorizontalScrollBar(canvas,scrollBar,left,_top8,right,bottom);if(invalidate){this.invalidate(left,_top8,right,bottom);}}if(drawVerticalScrollBar){var size=scrollBar.getSize(true);if(size <= 0){size = cache.scrollBarSize;}scrollBar.setParameters(this.computeVerticalScrollRange(),this.computeVerticalScrollOffset(),this.computeVerticalScrollExtent(),true);left = _scrollX3 + width - size;_top8 = _scrollY3 + this.mPaddingTop;right = left + size;bottom = _scrollY3 + height;this.onDrawVerticalScrollBar(canvas,scrollBar,left,_top8,right,bottom);if(invalidate){this.invalidate(left,_top8,right,bottom);}}}}}},{key:"isVerticalScrollBarHidden",value:function isVerticalScrollBarHidden(){return false;}},{key:"onDrawHorizontalScrollBar",value:function onDrawHorizontalScrollBar(canvas,scrollBar,l,t,r,b){scrollBar.setBounds(l,t,r,b);scrollBar.draw(canvas);}},{key:"onDrawVerticalScrollBar",value:function onDrawVerticalScrollBar(canvas,scrollBar,l,t,r,b){scrollBar.setBounds(l,t,r,b);scrollBar.draw(canvas);}},{key:"destroyDrawingCache",value:function destroyDrawingCache(){}},{key:"setWillNotDraw",value:function setWillNotDraw(willNotDraw){this.setFlags(willNotDraw?View.WILL_NOT_DRAW:0,View.DRAW_MASK);}},{key:"willNotDraw",value:function willNotDraw(){return (this.mViewFlags & View.DRAW_MASK) == View.WILL_NOT_DRAW;}},{key:"setWillNotCacheDrawing",value:function setWillNotCacheDrawing(willNotCacheDrawing){this.setFlags(willNotCacheDrawing?View.WILL_NOT_CACHE_DRAWING:0,View.WILL_NOT_CACHE_DRAWING);}},{key:"willNotCacheDrawing",value:function willNotCacheDrawing(){return (this.mViewFlags & View.WILL_NOT_CACHE_DRAWING) == View.WILL_NOT_CACHE_DRAWING;}},{key:"jumpDrawablesToCurrentState",value:function jumpDrawablesToCurrentState(){if(this.mBackground != null){this.mBackground.jumpToCurrentState();}}},{key:"invalidateDrawable",value:function invalidateDrawable(drawable){if(this.verifyDrawable(drawable)){var dirty=drawable.getBounds();var _scrollX4=this.mScrollX;var _scrollY4=this.mScrollY;this.invalidate(dirty.left + _scrollX4,dirty.top + _scrollY4,dirty.right + _scrollX4,dirty.bottom + _scrollY4);}}},{key:"scheduleDrawable",value:function scheduleDrawable(who,what,when){if(this.verifyDrawable(who) && what != null){var delay=when - SystemClock.uptimeMillis();if(this.mAttachInfo != null){this.mAttachInfo.mHandler.postAtTime(what,who,when);}else {view_1.ViewRootImpl.getRunQueue().postDelayed(what,delay);}}}},{key:"unscheduleDrawable",value:function unscheduleDrawable(who,what){if(this.verifyDrawable(who) && what != null){if(this.mAttachInfo != null){this.mAttachInfo.mHandler.removeCallbacks(what,who);}else {view_1.ViewRootImpl.getRunQueue().removeCallbacks(what);}}else if(what === null){if(this.mAttachInfo != null && who != null){this.mAttachInfo.mHandler.removeCallbacksAndMessages(who);}}}},{key:"verifyDrawable",value:function verifyDrawable(who){return who == this.mBackground;}},{key:"drawableStateChanged",value:function drawableStateChanged(){var d=this.mBackground;if(d != null && d.isStateful()){d.setState(this.getDrawableState());}}},{key:"refreshDrawableState",value:function refreshDrawableState(){this.mPrivateFlags |= View.PFLAG_DRAWABLE_STATE_DIRTY;this.drawableStateChanged();var parent=this.mParent;if(parent != null){parent.childDrawableStateChanged(this);}}},{key:"getDrawableState",value:function getDrawableState(){return [];}},{key:"getAnimation",value:function getAnimation(){return null;}},{key:"computeHorizontalScrollRange",value:function computeHorizontalScrollRange(){return this.getWidth();}},{key:"computeHorizontalScrollOffset",value:function computeHorizontalScrollOffset(){return this.mScrollX;}},{key:"computeHorizontalScrollExtent",value:function computeHorizontalScrollExtent(){return this.getWidth();}},{key:"computeVerticalScrollRange",value:function computeVerticalScrollRange(){return this.getHeight();}},{key:"computeVerticalScrollOffset",value:function computeVerticalScrollOffset(){return this.mScrollY;}},{key:"computeVerticalScrollExtent",value:function computeVerticalScrollExtent(){return this.getHeight();}},{key:"canScrollHorizontally",value:function canScrollHorizontally(direction){var offset=this.computeHorizontalScrollOffset();var range=this.computeHorizontalScrollRange() - this.computeHorizontalScrollExtent();if(range == 0)return false;if(direction < 0){return offset > 0;}else {return offset < range - 1;}}},{key:"canScrollVertically",value:function canScrollVertically(direction){var offset=this.computeVerticalScrollOffset();var range=this.computeVerticalScrollRange() - this.computeVerticalScrollExtent();if(range == 0)return false;if(direction < 0){return offset > 0;}else {return offset < range - 1;}}},{key:"overScrollBy",value:function overScrollBy(deltaX,deltaY,scrollX,scrollY,scrollRangeX,scrollRangeY,maxOverScrollX,maxOverScrollY,isTouchEvent){var overScrollMode=this.mOverScrollMode;var canScrollHorizontal=this.computeHorizontalScrollRange() > this.computeHorizontalScrollExtent();var canScrollVertical=this.computeVerticalScrollRange() > this.computeVerticalScrollExtent();var overScrollHorizontal=overScrollMode == View.OVER_SCROLL_ALWAYS || overScrollMode == View.OVER_SCROLL_IF_CONTENT_SCROLLS && canScrollHorizontal;var overScrollVertical=overScrollMode == View.OVER_SCROLL_ALWAYS || overScrollMode == View.OVER_SCROLL_IF_CONTENT_SCROLLS && canScrollVertical;if(isTouchEvent){if(deltaX < 0 && scrollX <= 0 || deltaX > 0 && scrollX >= scrollRangeX){deltaX /= 2;}if(deltaY < 0 && scrollY <= 0 || deltaY > 0 && scrollY >= scrollRangeY){deltaY /= 2;}}var newScrollX=scrollX + deltaX;if(!overScrollHorizontal){maxOverScrollX = 0;}var newScrollY=scrollY + deltaY;if(!overScrollVertical){maxOverScrollY = 0;}var left=-maxOverScrollX;var right=maxOverScrollX + scrollRangeX;var top=-maxOverScrollY;var bottom=maxOverScrollY + scrollRangeY;var clampedX=false;if(newScrollX > right){newScrollX = right;clampedX = true;}else if(newScrollX < left){newScrollX = left;clampedX = true;}var clampedY=false;if(newScrollY > bottom){newScrollY = bottom;clampedY = true;}else if(newScrollY < top){newScrollY = top;clampedY = true;}this.onOverScrolled(newScrollX,newScrollY,clampedX,clampedY);return clampedX || clampedY;}},{key:"onOverScrolled",value:function onOverScrolled(scrollX,scrollY,clampedX,clampedY){}},{key:"getOverScrollMode",value:function getOverScrollMode(){return this.mOverScrollMode;}},{key:"setOverScrollMode",value:function setOverScrollMode(overScrollMode){if(overScrollMode != View.OVER_SCROLL_ALWAYS && overScrollMode != View.OVER_SCROLL_IF_CONTENT_SCROLLS && overScrollMode != View.OVER_SCROLL_NEVER){throw new Error("Invalid overscroll mode " + overScrollMode);}this.mOverScrollMode = overScrollMode;}},{key:"getVerticalScrollFactor",value:function getVerticalScrollFactor(){if(this.mVerticalScrollFactor == 0){this.mVerticalScrollFactor = Resources.getDisplayMetrics().density * 64;}return this.mVerticalScrollFactor;}},{key:"getHorizontalScrollFactor",value:function getHorizontalScrollFactor(){return this.getVerticalScrollFactor();}},{key:"computeScroll",value:function computeScroll(){}},{key:"scrollTo",value:function scrollTo(x,y){if(this.mScrollX != x || this.mScrollY != y){var oldX=this.mScrollX;var oldY=this.mScrollY;this.mScrollX = x;this.mScrollY = y;this.invalidateParentCaches();this.onScrollChanged(this.mScrollX,this.mScrollY,oldX,oldY);if(!this.awakenScrollBars()){this.postInvalidateOnAnimation();}}}},{key:"scrollBy",value:function scrollBy(x,y){this.scrollTo(this.mScrollX + x,this.mScrollY + y);}},{key:"initialAwakenScrollBars",value:function initialAwakenScrollBars(){return this.mScrollCache != null && this.awakenScrollBars(this.mScrollCache.scrollBarDefaultDelayBeforeFade * 4,true);}},{key:"awakenScrollBars",value:function awakenScrollBars(){var startDelay=arguments.length <= 0 || arguments[0] === undefined?this.mScrollCache.scrollBarDefaultDelayBeforeFade:arguments[0];var invalidate=arguments.length <= 1 || arguments[1] === undefined?true:arguments[1];var scrollCache=this.mScrollCache;if(scrollCache == null || !scrollCache.fadeScrollBars){return false;}if(scrollCache.scrollBar == null){scrollCache.scrollBar = new ScrollBarDrawable();}if(this.isHorizontalScrollBarEnabled() || this.isVerticalScrollBarEnabled()){if(invalidate){this.postInvalidateOnAnimation();}if(scrollCache.state == ScrollabilityCache.OFF){var KEY_REPEAT_FIRST_DELAY=750;startDelay = Math.max(KEY_REPEAT_FIRST_DELAY,startDelay);}var fadeStartTime=AnimationUtils.currentAnimationTimeMillis() + startDelay;scrollCache.fadeStartTime = fadeStartTime;scrollCache.state = ScrollabilityCache.ON;if(this.mAttachInfo != null){this.mAttachInfo.mHandler.removeCallbacks(scrollCache);this.mAttachInfo.mHandler.postAtTime(scrollCache,fadeStartTime);}return true;}return false;}},{key:"getVerticalFadingEdgeLength",value:function getVerticalFadingEdgeLength(){return 0;}},{key:"setFadingEdgeLength",value:function setFadingEdgeLength(length){}},{key:"getHorizontalFadingEdgeLength",value:function getHorizontalFadingEdgeLength(){return 0;}},{key:"getVerticalScrollbarWidth",value:function getVerticalScrollbarWidth(){var cache=this.mScrollCache;if(cache != null){var scrollBar=cache.scrollBar;if(scrollBar != null){var size=scrollBar.getSize(true);if(size <= 0){size = cache.scrollBarSize;}return size;}return 0;}return 0;}},{key:"getHorizontalScrollbarHeight",value:function getHorizontalScrollbarHeight(){var cache=this.mScrollCache;if(cache != null){var scrollBar=cache.scrollBar;if(scrollBar != null){var size=scrollBar.getSize(false);if(size <= 0){size = cache.scrollBarSize;}return size;}return 0;}return 0;}},{key:"initializeScrollbars",value:function initializeScrollbars(){this.initScrollCache();var scrollabilityCache=this.mScrollCache;if(scrollabilityCache.scrollBar == null){scrollabilityCache.scrollBar = new ScrollBarDrawable();}scrollabilityCache.fadeScrollBars = true;var track=null;scrollabilityCache.scrollBar.setHorizontalTrackDrawable(track);var thumb=new ColorDrawable(Color.parseColor('#aaaaaa'));var oldDraw=thumb.draw;var tempRect=new Rect();thumb.draw = function(canvas){var bounds=thumb.getBounds();tempRect.set(bounds);bounds.right = bounds.left + bounds.width() / 2;oldDraw.call(thumb,canvas);bounds.set(tempRect);};scrollabilityCache.scrollBar.setHorizontalThumbDrawable(thumb);scrollabilityCache.scrollBar.setVerticalTrackDrawable(track);scrollabilityCache.scrollBar.setVerticalThumbDrawable(thumb);}},{key:"initScrollCache",value:function initScrollCache(){if(this.mScrollCache == null){this.mScrollCache = new ScrollabilityCache(this);}}},{key:"getScrollCache",value:function getScrollCache(){this.initScrollCache();return this.mScrollCache;}},{key:"isHorizontalScrollBarEnabled",value:function isHorizontalScrollBarEnabled(){return (this.mViewFlags & View.SCROLLBARS_HORIZONTAL) == View.SCROLLBARS_HORIZONTAL;}},{key:"setHorizontalScrollBarEnabled",value:function setHorizontalScrollBarEnabled(horizontalScrollBarEnabled){if(this.isHorizontalScrollBarEnabled() != horizontalScrollBarEnabled){this.mViewFlags ^= View.SCROLLBARS_HORIZONTAL;this.computeOpaqueFlags();}}},{key:"isVerticalScrollBarEnabled",value:function isVerticalScrollBarEnabled(){return (this.mViewFlags & View.SCROLLBARS_VERTICAL) == View.SCROLLBARS_VERTICAL;}},{key:"setVerticalScrollBarEnabled",value:function setVerticalScrollBarEnabled(verticalScrollBarEnabled){if(this.isVerticalScrollBarEnabled() != verticalScrollBarEnabled){this.mViewFlags ^= View.SCROLLBARS_VERTICAL;this.computeOpaqueFlags();}}},{key:"setScrollbarFadingEnabled",value:function setScrollbarFadingEnabled(fadeScrollbars){this.initScrollCache();var scrollabilityCache=this.mScrollCache;scrollabilityCache.fadeScrollBars = fadeScrollbars;if(fadeScrollbars){scrollabilityCache.state = ScrollabilityCache.OFF;}else {scrollabilityCache.state = ScrollabilityCache.ON;}}},{key:"isScrollbarFadingEnabled",value:function isScrollbarFadingEnabled(){return this.mScrollCache != null && this.mScrollCache.fadeScrollBars;}},{key:"getScrollBarDefaultDelayBeforeFade",value:function getScrollBarDefaultDelayBeforeFade(){return this.mScrollCache == null?view_1.ViewConfiguration.getScrollDefaultDelay():this.mScrollCache.scrollBarDefaultDelayBeforeFade;}},{key:"setScrollBarDefaultDelayBeforeFade",value:function setScrollBarDefaultDelayBeforeFade(scrollBarDefaultDelayBeforeFade){this.getScrollCache().scrollBarDefaultDelayBeforeFade = scrollBarDefaultDelayBeforeFade;}},{key:"getScrollBarFadeDuration",value:function getScrollBarFadeDuration(){return this.mScrollCache == null?view_1.ViewConfiguration.getScrollBarFadeDuration():this.mScrollCache.scrollBarFadeDuration;}},{key:"setScrollBarFadeDuration",value:function setScrollBarFadeDuration(scrollBarFadeDuration){this.getScrollCache().scrollBarFadeDuration = scrollBarFadeDuration;}},{key:"getScrollBarSize",value:function getScrollBarSize(){return this.mScrollCache == null?view_1.ViewConfiguration.get().getScaledScrollBarSize():this.mScrollCache.scrollBarSize;}},{key:"setScrollBarSize",value:function setScrollBarSize(scrollBarSize){this.getScrollCache().scrollBarSize = scrollBarSize;}},{key:"assignParent",value:function assignParent(parent){if(this.mParent == null){this.mParent = parent;}else if(parent == null){this.mParent = null;}else {throw new Error("view " + this + " being added, but" + " it already has a parent");}}},{key:"onFinishInflate",value:function onFinishInflate(){}},{key:"dispatchAttachedToWindow",value:function dispatchAttachedToWindow(info,visibility){this.mAttachInfo = info;if(this.mOverlay != null){this.mOverlay.getOverlayView().dispatchAttachedToWindow(info,visibility);}this.mWindowAttachCount++;this.mPrivateFlags |= View.PFLAG_DRAWABLE_STATE_DIRTY;if((this.mPrivateFlags & View.PFLAG_SCROLL_CONTAINER) != 0){this.mAttachInfo.mScrollContainers.add(this);this.mPrivateFlags |= View.PFLAG_SCROLL_CONTAINER_ADDED;}this.onAttachedToWindow();var li=this.mListenerInfo;var listeners=li != null?li.mOnAttachStateChangeListeners:null;if(listeners != null && listeners.size() > 0){var _iteratorNormalCompletion6=true;var _didIteratorError6=false;var _iteratorError6=undefined;try{for(var _iterator6=listeners[Symbol.iterator](),_step6;!(_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done);_iteratorNormalCompletion6 = true) {var listener=_step6.value;listener.onViewAttachedToWindow(this);}}catch(err) {_didIteratorError6 = true;_iteratorError6 = err;}finally {try{if(!_iteratorNormalCompletion6 && _iterator6["return"]){_iterator6["return"]();}}finally {if(_didIteratorError6){throw _iteratorError6;}}}}if((this.mPrivateFlags & View.PFLAG_DRAWABLE_STATE_DIRTY) != 0){this.refreshDrawableState();}}},{key:"onAttachedToWindow",value:function onAttachedToWindow(){ //if ((this.mPrivateFlags & View.PFLAG_REQUEST_TRANSPARENT_REGIONS) != 0) {
//    this.mParent.requestTransparentRegion(this);
//}
if((this.mPrivateFlags & View.PFLAG_AWAKEN_SCROLL_BARS_ON_ATTACH) != 0){this.initialAwakenScrollBars();this.mPrivateFlags &= ~View.PFLAG_AWAKEN_SCROLL_BARS_ON_ATTACH;}this.mPrivateFlags3 &= ~View.PFLAG3_IS_LAID_OUT;this.jumpDrawablesToCurrentState();}},{key:"dispatchDetachedFromWindow",value:function dispatchDetachedFromWindow(){this.onDetachedFromWindow();var li=this.mListenerInfo;var listeners=li != null?li.mOnAttachStateChangeListeners:null;if(listeners != null && listeners.size() > 0){var _iteratorNormalCompletion7=true;var _didIteratorError7=false;var _iteratorError7=undefined;try{for(var _iterator7=listeners[Symbol.iterator](),_step7;!(_iteratorNormalCompletion7 = (_step7 = _iterator7.next()).done);_iteratorNormalCompletion7 = true) {var listener=_step7.value;listener.onViewDetachedFromWindow(this);}}catch(err) {_didIteratorError7 = true;_iteratorError7 = err;}finally {try{if(!_iteratorNormalCompletion7 && _iterator7["return"]){_iterator7["return"]();}}finally {if(_didIteratorError7){throw _iteratorError7;}}}}if((this.mPrivateFlags & View.PFLAG_SCROLL_CONTAINER_ADDED) != 0){this.mAttachInfo.mScrollContainers["delete"](this);this.mPrivateFlags &= ~View.PFLAG_SCROLL_CONTAINER_ADDED;}this.mAttachInfo = null;if(this.mOverlay != null){this.mOverlay.getOverlayView().dispatchDetachedFromWindow();}}},{key:"onDetachedFromWindow",value:function onDetachedFromWindow(){this.mPrivateFlags &= ~View.PFLAG_CANCEL_NEXT_UP_EVENT;this.mPrivateFlags3 &= ~View.PFLAG3_IS_LAID_OUT;this.removeUnsetPressCallback();this.removeLongPressCallback();this.removePerformClickCallback();this.destroyDrawingCache();this.cleanupDraw();}},{key:"cleanupDraw",value:function cleanupDraw(){if(this.mAttachInfo != null){this.mAttachInfo.mViewRootImpl.cancelInvalidate(this);}}},{key:"debug",value:function debug(){var depth=arguments.length <= 0 || arguments[0] === undefined?0:arguments[0];var originProto=Object.getPrototypeOf(this);console.dir(Object.assign(Object.create(originProto),this));}},{key:"toString",value:function toString(){return this.tagName();}},{key:"getRootView",value:function getRootView(){if(this.mAttachInfo != null){var v=this.mAttachInfo.mRootView;if(v != null){return v;}}var parent=this;while(parent.mParent != null && parent.mParent instanceof View) {parent = parent.mParent;}return parent;}},{key:"findViewById",value:function findViewById(id){var bindEle=this.bindElement.querySelector('#' + id);return bindEle?bindEle['bindView']:null;}},{key:"initBindElement",value:function initBindElement(bindElement,rootElement){this._bindElement = bindElement || document.createElement(this.tagName());var oldBindView=this._bindElement['bindView'];if(oldBindView){this._bindElement.removeEventListener("DOMAttrModified",oldBindView._DOMAttrModifiedEvent,true);}this._bindElement['bindView'] = this;this._parseRefStyle(rootElement);this._initAttrChangeHandler();this._bindElement.addEventListener("DOMAttrModified",this._DOMAttrModifiedEvent,true);this._fireInitBindElementAttribute(rootElement);}},{key:"syncBoundToElement",value:function syncBoundToElement(){var bind=this.bindElement;bind.style.position = 'absolute';bind.style.boxSizing = 'border-box';bind.style.left = this.mLeft + 'px';bind.style.top = this.mTop + 'px';bind.style.width = this.getWidth() + 'px';bind.style.height = this.getHeight() + 'px';}},{key:"syncScrollToElement",value:function syncScrollToElement(){var sx=this.mScrollX;var sy=this.mScrollY;Array.from(this.bindElement.children).forEach(function(item){if(item.tagName === 'scrollbar')return;if(sx !== 0)item.style.marginLeft = -sx + 'px';else item.style.marginLeft = "";if(sy !== 0)item.style.marginTop = -sy + 'px';else item.style.marginTop = "";});}},{key:"_parseRefStyle",value:function _parseRefStyle(rootElement){var _this6=this;var style=this._bindElement.getAttribute('style');if(style && style.startsWith('@style/')){var ref=style.substring('@style/'.length);var styleElement=rootElement?rootElement.querySelector('#' + ref):null;if(!styleElement)styleElement = document.getElementById(ref);if(styleElement){Array.from(styleElement.attributes).forEach(function(attr){if(attr.name !== 'id' && !_this6._bindElement.hasAttribute(attr.name)){_this6._bindElement.setAttribute(attr.name,attr.value);}});}}}},{key:"_initAttrChangeHandler",value:function _initAttrChangeHandler(){this.createAttrChangeHandler(this._attrChangeHandler);if(!this._attrChangeHandler.isCallSuper){throw Error('must call super when override createAttrChangeHandler!');}}},{key:"_fireInitBindElementAttribute",value:function _fireInitBindElementAttribute(rootElement){var _this7=this;Array.from(this.bindElement.attributes).forEach(function(attr){if(attr.name === "android:id" && !_this7.bindElement.id)_this7.bindElement.id = attr.value;_this7.onBindElementAttributeChanged(attr.name,attr.value,attr.value,rootElement);});}},{key:"onBindElementAttributeChanged",value:function onBindElementAttributeChanged(attributeName,oldVal,newVal,rootElement){var parts=attributeName.split(":");var attrName=parts[parts.length - 1].toLowerCase();if(newVal === 'true')newVal = true;else if(newVal === 'false')newVal = false;if(attrName.startsWith('layout_')){attrName = attrName.substring('layout_'.length);var params=this.getLayoutParams();if(params){if(rootElement)params._attrChangeHandler.rootElement = rootElement;params._attrChangeHandler.handle(attrName,newVal);}}else {if(rootElement)this._attrChangeHandler.rootElement = rootElement;this._attrChangeHandler.handle(attrName,newVal);}}},{key:"tagName",value:function tagName(){return "ANDROID-" + this.constructor.name;}},{key:"bindElement",get:function get(){if(!this._bindElement)this.initBindElement();return this._bindElement;}}],[{key:"combineMeasuredStates",value:function combineMeasuredStates(curState,newState){return curState | newState;}},{key:"resolveSize",value:function resolveSize(size,measureSpec){return View.resolveSizeAndState(size,measureSpec,0) & View.MEASURED_SIZE_MASK;}},{key:"resolveSizeAndState",value:function resolveSizeAndState(size,measureSpec,childMeasuredState){var MeasureSpec=View.MeasureSpec;var result=size;var specMode=MeasureSpec.getMode(measureSpec);var specSize=MeasureSpec.getSize(measureSpec);switch(specMode){case MeasureSpec.UNSPECIFIED:result = size;break;case MeasureSpec.AT_MOST:if(specSize < size){result = specSize | View.MEASURED_STATE_TOO_SMALL;}else {result = size;}break;case MeasureSpec.EXACTLY:result = specSize;break;}return result | childMeasuredState & View.MEASURED_STATE_MASK;}},{key:"getDefaultSize",value:function getDefaultSize(size,measureSpec){var MeasureSpec=View.MeasureSpec;var result=size;var specMode=MeasureSpec.getMode(measureSpec);var specSize=MeasureSpec.getSize(measureSpec);switch(specMode){case MeasureSpec.UNSPECIFIED:result = size;break;case MeasureSpec.AT_MOST:case MeasureSpec.EXACTLY:result = specSize;break;}return result;}},{key:"inflate",value:function inflate(domtree){var rootElement=arguments.length <= 1 || arguments[1] === undefined?domtree:arguments[1];return (function(){var _this8=this;var className=domtree.tagName;if(className.startsWith('ANDROID-')){className = className.substring('ANDROID-'.length);}var rootViewClass=undefined;for(var key in android['view']) {if(key.toUpperCase() == className.toUpperCase()){rootViewClass = android.view[key];break;}}if(!rootViewClass){for(var key in android['widget']) {if(key.toUpperCase() == className.toUpperCase()){rootViewClass = android['widget'][key];break;}}}if(!rootViewClass){try{rootViewClass = window.eval(className);}catch(e) {}}if(!rootViewClass){var _ret=(function(){var rootView=undefined;Array.from(domtree.children).forEach(function(item){if(!rootView && item instanceof HTMLElement){rootView = View.inflate(item,domtree);}});return {v:rootView};})();if(typeof _ret === "object")return _ret.v;}var rootView=new rootViewClass();rootView.initBindElement(domtree,rootElement);if(rootView instanceof view_1.ViewGroup){Array.from(domtree.children).forEach(function(item){if(item instanceof HTMLElement){var _view=View.inflate(item,rootElement);var _params=rootView.generateDefaultLayoutParams();_this8._generateLayoutParamsFromAttribute(item,_params);if(_view)rootView.addView(_view,_params);}});}var params=this._generateLayoutParamsFromAttribute(domtree);rootView.setLayoutParams(params);rootView.onFinishInflate();return rootView;}).apply(this,arguments);}},{key:"_generateLayoutParamsFromAttribute",value:function _generateLayoutParamsFromAttribute(node){var dest=arguments.length <= 1 || arguments[1] === undefined?new view_1.ViewGroup.LayoutParams(-2,-2):arguments[1];Array.from(node.attributes).forEach(function(attr){var layoutParamFiled=attr.name.split("layout_")[1];if(layoutParamFiled !== undefined && dest[layoutParamFiled] !== undefined){dest[layoutParamFiled] = attr.value;}});return dest;}}]);return View;})();View.DBG = Log.View_DBG;View.VIEW_LOG_TAG = "View";View.PFLAG_WANTS_FOCUS = 0x00000001;View.PFLAG_FOCUSED = 0x00000002;View.PFLAG_SELECTED = 0x00000004;View.PFLAG_IS_ROOT_NAMESPACE = 0x00000008;View.PFLAG_HAS_BOUNDS = 0x00000010;View.PFLAG_DRAWN = 0x00000020;View.PFLAG_DRAW_ANIMATION = 0x00000040;View.PFLAG_SKIP_DRAW = 0x00000080;View.PFLAG_ONLY_DRAWS_BACKGROUND = 0x00000100;View.PFLAG_REQUEST_TRANSPARENT_REGIONS = 0x00000200;View.PFLAG_DRAWABLE_STATE_DIRTY = 0x00000400;View.PFLAG_MEASURED_DIMENSION_SET = 0x00000800;View.PFLAG_FORCE_LAYOUT = 0x00001000;View.PFLAG_LAYOUT_REQUIRED = 0x00002000;View.PFLAG_PRESSED = 0x00004000;View.PFLAG_DRAWING_CACHE_VALID = 0x00008000;View.PFLAG_ANIMATION_STARTED = 0x00010000;View.PFLAG_ALPHA_SET = 0x00040000;View.PFLAG_SCROLL_CONTAINER = 0x00080000;View.PFLAG_SCROLL_CONTAINER_ADDED = 0x00100000;View.PFLAG_DIRTY = 0x00200000;View.PFLAG_DIRTY_OPAQUE = 0x00400000;View.PFLAG_DIRTY_MASK = 0x00600000;View.PFLAG_OPAQUE_BACKGROUND = 0x00800000;View.PFLAG_OPAQUE_SCROLLBARS = 0x01000000;View.PFLAG_OPAQUE_MASK = 0x01800000;View.PFLAG_PREPRESSED = 0x02000000;View.PFLAG_CANCEL_NEXT_UP_EVENT = 0x04000000;View.PFLAG_AWAKEN_SCROLL_BARS_ON_ATTACH = 0x08000000;View.PFLAG_HOVERED = 0x10000000;View.PFLAG_PIVOT_EXPLICITLY_SET = 0x20000000;View.PFLAG_ACTIVATED = 0x40000000;View.PFLAG_INVALIDATED = 0x80000000;View.PFLAG2_VIEW_QUICK_REJECTED = 0x10000000;View.PFLAG3_VIEW_IS_ANIMATING_TRANSFORM = 0x1;View.PFLAG3_VIEW_IS_ANIMATING_ALPHA = 0x2;View.PFLAG3_IS_LAID_OUT = 0x4;View.PFLAG3_MEASURE_NEEDED_BEFORE_LAYOUT = 0x8;View.PFLAG3_CALLED_SUPER = 0x10;View.NOT_FOCUSABLE = 0x00000000;View.FOCUSABLE = 0x00000001;View.FOCUSABLE_MASK = 0x00000001;View.OVER_SCROLL_ALWAYS = 0;View.OVER_SCROLL_IF_CONTENT_SCROLLS = 1;View.OVER_SCROLL_NEVER = 2;View.MEASURED_SIZE_MASK = 0x00ffffff;View.MEASURED_STATE_MASK = 0xff000000;View.MEASURED_HEIGHT_STATE_SHIFT = 16;View.MEASURED_STATE_TOO_SMALL = 0x01000000;View.VISIBILITY_MASK = 0x0000000C;View.VISIBLE = 0x00000000;View.INVISIBLE = 0x00000004;View.GONE = 0x00000008;View.ENABLED = 0x00000000;View.DISABLED = 0x00000020;View.ENABLED_MASK = 0x00000020;View.WILL_NOT_DRAW = 0x00000080;View.DRAW_MASK = 0x00000080;View.SCROLLBARS_NONE = 0x00000000;View.SCROLLBARS_HORIZONTAL = 0x00000100;View.SCROLLBARS_VERTICAL = 0x00000200;View.SCROLLBARS_MASK = 0x00000300;View.FOCUSABLES_ALL = 0x00000000;View.FOCUSABLES_TOUCH_MODE = 0x00000001;View.FOCUS_BACKWARD = 0x00000001;View.FOCUS_FORWARD = 0x00000002;View.FOCUS_LEFT = 0x00000011;View.FOCUS_UP = 0x00000021;View.FOCUS_RIGHT = 0x00000042;View.FOCUS_DOWN = 0x00000082;View.CLICKABLE = 0x00004000;View.DRAWING_CACHE_ENABLED = 0x00008000;View.WILL_NOT_CACHE_DRAWING = 0x000020000;View.FOCUSABLE_IN_TOUCH_MODE = 0x00040000;View.LONG_CLICKABLE = 0x00200000;View.DUPLICATE_PARENT_STATE = 0x00400000;View.LAYER_TYPE_NONE = 0;View.LAYER_TYPE_SOFTWARE = 1;view_1.View = View;(function(View){var MeasureSpec=(function(){function MeasureSpec(){_classCallCheck(this,MeasureSpec);}_createClass(MeasureSpec,null,[{key:"makeMeasureSpec",value:function makeMeasureSpec(size,mode){return size & ~MeasureSpec.MODE_MASK | mode & MeasureSpec.MODE_MASK;}},{key:"getMode",value:function getMode(measureSpec){return measureSpec & MeasureSpec.MODE_MASK;}},{key:"getSize",value:function getSize(measureSpec){return measureSpec & ~MeasureSpec.MODE_MASK;}},{key:"adjust",value:function adjust(measureSpec,delta){return MeasureSpec.makeMeasureSpec(MeasureSpec.getSize(measureSpec + delta),MeasureSpec.getMode(measureSpec));}},{key:"toString",value:function toString(measureSpec){var mode=MeasureSpec.getMode(measureSpec);var size=MeasureSpec.getSize(measureSpec);var sb=new StringBuilder("MeasureSpec: ");if(mode == MeasureSpec.UNSPECIFIED)sb.append("UNSPECIFIED ");else if(mode == MeasureSpec.EXACTLY)sb.append("EXACTLY ");else if(mode == MeasureSpec.AT_MOST)sb.append("AT_MOST ");else sb.append(mode).append(" ");sb.append(size);return sb.toString();}}]);return MeasureSpec;})();MeasureSpec.MODE_SHIFT = 30;MeasureSpec.MODE_MASK = 0x3 << MeasureSpec.MODE_SHIFT;MeasureSpec.UNSPECIFIED = 0 << MeasureSpec.MODE_SHIFT;MeasureSpec.EXACTLY = 1 << MeasureSpec.MODE_SHIFT;MeasureSpec.AT_MOST = 2 << MeasureSpec.MODE_SHIFT;View.MeasureSpec = MeasureSpec;var AttachInfo=function AttachInfo(mViewRootImpl,mHandler){_classCallCheck(this,AttachInfo);this.mDrawingTime = 0;this.mTmpInvalRect = new Rect();this.mTmpTransformRect = new Rect();this.mScrollContainers = new Set();this.mViewScrollChanged = false;this.mTreeObserver = new view_1.ViewTreeObserver();this.mViewVisibilityChanged = false;this.mInvalidateChildLocation = new Array(2);this.mIgnoreDirtyState = false;this.mSetIgnoreDirtyState = false;this.mViewRootImpl = mViewRootImpl;this.mHandler = mHandler;};View.AttachInfo = AttachInfo;var ListenerInfo=function ListenerInfo(){_classCallCheck(this,ListenerInfo);};View.ListenerInfo = ListenerInfo;var AttrChangeHandler=(function(){function AttrChangeHandler(){_classCallCheck(this,AttrChangeHandler);this.isCallSuper = false;this.handlers = [];}_createClass(AttrChangeHandler,[{key:"add",value:function add(handler){this.handlers.push(handler);}},{key:"handle",value:function handle(name,value){this.handlers.forEach(function(handler){for(var key in handler) {if(key.toLowerCase() === name){handler[key] = value;}}});}},{key:"parseBoolean",value:function parseBoolean(value){var defaultValue=arguments.length <= 1 || arguments[1] === undefined?true:arguments[1];return AttrChangeHandler.parseBoolean(value,defaultValue);}},{key:"parseGravity",value:function parseGravity(s){var defaultValue=arguments.length <= 1 || arguments[1] === undefined?view_1.Gravity.NO_GRAVITY:arguments[1];return AttrChangeHandler.parseGravity(s,defaultValue);}},{key:"parseDrawable",value:function parseDrawable(s){if(s.startsWith('@')){}else {var color=this.parseColor(s);return new ColorDrawable(color);}}},{key:"parseColor",value:function parseColor(value){if(value.startsWith('rgb(')){value = value.replace('rgb(','').replace(')','');var parts=value.split(',');return Color.rgb(Number.parseInt(parts[0]),Number.parseInt(parts[1]),Number.parseInt(parts[2]));}else if(value.startsWith('rgba(')){value = value.replace('rgba(','').replace(')','');var parts=value.split(',');return Color.rgba(Number.parseInt(parts[0]),Number.parseInt(parts[1]),Number.parseInt(parts[2]),Number.parseInt(parts[2]));}else {if(value.startsWith('#') && value.length === 4){value = '#' + value[1] + value[1] + value[2] + value[2] + value[2] + value[2];}try{return Color.parseColor(value);}catch(e) {}}}},{key:"parseColorList",value:function parseColorList(value){if(value.startsWith('@')){}else {var color=this.parseColor(value);return ColorStateList.valueOf(color);}return null;}}],[{key:"parseBoolean",value:function parseBoolean(value){var defaultValue=arguments.length <= 1 || arguments[1] === undefined?true:arguments[1];if(value === false || value === 'fales' || value === '0')return false;else if(value === true || value === 'true' || value === '1' || value === '')return true;return defaultValue;}},{key:"parseGravity",value:function parseGravity(s){var defaultValue=arguments.length <= 1 || arguments[1] === undefined?view_1.Gravity.NO_GRAVITY:arguments[1];var gravity=view_1.Gravity.NO_GRAVITY;try{var parts=s.split("|");parts.forEach(function(part){var g=view_1.Gravity[part.toUpperCase()];if(Number.isInteger(g))gravity |= g;});}catch(e) {console.error(e);}if(Number.isNaN(gravity) || gravity === view_1.Gravity.NO_GRAVITY)gravity = defaultValue;return gravity;}}]);return AttrChangeHandler;})();View.AttrChangeHandler = AttrChangeHandler;})(View = view_1.View || (view_1.View = {}));(function(View){var AttachInfo;(function(AttachInfo){var InvalidateInfo=(function(){function InvalidateInfo(){_classCallCheck(this,InvalidateInfo);this.left = 0;this.top = 0;this.right = 0;this.bottom = 0;}_createClass(InvalidateInfo,[{key:"recycle",value:function recycle(){this.target = null;InvalidateInfo.sPool.release(this);}}],[{key:"obtain",value:function obtain(){var instance=InvalidateInfo.sPool.acquire();return instance != null?instance:new InvalidateInfo();}}]);return InvalidateInfo;})();InvalidateInfo.POOL_LIMIT = 10;InvalidateInfo.sPool = new Pools.SynchronizedPool(InvalidateInfo.POOL_LIMIT);AttachInfo.InvalidateInfo = InvalidateInfo;})(AttachInfo = View.AttachInfo || (View.AttachInfo = {}));})(View = view_1.View || (view_1.View = {}));var CheckForLongPress=(function(){function CheckForLongPress(View_this){_classCallCheck(this,CheckForLongPress);this.mOriginalWindowAttachCount = 0;this.View_this = View_this;}_createClass(CheckForLongPress,[{key:"run",value:function run(){if(this.View_this.isPressed() && this.View_this.mParent != null && this.mOriginalWindowAttachCount == this.View_this.mWindowAttachCount){if(this.View_this.performLongClick()){this.View_this.mHasPerformedLongPress = true;}}}},{key:"rememberWindowAttachCount",value:function rememberWindowAttachCount(){this.mOriginalWindowAttachCount = this.View_this.mWindowAttachCount;}}]);return CheckForLongPress;})();var CheckForTap=(function(){function CheckForTap(View_this){_classCallCheck(this,CheckForTap);this.View_this = View_this;}_createClass(CheckForTap,[{key:"run",value:function run(){this.View_this.mPrivateFlags &= ~View.PFLAG_PREPRESSED;this.View_this.setPressed(true);this.View_this.checkForLongClick(view_1.ViewConfiguration.getTapTimeout());}}]);return CheckForTap;})();var PerformClick=(function(){function PerformClick(View_this){_classCallCheck(this,PerformClick);this.View_this = View_this;}_createClass(PerformClick,[{key:"run",value:function run(){this.View_this.performClick();}}]);return PerformClick;})();var UnsetPressedState=(function(){function UnsetPressedState(View_this){_classCallCheck(this,UnsetPressedState);this.View_this = View_this;}_createClass(UnsetPressedState,[{key:"run",value:function run(){this.View_this.setPressed(false);}}]);return UnsetPressedState;})();var ScrollabilityCache=(function(){function ScrollabilityCache(host){_classCallCheck(this,ScrollabilityCache);this.fadeScrollBars = true;this.fadingEdgeLength = view_1.ViewConfiguration.get().getScaledFadingEdgeLength();this.scrollBarDefaultDelayBeforeFade = view_1.ViewConfiguration.getScrollDefaultDelay();this.scrollBarFadeDuration = view_1.ViewConfiguration.getScrollBarFadeDuration();this.scrollBarSize = view_1.ViewConfiguration.get().getScaledScrollBarSize();this.interpolator = new LinearInterpolator();this.state = ScrollabilityCache.OFF;this.host = host;}_createClass(ScrollabilityCache,[{key:"run",value:function run(){var now=AnimationUtils.currentAnimationTimeMillis();if(now >= this.fadeStartTime){this.state = ScrollabilityCache.FADING;this.host.invalidate(true);}}},{key:"_computeAlphaToScrollBar",value:function _computeAlphaToScrollBar(){var now=AnimationUtils.currentAnimationTimeMillis();var factor=(now - this.fadeStartTime) / this.scrollBarFadeDuration;if(factor >= 1){this.state = ScrollabilityCache.OFF;factor = 1;}var alpha=1 - this.interpolator.getInterpolation(factor);this.scrollBar.setAlpha(255 * alpha);}}]);return ScrollabilityCache;})();ScrollabilityCache.OFF = 0;ScrollabilityCache.ON = 1;ScrollabilityCache.FADING = 2;})(view = android.view || (android.view = {}));})(android || (android = {}));var android;(function(android){var graphics;(function(graphics){var Point=(function(){function Point(){_classCallCheck(this,Point);this.x = 0;this.y = 0;for(var _len20=arguments.length,args=Array(_len20),_key20=0;_key20 < _len20;_key20++) {args[_key20] = arguments[_key20];}if(args.length === 1){var src=args[0];this.x = src.x;this.y = src.y;}else {var _args$013=args[0];var x=_args$013 === undefined?0:_args$013;var _args$113=args[1];var y=_args$113 === undefined?0:_args$113;this.x = x;this.y = y;}}_createClass(Point,[{key:"set",value:function set(x,y){this.x = x;this.y = y;}},{key:"negate",value:function negate(){this.x = -this.x;this.y = -this.y;}},{key:"offset",value:function offset(dx,dy){this.x += dx;this.y += dy;}},{key:"equals",value:function equals(){for(var _len21=arguments.length,args=Array(_len21),_key21=0;_key21 < _len21;_key21++) {args[_key21] = arguments[_key21];}if(args.length === 2){var _args$014=args[0];var x=_args$014 === undefined?0:_args$014;var _args$114=args[1];var y=_args$114 === undefined?0:_args$114;return this.x == x && this.y == y;}else {var o=args[0];if(this === o)return true;if(!o || !(o instanceof Point))return false;var point=o;if(this.x != point.x)return false;if(this.y != point.y)return false;return true;}}},{key:"toString",value:function toString(){return "Point(" + this.x + ", " + this.y + ")";}}]);return Point;})();graphics.Point = Point;})(graphics = android.graphics || (android.graphics = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/10/5.
 */ ///<reference path="View.ts"/>
///<reference path="../graphics/Point.ts"/>
///<reference path="../graphics/Rect.ts"/>
/**
 * Created by linfaxin on 15/10/13.
 */ ///<reference path="../graphics/Rect.ts"/>
///<reference path="../graphics/Canvas.ts"/>
///<reference path="../graphics/Canvas.ts"/>
var android;(function(android){var view;(function(view){var Rect=android.graphics.Rect;var Canvas=android.graphics.Canvas;var Surface=(function(){function Surface(canvasElement){_classCallCheck(this,Surface);this.mLockedCanvasMap = new WeakMap();this.mCanvasElement = canvasElement;}_createClass(Surface,[{key:"lockCanvas",value:function lockCanvas(dirty){var fullWidth=this.mCanvasElement.width;var fullHeight=this.mCanvasElement.height;var rect=undefined;if(dirty.isEmpty()){rect = new Rect(0,0,fullWidth,fullHeight);}else {rect = new Rect(Math.floor(dirty.left - 1),Math.floor(dirty.top - 1),Math.ceil(dirty.right + 1),Math.ceil(dirty.bottom + 1));}var width=rect.width();var height=rect.height();var canvas=new Canvas(width,height);canvas.translate(-rect.left,-rect.top);this.mLockedCanvasMap.set(canvas,rect);var mCanvasContent=this.mCanvasElement.getContext('2d');mCanvasContent.clearRect(rect.left,rect.top,width,height);return canvas;}},{key:"unlockCanvasAndPost",value:function unlockCanvasAndPost(canvas){var rect=this.mLockedCanvasMap.get(canvas);if(rect){var mCanvasContent=this.mCanvasElement.getContext('2d');mCanvasContent.drawImage(canvas.canvasElement,rect.left,rect.top);}}}]);return Surface;})();view.Surface = Surface;})(view = android.view || (android.view = {}));})(android || (android = {})); ///<reference path="ViewParent.ts"/>
///<reference path="View.ts"/>
///<reference path="Surface.ts"/>
///<reference path="../util/Log.ts"/>
///<reference path="../util/Log.ts"/>
///<reference path="../os/Handler.ts"/>
///<reference path="../os/Message.ts"/>
///<reference path="../os/SystemClock.ts"/>
///<reference path="../content/res/Resources.ts"/>
///<reference path="../graphics/Point.ts"/>
///<reference path="../graphics/Rect.ts"/>
///<reference path="../graphics/Canvas.ts"/>
///<reference path="../../java/lang/Runnable.ts"/>
///<reference path="../../java/lang/System.ts"/>
var android;(function(android){var view;(function(view_2){var View=android.view.View;var Resources=android.content.res.Resources;var Rect=android.graphics.Rect;var Handler=android.os.Handler;var SystemClock=android.os.SystemClock;var System=java.lang.System;var Log=android.util.Log;var Surface=android.view.Surface;var ViewRootImpl=(function(){function ViewRootImpl(){_classCallCheck(this,ViewRootImpl);this.mViewVisibility = 0;this.mWidth = -1;this.mHeight = -1;this.mDirty = new Rect();this.mTempRect = new Rect();this.mVisRect = new Rect();this.mTraversalScheduled = false;this.mWillDrawSoon = false;this.mIsInTraversal = false;this.mLayoutRequested = false;this.mFirst = true;this.mFullRedrawNeeded = false;this.mIsDrawing = false;this.mAdded = false;this.mWinFrame = new Rect();this.mLayoutRequesters = [];this.mHandler = new ViewRootHandler();this.mFpsStartTime = -1;this.mFpsPrevTime = -1;this.mFpsNumFrames = 0;this.mInvalidateOnAnimationRunnable = new InvalidateOnAnimationRunnable(this.mHandler);this.mAttachInfo = new View.AttachInfo(this,this.mHandler);this.mTraversalRunnable = new TraversalRunnable(this);}_createClass(ViewRootImpl,[{key:"initSurface",value:function initSurface(canvasElement){this.mSurface = new Surface(canvasElement);}},{key:"setView",value:function setView(view){if(this.mView == null){this.mView = view;this.mAttachInfo.mRootView = view;this.mAdded = true;this.requestLayout();view.assignParent(this);}}},{key:"getView",value:function getView(){return this.mView;}},{key:"getHostVisibility",value:function getHostVisibility(){return this.mView.getVisibility();}},{key:"scheduleTraversals",value:function scheduleTraversals(){if(!this.mTraversalScheduled){this.mTraversalScheduled = true;this.mHandler.post(this.mTraversalRunnable);}}},{key:"unscheduleTraversals",value:function unscheduleTraversals(){if(this.mTraversalScheduled){this.mTraversalScheduled = false;this.mHandler.removeCallbacks(this.mTraversalRunnable);}}},{key:"doTraversal",value:function doTraversal(){if(this.mTraversalScheduled){this.mTraversalScheduled = false;this.performTraversals();}}},{key:"measureHierarchy",value:function measureHierarchy(host,lp,desiredWindowWidth,desiredWindowHeight){var windowSizeMayChange=false;if(ViewRootImpl.DEBUG_ORIENTATION || ViewRootImpl.DEBUG_LAYOUT)Log.v(ViewRootImpl.TAG,"Measuring " + host + " in display " + desiredWindowWidth + "x" + desiredWindowHeight + "...");var childWidthMeasureSpec=ViewRootImpl.getRootMeasureSpec(desiredWindowWidth,lp.width);var childHeightMeasureSpec=ViewRootImpl.getRootMeasureSpec(desiredWindowHeight,lp.height);this.performMeasure(childWidthMeasureSpec,childHeightMeasureSpec);if(this.mWidth != host.getMeasuredWidth() || this.mHeight != host.getMeasuredHeight()){windowSizeMayChange = true;}if(ViewRootImpl.DBG){System.out.println("======================================");System.out.println("performTraversals -- after measure");host.debug();}return windowSizeMayChange;}},{key:"performTraversals",value:function performTraversals(){var host=this.mView;if(ViewRootImpl.DBG){System.out.println("======================================");System.out.println("performTraversals");host.debug();}if(host == null || !this.mAdded)return;this.mIsInTraversal = true;this.mWillDrawSoon = true;var windowSizeMayChange=false;var newSurface=false;var surfaceChanged=false;var lp=new view_2.ViewGroup.LayoutParams(view_2.ViewGroup.LayoutParams.MATCH_PARENT,view_2.ViewGroup.LayoutParams.MATCH_PARENT);var desiredWindowWidth=undefined;var desiredWindowHeight=undefined;var attachInfo=this.mAttachInfo;var viewVisibility=this.getHostVisibility();var viewVisibilityChanged=this.mViewVisibility != viewVisibility;var params=null;var frame=this.mWinFrame;if(this.mFirst){this.mFullRedrawNeeded = true;this.mLayoutRequested = true;var packageMetrics=Resources.getDisplayMetrics();desiredWindowWidth = packageMetrics.widthPixels;desiredWindowHeight = packageMetrics.heightPixels;viewVisibilityChanged = false;host.dispatchAttachedToWindow(attachInfo,0);attachInfo.mTreeObserver.dispatchOnWindowAttachedChange(true);}else {desiredWindowWidth = frame.width();desiredWindowHeight = frame.height();if(desiredWindowWidth != this.mWidth || desiredWindowHeight != this.mHeight){if(ViewRootImpl.DEBUG_ORIENTATION){Log.v(ViewRootImpl.TAG,"View " + host + " resized to: " + frame);}this.mFullRedrawNeeded = true;this.mLayoutRequested = true;windowSizeMayChange = true;}}ViewRootImpl.getRunQueue(this).executeActions(attachInfo.mHandler);var layoutRequested=this.mLayoutRequested;if(layoutRequested){if(this.mFirst){}else {if(lp.width == view_2.ViewGroup.LayoutParams.WRAP_CONTENT || lp.height == view_2.ViewGroup.LayoutParams.WRAP_CONTENT){windowSizeMayChange = true;var packageMetrics=Resources.getDisplayMetrics();desiredWindowWidth = packageMetrics.widthPixels;desiredWindowHeight = packageMetrics.heightPixels;}windowSizeMayChange = windowSizeMayChange || this.measureHierarchy(host,lp,desiredWindowWidth,desiredWindowHeight);}windowSizeMayChange == windowSizeMayChange || this.measureHierarchy(host,lp,desiredWindowWidth,desiredWindowHeight);}if(this.mFirst || attachInfo.mViewVisibilityChanged){attachInfo.mViewVisibilityChanged = false;}if(layoutRequested){this.mLayoutRequested = false;}var windowShouldResize=layoutRequested && windowSizeMayChange && (this.mWidth != host.getMeasuredWidth() || this.mHeight != host.getMeasuredHeight() || lp.width == view_2.ViewGroup.LayoutParams.WRAP_CONTENT && frame.width() < desiredWindowWidth && frame.width() != this.mWidth || lp.height == view_2.ViewGroup.LayoutParams.WRAP_CONTENT && frame.height() < desiredWindowHeight && frame.height() != this.mHeight);if(this.mFirst || windowShouldResize || viewVisibilityChanged){if(ViewRootImpl.DEBUG_LAYOUT){Log.i(ViewRootImpl.TAG,"host=w:" + host.getMeasuredWidth() + ", h:" + host.getMeasuredHeight() + ", params=" + params);}if(ViewRootImpl.DEBUG_ORIENTATION)Log.v(ViewRootImpl.TAG,"Relayout returned: frame=" + frame);if(this.mWidth != frame.width() || this.mHeight != frame.height()){this.mWidth = frame.width();this.mHeight = frame.height();}if(this.mWidth != host.getMeasuredWidth() || this.mHeight != host.getMeasuredHeight()){var childWidthMeasureSpec=ViewRootImpl.getRootMeasureSpec(this.mWidth,lp.width);var childHeightMeasureSpec=ViewRootImpl.getRootMeasureSpec(this.mHeight,lp.height);if(ViewRootImpl.DEBUG_LAYOUT)Log.v(ViewRootImpl.TAG,"Ooops, something changed!  mWidth=" + this.mWidth + " measuredWidth=" + host.getMeasuredWidth() + " mHeight=" + this.mHeight + " measuredHeight=" + host.getMeasuredHeight());this.performMeasure(childWidthMeasureSpec,childHeightMeasureSpec);layoutRequested = true;}}var didLayout=layoutRequested;var triggerGlobalLayoutListener=didLayout;if(didLayout){this.performLayout(lp,desiredWindowWidth,desiredWindowHeight);if(ViewRootImpl.DBG){System.out.println("======================================");System.out.println("performTraversals -- after setFrame");host.debug();}}if(triggerGlobalLayoutListener){attachInfo.mTreeObserver.dispatchOnGlobalLayout();}var skipDraw=false;this.mFirst = false;this.mWillDrawSoon = false;this.mViewVisibility = viewVisibility;var cancelDraw=attachInfo.mTreeObserver.dispatchOnPreDraw() || viewVisibility != View.VISIBLE;if(!cancelDraw){if(!skipDraw){this.performDraw();}}else {if(viewVisibility == View.VISIBLE){this.scheduleTraversals();}}this.mIsInTraversal = false;}},{key:"performLayout",value:function performLayout(lp,desiredWindowWidth,desiredWindowHeight){var _this9=this;this.mLayoutRequested = false;this.mInLayout = true;var host=this.mView;if(ViewRootImpl.DEBUG_ORIENTATION || ViewRootImpl.DEBUG_LAYOUT){Log.v(ViewRootImpl.TAG,"Laying out " + host + " to (" + host.getMeasuredWidth() + ", " + host.getMeasuredHeight() + ")");}host.layout(0,0,host.getMeasuredWidth(),host.getMeasuredHeight());this.mInLayout = false;var numViewsRequestingLayout=this.mLayoutRequesters.length;if(numViewsRequestingLayout > 0){var validLayoutRequesters=this.getValidLayoutRequesters(this.mLayoutRequesters,false);if(validLayoutRequesters != null){this.mHandlingLayoutInLayoutRequest = true;var numValidRequests=validLayoutRequesters.length;for(var i=0;i < numValidRequests;++i) {var _view2=validLayoutRequesters[i];Log.w("View","requestLayout() improperly called by " + _view2 + " during layout: running second layout pass");_view2.requestLayout();}this.measureHierarchy(host,lp,desiredWindowWidth,desiredWindowHeight);this.mInLayout = true;host.layout(0,0,host.getMeasuredWidth(),host.getMeasuredHeight());this.mHandlingLayoutInLayoutRequest = false;validLayoutRequesters = this.getValidLayoutRequesters(this.mLayoutRequesters,true);if(validLayoutRequesters != null){(function(){var finalRequesters=validLayoutRequesters;ViewRootImpl.getRunQueue(_this9).post({run:function run(){var numValidRequests=finalRequesters.length;for(var i=0;i < numValidRequests;++i) {var _view3=finalRequesters[i];Log.w("View","requestLayout() improperly called by " + _view3 + " during second layout pass: posting in next frame");_view3.requestLayout();}}});})();}}}this.mInLayout = false;}},{key:"getValidLayoutRequesters",value:function getValidLayoutRequesters(layoutRequesters,secondLayoutRequests){var numViewsRequestingLayout=layoutRequesters.length;var validLayoutRequesters=null;for(var i=0;i < numViewsRequestingLayout;++i) {var _view4=layoutRequesters[i];if(_view4 != null && _view4.mAttachInfo != null && _view4.mParent != null && (secondLayoutRequests || (_view4.mPrivateFlags & View.PFLAG_FORCE_LAYOUT) == View.PFLAG_FORCE_LAYOUT)){var gone=false;var _parent=_view4;while(_parent != null) {if((_parent.mViewFlags & View.VISIBILITY_MASK) == View.GONE){gone = true;break;}if(_parent.mParent instanceof View){_parent = _parent.mParent;}else {_parent = null;}}if(!gone){if(validLayoutRequesters == null){validLayoutRequesters = [];}validLayoutRequesters.push(_view4);}}}if(!secondLayoutRequests){for(var i=0;i < numViewsRequestingLayout;++i) {var _view5=layoutRequesters[i];while(_view5 != null && (_view5.mPrivateFlags & View.PFLAG_FORCE_LAYOUT) != 0) {_view5.mPrivateFlags &= ~View.PFLAG_FORCE_LAYOUT;if(_view5.mParent instanceof View){_view5 = _view5.mParent;}else {_view5 = null;}}}}layoutRequesters.splice(0,layoutRequesters.length);return validLayoutRequesters;}},{key:"performMeasure",value:function performMeasure(childWidthMeasureSpec,childHeightMeasureSpec){this.mView.measure(childWidthMeasureSpec,childHeightMeasureSpec);}},{key:"isInLayout",value:function isInLayout(){return this.mInLayout;}},{key:"requestLayoutDuringLayout",value:function requestLayoutDuringLayout(view){if(view.mParent == null || view.mAttachInfo == null){return true;}if(this.mLayoutRequesters.indexOf(view) === -1){this.mLayoutRequesters.push(view);}if(!this.mHandlingLayoutInLayoutRequest){return true;}else {return false;}}},{key:"trackFPS",value:function trackFPS(){var nowTime=System.currentTimeMillis();if(this.mFpsStartTime < 0){this.mFpsStartTime = this.mFpsPrevTime = nowTime;this.mFpsNumFrames = 0;}else {this.mFpsNumFrames++;var frameTime=nowTime - this.mFpsPrevTime;var totalTime=nowTime - this.mFpsStartTime;Log.v(ViewRootImpl.TAG,"Frame time:\t" + frameTime);this.mFpsPrevTime = nowTime;if(totalTime > 1000){var fps=this.mFpsNumFrames * 1000 / totalTime;Log.v(ViewRootImpl.TAG,"FPS:\t" + fps);this.mFpsStartTime = nowTime;this.mFpsNumFrames = 0;}}}},{key:"performDraw",value:function performDraw(){var fullRedrawNeeded=this.mFullRedrawNeeded;this.mFullRedrawNeeded = false;this.mIsDrawing = true;try{this.draw(fullRedrawNeeded);}finally {this.mIsDrawing = false;}}},{key:"draw",value:function draw(fullRedrawNeeded){if(ViewRootImpl.DEBUG_FPS){this.trackFPS();}var attachInfo=this.mAttachInfo;if(attachInfo.mViewScrollChanged){attachInfo.mViewScrollChanged = false;attachInfo.mTreeObserver.dispatchOnScrollChanged();}if(fullRedrawNeeded){attachInfo.mIgnoreDirtyState = true;this.mDirty.set(0,0,this.mWidth,this.mHeight);}if(ViewRootImpl.DEBUG_ORIENTATION || ViewRootImpl.DEBUG_DRAW){Log.v(ViewRootImpl.TAG,"Draw " + this.mView + ", width=" + this.mWidth + ", height=" + this.mHeight + ", dirty=" + this.mDirty);}attachInfo.mTreeObserver.dispatchOnDraw();this.drawSoftware();}},{key:"drawSoftware",value:function drawSoftware(){var canvas=this.mSurface.lockCanvas(this.mDirty);this.mDirty.setEmpty();var attachInfo=this.mAttachInfo;attachInfo.mDrawingTime = SystemClock.uptimeMillis();this.mView.mPrivateFlags |= View.PFLAG_DRAWN;attachInfo.mSetIgnoreDirtyState = false;this.mView.draw(canvas);if(!attachInfo.mSetIgnoreDirtyState){attachInfo.mIgnoreDirtyState = false;}this.mSurface.unlockCanvasAndPost(canvas);if(ViewRootImpl.LOCAL_LOGV){Log.v(ViewRootImpl.TAG,"Surface unlockCanvasAndPost");}}},{key:"isLayoutRequested",value:function isLayoutRequested(){return this.mLayoutRequested;}},{key:"dispatchInvalidateDelayed",value:function dispatchInvalidateDelayed(view,delayMilliseconds){var msg=this.mHandler.obtainMessage(ViewRootHandler.MSG_INVALIDATE,view);this.mHandler.sendMessageDelayed(msg,delayMilliseconds);}},{key:"dispatchInvalidateRectDelayed",value:function dispatchInvalidateRectDelayed(info,delayMilliseconds){var msg=this.mHandler.obtainMessage(ViewRootHandler.MSG_INVALIDATE_RECT,info);this.mHandler.sendMessageDelayed(msg,delayMilliseconds);}},{key:"dispatchInvalidateOnAnimation",value:function dispatchInvalidateOnAnimation(view){this.mInvalidateOnAnimationRunnable.addView(view);}},{key:"dispatchInvalidateRectOnAnimation",value:function dispatchInvalidateRectOnAnimation(info){this.mInvalidateOnAnimationRunnable.addViewRect(info);}},{key:"cancelInvalidate",value:function cancelInvalidate(view){this.mHandler.removeMessages(ViewRootHandler.MSG_INVALIDATE,view);this.mHandler.removeMessages(ViewRootHandler.MSG_INVALIDATE_RECT,view);this.mInvalidateOnAnimationRunnable.removeView(view);}},{key:"getParent",value:function getParent(){return null;}},{key:"requestLayout",value:function requestLayout(){if(!this.mHandlingLayoutInLayoutRequest){this.mLayoutRequested = true;this.scheduleTraversals();}}},{key:"invalidate",value:function invalidate(){this.mDirty.set(0,0,this.mWidth,this.mHeight);this.scheduleTraversals();}},{key:"invalidateWorld",value:function invalidateWorld(view){view.invalidate();if(view instanceof view_2.ViewGroup){var _parent2=view;for(var i=0;i < _parent2.getChildCount();i++) {this.invalidateWorld(_parent2.getChildAt(i));}}}},{key:"invalidateChild",value:function invalidateChild(child,dirty){this.invalidateChildInParent(null,dirty);}},{key:"invalidateChildInParent",value:function invalidateChildInParent(location,dirty){if(ViewRootImpl.DEBUG_DRAW)Log.v(ViewRootImpl.TAG,"Invalidate child: " + dirty);if(dirty == null){this.invalidate();return null;}else if(dirty.isEmpty()){return null;}var localDirty=this.mDirty;if(!localDirty.isEmpty() && !localDirty.contains(dirty)){this.mAttachInfo.mSetIgnoreDirtyState = true;this.mAttachInfo.mIgnoreDirtyState = true;}localDirty.union(dirty.left,dirty.top,dirty.right,dirty.bottom);var intersected=localDirty.intersect(0,0,this.mWidth,this.mHeight);if(!intersected){localDirty.setEmpty();}if(!this.mWillDrawSoon && intersected){this.scheduleTraversals();}return null;}},{key:"requestChildFocus",value:function requestChildFocus(child,focused){}},{key:"clearChildFocus",value:function clearChildFocus(child){}},{key:"getChildVisibleRect",value:function getChildVisibleRect(child,r,offset){return undefined;}},{key:"focusSearch",value:function focusSearch(v,direction){return undefined;}},{key:"bringChildToFront",value:function bringChildToFront(child){}},{key:"focusableViewAvailable",value:function focusableViewAvailable(v){}},{key:"childDrawableStateChanged",value:function childDrawableStateChanged(child){}},{key:"requestDisallowInterceptTouchEvent",value:function requestDisallowInterceptTouchEvent(disallowIntercept){}},{key:"childHasTransientStateChanged",value:function childHasTransientStateChanged(child,hasTransientState){}}],[{key:"getRootMeasureSpec",value:function getRootMeasureSpec(windowSize,rootDimension){var MeasureSpec=View.MeasureSpec;var measureSpec=undefined;switch(rootDimension){case view_2.ViewGroup.LayoutParams.MATCH_PARENT:measureSpec = MeasureSpec.makeMeasureSpec(windowSize,MeasureSpec.EXACTLY);break;case view_2.ViewGroup.LayoutParams.WRAP_CONTENT:measureSpec = MeasureSpec.makeMeasureSpec(windowSize,MeasureSpec.AT_MOST);break;default:measureSpec = MeasureSpec.makeMeasureSpec(rootDimension,MeasureSpec.EXACTLY);break;}return measureSpec;}},{key:"getRunQueue",value:function getRunQueue(viewRoot){if(viewRoot){if(!viewRoot.mRunQueue)viewRoot.mRunQueue = new ViewRootImpl.RunQueue();return viewRoot.mRunQueue;}else {if(!this.RunQueueInstance){this.RunQueueInstance = new RunQueueForNoViewRoot();}return this.RunQueueInstance;}}}]);return ViewRootImpl;})();ViewRootImpl.TAG = "ViewRootImpl";ViewRootImpl.DBG = Log.View_DBG;ViewRootImpl.LOCAL_LOGV = ViewRootImpl.DBG;ViewRootImpl.DEBUG_DRAW = false || ViewRootImpl.LOCAL_LOGV;ViewRootImpl.DEBUG_LAYOUT = false || ViewRootImpl.LOCAL_LOGV;ViewRootImpl.DEBUG_INPUT_RESIZE = false || ViewRootImpl.LOCAL_LOGV;ViewRootImpl.DEBUG_ORIENTATION = false || ViewRootImpl.LOCAL_LOGV;ViewRootImpl.DEBUG_CONFIGURATION = false || ViewRootImpl.LOCAL_LOGV;ViewRootImpl.DEBUG_FPS = false || ViewRootImpl.LOCAL_LOGV;view_2.ViewRootImpl = ViewRootImpl;(function(ViewRootImpl){var RunQueue=(function(){function RunQueue(){_classCallCheck(this,RunQueue);this.mActions = [];}_createClass(RunQueue,[{key:"post",value:function post(action){this.postDelayed(action,0);}},{key:"postDelayed",value:function postDelayed(action,delayMillis){var handlerAction={action:action,delay:delayMillis};this.mActions.push(handlerAction);}},{key:"removeCallbacks",value:function removeCallbacks(action){this.mActions = this.mActions.filter(function(item){return item.action == action;});}},{key:"executeActions",value:function executeActions(handler){var _iteratorNormalCompletion8=true;var _didIteratorError8=false;var _iteratorError8=undefined;try{for(var _iterator8=this.mActions[Symbol.iterator](),_step8;!(_iteratorNormalCompletion8 = (_step8 = _iterator8.next()).done);_iteratorNormalCompletion8 = true) {var handlerAction=_step8.value;handler.postDelayed(handlerAction.action,handlerAction.delay);}}catch(err) {_didIteratorError8 = true;_iteratorError8 = err;}finally {try{if(!_iteratorNormalCompletion8 && _iterator8["return"]){_iterator8["return"]();}}finally {if(_didIteratorError8){throw _iteratorError8;}}}this.mActions = [];}}]);return RunQueue;})();ViewRootImpl.RunQueue = RunQueue;})(ViewRootImpl = view_2.ViewRootImpl || (view_2.ViewRootImpl = {}));var RunQueueForNoViewRoot=(function(_ViewRootImpl$RunQueue){_inherits(RunQueueForNoViewRoot,_ViewRootImpl$RunQueue);function RunQueueForNoViewRoot(){_classCallCheck(this,RunQueueForNoViewRoot);_get(Object.getPrototypeOf(RunQueueForNoViewRoot.prototype),"constructor",this).apply(this,arguments);}_createClass(RunQueueForNoViewRoot,[{key:"postDelayed",value:function postDelayed(action,delayMillis){RunQueueForNoViewRoot.Handler.postDelayed(action,delayMillis);}},{key:"removeCallbacks",value:function removeCallbacks(action){RunQueueForNoViewRoot.Handler.removeCallbacks(action);}}]);return RunQueueForNoViewRoot;})(ViewRootImpl.RunQueue);RunQueueForNoViewRoot.Handler = new Handler();var TraversalRunnable=(function(){function TraversalRunnable(impl){_classCallCheck(this,TraversalRunnable);this.ViewRootImpl_this = impl;}_createClass(TraversalRunnable,[{key:"run",value:function run(){this.ViewRootImpl_this.doTraversal();}}]);return TraversalRunnable;})();var InvalidateOnAnimationRunnable=(function(){function InvalidateOnAnimationRunnable(handler){_classCallCheck(this,InvalidateOnAnimationRunnable);this.mPosted = false;this.mViews = new Set();this.mViewRects = new Map();this.mHandler = handler;}_createClass(InvalidateOnAnimationRunnable,[{key:"addView",value:function addView(view){this.mViews.add(view);this.postIfNeededLocked();}},{key:"addViewRect",value:function addViewRect(info){this.mViewRects.set(info.target,info);this.postIfNeededLocked();}},{key:"removeView",value:function removeView(view){this.mViews["delete"](view);this.mViewRects["delete"](view);if(this.mPosted && this.mViews.size === 0 && this.mViewRects.size === 0){this.mHandler.removeCallbacks(this);this.mPosted = false;}}},{key:"run",value:function run(){this.mPosted = false;var _iteratorNormalCompletion9=true;var _didIteratorError9=false;var _iteratorError9=undefined;try{for(var _iterator9=this.mViews[Symbol.iterator](),_step9;!(_iteratorNormalCompletion9 = (_step9 = _iterator9.next()).done);_iteratorNormalCompletion9 = true) {var _view6=_step9.value;_view6.invalidate();}}catch(err) {_didIteratorError9 = true;_iteratorError9 = err;}finally {try{if(!_iteratorNormalCompletion9 && _iterator9["return"]){_iterator9["return"]();}}finally {if(_didIteratorError9){throw _iteratorError9;}}}this.mViews.clear();var _iteratorNormalCompletion10=true;var _didIteratorError10=false;var _iteratorError10=undefined;try{for(var _iterator10=this.mViewRects.values()[Symbol.iterator](),_step10;!(_iteratorNormalCompletion10 = (_step10 = _iterator10.next()).done);_iteratorNormalCompletion10 = true) {var info=_step10.value;info.target.invalidate(info.left,info.top,info.right,info.bottom);info.recycle();}}catch(err) {_didIteratorError10 = true;_iteratorError10 = err;}finally {try{if(!_iteratorNormalCompletion10 && _iterator10["return"]){_iterator10["return"]();}}finally {if(_didIteratorError10){throw _iteratorError10;}}}this.mViewRects.clear();}},{key:"postIfNeededLocked",value:function postIfNeededLocked(){if(!this.mPosted){this.mHandler.post(this);this.mPosted = true;}}}]);return InvalidateOnAnimationRunnable;})();var ViewRootHandler=(function(_Handler){_inherits(ViewRootHandler,_Handler);function ViewRootHandler(){_classCallCheck(this,ViewRootHandler);_get(Object.getPrototypeOf(ViewRootHandler.prototype),"constructor",this).apply(this,arguments);}_createClass(ViewRootHandler,[{key:"handleMessage",value:function handleMessage(msg){switch(msg.what){case ViewRootHandler.MSG_INVALIDATE:msg.obj.invalidate();break;case ViewRootHandler.MSG_INVALIDATE_RECT:var info=msg.obj;info.target.invalidate(info.left,info.top,info.right,info.bottom);info.recycle();break;}}}]);return ViewRootHandler;})(Handler);ViewRootHandler.MSG_INVALIDATE = 1;ViewRootHandler.MSG_INVALIDATE_RECT = 2;})(view = android.view || (android.view = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/10/5.
 */ ///<reference path="ViewRootImpl.ts"/>
///<reference path="View.ts"/>
///<reference path="MotionEvent.ts"/>
///<reference path="ViewParent.ts"/>
///<reference path="../graphics/Canvas.ts"/>
///<reference path="../graphics/Point.ts"/>
///<reference path="../graphics/Matrix.ts"/>
///<reference path="../graphics/Rect.ts"/>
///<reference path="../os/SystemClock.ts"/>
///<reference path="../util/TypedValue.ts"/>
var android;(function(android){var view;(function(view_3){var Rect=android.graphics.Rect;var SystemClock=android.os.SystemClock;var TypedValue=android.util.TypedValue;var ViewGroup=(function(_view_3$View){_inherits(ViewGroup,_view_3$View);function ViewGroup(){_classCallCheck(this,ViewGroup);_get(Object.getPrototypeOf(ViewGroup.prototype),"constructor",this).call(this);this.mLastTouchDownTime = 0;this.mLastTouchDownIndex = -1;this.mLastTouchDownX = 0;this.mLastTouchDownY = 0;this.mGroupFlags = 0;this.mLayoutMode = ViewGroup.LAYOUT_MODE_UNDEFINED;this.mChildren = [];this.mSuppressLayout = false;this.mLayoutCalledWhileSuppressed = false;this.initViewGroup();}_createClass(ViewGroup,[{key:"createAttrChangeHandler",value:function createAttrChangeHandler(mergeHandler){_get(Object.getPrototypeOf(ViewGroup.prototype),"createAttrChangeHandler",this).call(this,mergeHandler);var viewGroup=this;mergeHandler.add(Object.defineProperties({},{clipChildren:{set:function set(value){viewGroup.setClipChildren(view_3.View.AttrChangeHandler.parseBoolean(value));},configurable:true,enumerable:true},clipToPadding:{set:function set(value){viewGroup.setClipToPadding(view_3.View.AttrChangeHandler.parseBoolean(value));},configurable:true,enumerable:true},animationCache:{set:function set(value){},configurable:true,enumerable:true},persistentDrawingCache:{set:function set(value){},configurable:true,enumerable:true},addStatesFromChildren:{set:function set(value){},configurable:true,enumerable:true},alwaysDrawnWithCache:{set:function set(value){},configurable:true,enumerable:true},layoutAnimation:{set:function set(value){},configurable:true,enumerable:true},descendantFocusability:{set:function set(value){},configurable:true,enumerable:true},splitMotionEvents:{set:function set(value){},configurable:true,enumerable:true},animateLayoutChanges:{set:function set(value){},configurable:true,enumerable:true},layoutMode:{set:function set(value){},configurable:true,enumerable:true}}));}},{key:"initViewGroup",value:function initViewGroup(){this.setFlags(view_3.View.WILL_NOT_DRAW,view_3.View.DRAW_MASK);this.mGroupFlags |= ViewGroup.FLAG_CLIP_CHILDREN;this.mGroupFlags |= ViewGroup.FLAG_CLIP_TO_PADDING;this.mGroupFlags |= ViewGroup.FLAG_ANIMATION_DONE;this.mGroupFlags |= ViewGroup.FLAG_ANIMATION_CACHE;this.mGroupFlags |= ViewGroup.FLAG_ALWAYS_DRAWN_WITH_CACHE;this.mGroupFlags |= ViewGroup.FLAG_SPLIT_MOTION_EVENTS;}},{key:"addView",value:function addView(){for(var _len22=arguments.length,args=Array(_len22),_key22=0;_key22 < _len22;_key22++) {args[_key22] = arguments[_key22];}var child=args[0];var params=child.getLayoutParams();var index=-1;if(args.length == 2){if(args[1] instanceof ViewGroup.LayoutParams)params = args[1];else index = args[1];}else if(args.length == 3){if(args[2] instanceof ViewGroup.LayoutParams){index = args[1];params = args[2];}else {params = this.generateDefaultLayoutParams();params.width = args[1];params.height = args[2];}}if(params == null){params = this.generateDefaultLayoutParams();if(params == null){throw new Error("generateDefaultLayoutParams() cannot return null");}}this.requestLayout();this.invalidate(true);this.addViewInner(child,index,params,false);}},{key:"checkLayoutParams",value:function checkLayoutParams(p){return p != null;}},{key:"setOnHierarchyChangeListener",value:function setOnHierarchyChangeListener(listener){this.mOnHierarchyChangeListener = listener;}},{key:"onViewAdded",value:function onViewAdded(child){if(this.mOnHierarchyChangeListener != null){this.mOnHierarchyChangeListener.onChildViewAdded(this,child);}}},{key:"onViewRemoved",value:function onViewRemoved(child){if(this.mOnHierarchyChangeListener != null){this.mOnHierarchyChangeListener.onChildViewRemoved(this,child);}}},{key:"clearCachedLayoutMode",value:function clearCachedLayoutMode(){if(!this.hasBooleanFlag(ViewGroup.FLAG_LAYOUT_MODE_WAS_EXPLICITLY_SET)){this.mLayoutMode = ViewGroup.LAYOUT_MODE_UNDEFINED;}}},{key:"addViewInLayout",value:function addViewInLayout(child,index,params){var preventRequestLayout=arguments.length <= 3 || arguments[3] === undefined?false:arguments[3];child.mParent = null;this.addViewInner(child,index,params,preventRequestLayout);child.mPrivateFlags = child.mPrivateFlags & ~ViewGroup.PFLAG_DIRTY_MASK | ViewGroup.PFLAG_DRAWN;return true;}},{key:"cleanupLayoutState",value:function cleanupLayoutState(child){child.mPrivateFlags &= ~view_3.View.PFLAG_FORCE_LAYOUT;}},{key:"addViewInner",value:function addViewInner(child,index,params,preventRequestLayout){if(child.getParent() != null){throw new Error("The specified child already has a parent. " + "You must call removeView() on the child's parent first.");}if(!this.checkLayoutParams(params)){params = this.generateLayoutParams(params);}if(preventRequestLayout){child.mLayoutParams = params;}else {child.setLayoutParams(params);}if(index < 0){index = this.mChildrenCount;}this.addInArray(child,index);if(preventRequestLayout){child.assignParent(this);}else {child.mParent = this;}var ai=this.mAttachInfo;if(ai != null && (this.mGroupFlags & ViewGroup.FLAG_PREVENT_DISPATCH_ATTACHED_TO_WINDOW) == 0){child.dispatchAttachedToWindow(this.mAttachInfo,this.mViewFlags & ViewGroup.VISIBILITY_MASK);}this.onViewAdded(child);if((child.mViewFlags & ViewGroup.DUPLICATE_PARENT_STATE) == ViewGroup.DUPLICATE_PARENT_STATE){this.mGroupFlags |= ViewGroup.FLAG_NOTIFY_CHILDREN_ON_DRAWABLE_STATE_CHANGE;}}},{key:"addInArray",value:function addInArray(child,index){var count=this.mChildrenCount;if(index == count){this.mChildren.push(child);this.addToBindElement(child.bindElement,null);}else if(index < count){var refChild=this.getChildAt(index);this.mChildren.splice(index,0,child);this.addToBindElement(child.bindElement,refChild.bindElement);}else {throw new Error("index=" + index + " count=" + count);}}},{key:"addToBindElement",value:function addToBindElement(childElement,insertBeforeElement){if(childElement.parentElement){if(childElement.parentElement == this.bindElement)return;childElement.parentElement.removeChild(childElement);}if(insertBeforeElement){this.bindElement.appendChild(childElement);}else {this.bindElement.insertBefore(childElement,insertBeforeElement);}}},{key:"removeFromArray",value:function removeFromArray(index){var count=arguments.length <= 1 || arguments[1] === undefined?1:arguments[1];var start=Math.max(0,index);var end=Math.min(this.mChildrenCount,start + count);if(start == end){return;}for(var i=start;i < end;i++) {this.mChildren[i].mParent = null;this.bindElement.removeChild(this.mChildren[i].bindElement);}this.mChildren.splice(index,end - start);}},{key:"removeView",value:function removeView(view){this.removeViewInternal(view);this.requestLayout();this.invalidate(true);}},{key:"removeViewInLayout",value:function removeViewInLayout(view){this.removeViewInternal(view);}},{key:"removeViewsInLayout",value:function removeViewsInLayout(start,count){this.removeViewsInternal(start,count);}},{key:"removeViewAt",value:function removeViewAt(index){this.removeViewsInternal(index,1);this.requestLayout();this.invalidate(true);}},{key:"removeViews",value:function removeViews(start,count){this.removeViewsInternal(start,count);this.requestLayout();this.invalidate(true);}},{key:"removeViewInternal",value:function removeViewInternal(view){var index=this.indexOfChild(view);if(index >= 0){this.removeViewsInternal(index,1);}}},{key:"removeViewsInternal",value:function removeViewsInternal(start,count){var detach=this.mAttachInfo != null;var children=this.mChildren;var end=start + count;for(var i=start;i < end;i++) {var _view7=children[i];if(detach){_view7.dispatchDetachedFromWindow();}this.onViewRemoved(_view7);}this.removeFromArray(start,count);}},{key:"removeAllViews",value:function removeAllViews(){this.removeAllViewsInLayout();this.requestLayout();this.invalidate(true);}},{key:"removeAllViewsInLayout",value:function removeAllViewsInLayout(){var count=this.mChildrenCount;if(count <= 0){return;}this.removeViewsInternal(0,count);}},{key:"indexOfChild",value:function indexOfChild(child){return this.mChildren.indexOf(child);}},{key:"getChildCount",value:function getChildCount(){return this.mChildrenCount;}},{key:"getChildAt",value:function getChildAt(index){if(index < 0 || index >= this.mChildrenCount){return null;}return this.mChildren[index];}},{key:"bringChildToFront",value:function bringChildToFront(child){var index=this.indexOfChild(child);if(index >= 0){this.removeFromArray(index);this.addInArray(child,this.mChildrenCount);child.mParent = this;this.requestLayout();this.invalidate();}}},{key:"hasBooleanFlag",value:function hasBooleanFlag(flag){return (this.mGroupFlags & flag) == flag;}},{key:"setBooleanFlag",value:function setBooleanFlag(flag,value){if(value){this.mGroupFlags |= flag;}else {this.mGroupFlags &= ~flag;}}},{key:"onInterceptTouchEvent",value:function onInterceptTouchEvent(ev){return false;}},{key:"dispatchTouchEvent",value:function dispatchTouchEvent(ev){var handled=false;if(this.onFilterTouchEventForSecurity(ev)){var action=ev.getAction();var actionMasked=action & view_3.MotionEvent.ACTION_MASK;if(actionMasked == view_3.MotionEvent.ACTION_DOWN){this.cancelAndClearTouchTargets(ev);this.resetTouchState();}var intercepted=undefined;if(actionMasked == view_3.MotionEvent.ACTION_DOWN || this.mFirstTouchTarget != null){var disallowIntercept=(this.mGroupFlags & ViewGroup.FLAG_DISALLOW_INTERCEPT) != 0;if(!disallowIntercept){intercepted = this.onInterceptTouchEvent(ev);ev.setAction(action);}else {intercepted = false;}}else {intercepted = true;}var canceled=ViewGroup.resetCancelNextUpFlag(this) || actionMasked == view_3.MotionEvent.ACTION_CANCEL;var split=(this.mGroupFlags & ViewGroup.FLAG_SPLIT_MOTION_EVENTS) != 0;var newTouchTarget=null;var alreadyDispatchedToNewTouchTarget=false;if(!canceled && !intercepted){if(actionMasked == view_3.MotionEvent.ACTION_DOWN || split && actionMasked == view_3.MotionEvent.ACTION_POINTER_DOWN || actionMasked == view_3.MotionEvent.ACTION_HOVER_MOVE){var actionIndex=ev.getActionIndex();var idBitsToAssign=split?1 << ev.getPointerId(actionIndex):TouchTarget.ALL_POINTER_IDS;this.removePointersFromTouchTargets(idBitsToAssign);var childrenCount=this.mChildrenCount;if(newTouchTarget == null && childrenCount != 0){var x=ev.getX(actionIndex);var y=ev.getY(actionIndex);var children=this.mChildren;var customOrder=this.isChildrenDrawingOrderEnabled();for(var i=childrenCount - 1;i >= 0;i--) {var childIndex=customOrder?this.getChildDrawingOrder(childrenCount,i):i;var child=children[childIndex];if(!ViewGroup.canViewReceivePointerEvents(child) || !this.isTransformedTouchPointInView(x,y,child,null)){continue;}newTouchTarget = this.getTouchTarget(child);if(newTouchTarget != null){newTouchTarget.pointerIdBits |= idBitsToAssign;break;}ViewGroup.resetCancelNextUpFlag(child);if(this.dispatchTransformedTouchEvent(ev,false,child,idBitsToAssign)){this.mLastTouchDownTime = ev.getDownTime();this.mLastTouchDownIndex = childIndex;this.mLastTouchDownX = ev.getX();this.mLastTouchDownY = ev.getY();newTouchTarget = this.addTouchTarget(child,idBitsToAssign);alreadyDispatchedToNewTouchTarget = true;break;}}}if(newTouchTarget == null && this.mFirstTouchTarget != null){newTouchTarget = this.mFirstTouchTarget;while(newTouchTarget.next != null) {newTouchTarget = newTouchTarget.next;}newTouchTarget.pointerIdBits |= idBitsToAssign;}}}if(this.mFirstTouchTarget == null){handled = this.dispatchTransformedTouchEvent(ev,canceled,null,TouchTarget.ALL_POINTER_IDS);}else {var predecessor=null;var target=this.mFirstTouchTarget;while(target != null) {var next=target.next;if(alreadyDispatchedToNewTouchTarget && target == newTouchTarget){handled = true;}else {var cancelChild=ViewGroup.resetCancelNextUpFlag(target.child) || intercepted;if(this.dispatchTransformedTouchEvent(ev,cancelChild,target.child,target.pointerIdBits)){handled = true;}if(cancelChild){if(predecessor == null){this.mFirstTouchTarget = next;}else {predecessor.next = next;}target.recycle();target = next;continue;}}predecessor = target;target = next;}}if(canceled || actionMasked == view_3.MotionEvent.ACTION_UP || actionMasked == view_3.MotionEvent.ACTION_HOVER_MOVE){this.resetTouchState();}else if(split && actionMasked == view_3.MotionEvent.ACTION_POINTER_UP){var actionIndex=ev.getActionIndex();var idBitsToRemove=1 << ev.getPointerId(actionIndex);this.removePointersFromTouchTargets(idBitsToRemove);}}return handled;}},{key:"resetTouchState",value:function resetTouchState(){this.clearTouchTargets();ViewGroup.resetCancelNextUpFlag(this);this.mGroupFlags &= ~ViewGroup.FLAG_DISALLOW_INTERCEPT;}},{key:"clearTouchTargets",value:function clearTouchTargets(){var target=this.mFirstTouchTarget;if(target != null){do {var next=target.next;target.recycle();target = next;}while(target != null);this.mFirstTouchTarget = null;}}},{key:"cancelAndClearTouchTargets",value:function cancelAndClearTouchTargets(event){if(this.mFirstTouchTarget != null){var syntheticEvent=false;if(event == null){var now=SystemClock.uptimeMillis();event = view_3.MotionEvent.obtainWithAction(now,now,view_3.MotionEvent.ACTION_CANCEL,0,0);syntheticEvent = true;}for(var target=this.mFirstTouchTarget;target != null;target = target.next) {ViewGroup.resetCancelNextUpFlag(target.child);this.dispatchTransformedTouchEvent(event,true,target.child,target.pointerIdBits);}this.clearTouchTargets();if(syntheticEvent){event.recycle();}}}},{key:"getTouchTarget",value:function getTouchTarget(child){for(var target=this.mFirstTouchTarget;target != null;target = target.next) {if(target.child == child){return target;}}return null;}},{key:"addTouchTarget",value:function addTouchTarget(child,pointerIdBits){var target=TouchTarget.obtain(child,pointerIdBits);target.next = this.mFirstTouchTarget;this.mFirstTouchTarget = target;return target;}},{key:"removePointersFromTouchTargets",value:function removePointersFromTouchTargets(pointerIdBits){var predecessor=null;var target=this.mFirstTouchTarget;while(target != null) {var next=target.next;if((target.pointerIdBits & pointerIdBits) != 0){target.pointerIdBits &= ~pointerIdBits;if(target.pointerIdBits == 0){if(predecessor == null){this.mFirstTouchTarget = next;}else {predecessor.next = next;}target.recycle();target = next;continue;}}predecessor = target;target = next;}}},{key:"cancelTouchTarget",value:function cancelTouchTarget(view){var predecessor=null;var target=this.mFirstTouchTarget;while(target != null) {var next=target.next;if(target.child == view){if(predecessor == null){this.mFirstTouchTarget = next;}else {predecessor.next = next;}target.recycle();var now=SystemClock.uptimeMillis();var _event=view_3.MotionEvent.obtainWithAction(now,now,view_3.MotionEvent.ACTION_CANCEL,0,0);view.dispatchTouchEvent(_event);_event.recycle();return;}predecessor = target;target = next;}}},{key:"isTransformedTouchPointInView",value:function isTransformedTouchPointInView(x,y,child,outLocalPoint){var localX=x + this.mScrollX - child.mLeft;var localY=y + this.mScrollY - child.mTop;var isInView=child.pointInView(localX,localY);if(isInView && outLocalPoint != null){outLocalPoint.set(localX,localY);}return isInView;}},{key:"dispatchTransformedTouchEvent",value:function dispatchTransformedTouchEvent(event,cancel,child,desiredPointerIdBits){var handled=undefined;var oldAction=event.getAction();if(cancel || oldAction == view_3.MotionEvent.ACTION_CANCEL){event.setAction(view_3.MotionEvent.ACTION_CANCEL);if(child == null){handled = _get(Object.getPrototypeOf(ViewGroup.prototype),"dispatchTouchEvent",this).call(this,event);}else {handled = child.dispatchTouchEvent(event);}event.setAction(oldAction);return handled;}var oldPointerIdBits=event.getPointerIdBits();var newPointerIdBits=oldPointerIdBits & desiredPointerIdBits;if(newPointerIdBits == 0){return false;}var transformedEvent=undefined;if(newPointerIdBits == oldPointerIdBits){if(child == null || child.hasIdentityMatrix()){if(child == null){handled = _get(Object.getPrototypeOf(ViewGroup.prototype),"dispatchTouchEvent",this).call(this,event);}else {var offsetX=this.mScrollX - child.mLeft;var offsetY=this.mScrollY - child.mTop;event.offsetLocation(offsetX,offsetY);handled = child.dispatchTouchEvent(event);event.offsetLocation(-offsetX,-offsetY);}return handled;}transformedEvent = view_3.MotionEvent.obtain(event);}else {transformedEvent = event.split(newPointerIdBits);}if(child == null){handled = _get(Object.getPrototypeOf(ViewGroup.prototype),"dispatchTouchEvent",this).call(this,transformedEvent);}else {var offsetX=this.mScrollX - child.mLeft;var offsetY=this.mScrollY - child.mTop;transformedEvent.offsetLocation(offsetX,offsetY);handled = child.dispatchTouchEvent(transformedEvent);}transformedEvent.recycle();return handled;}},{key:"isChildrenDrawingOrderEnabled",value:function isChildrenDrawingOrderEnabled(){return (this.mGroupFlags & ViewGroup.FLAG_USE_CHILD_DRAWING_ORDER) == ViewGroup.FLAG_USE_CHILD_DRAWING_ORDER;}},{key:"setChildrenDrawingOrderEnabled",value:function setChildrenDrawingOrderEnabled(enabled){this.setBooleanFlag(ViewGroup.FLAG_USE_CHILD_DRAWING_ORDER,enabled);}},{key:"getChildDrawingOrder",value:function getChildDrawingOrder(childCount,i){return i;}},{key:"generateLayoutParams",value:function generateLayoutParams(p){return p;}},{key:"generateDefaultLayoutParams",value:function generateDefaultLayoutParams(){return new ViewGroup.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT,ViewGroup.LayoutParams.WRAP_CONTENT);}},{key:"measureChildren",value:function measureChildren(widthMeasureSpec,heightMeasureSpec){var size=this.mChildren.length;for(var i=0;i < size;++i) {var child=this.mChildren[i];if((child.mViewFlags & view_3.View.VISIBILITY_MASK) != view_3.View.GONE){this.measureChild(child,widthMeasureSpec,heightMeasureSpec);}}}},{key:"measureChild",value:function measureChild(child,parentWidthMeasureSpec,parentHeightMeasureSpec){var lp=child.getLayoutParams();lp._measuringParentWidthMeasureSpec = parentWidthMeasureSpec;lp._measuringParentHeightMeasureSpec = parentHeightMeasureSpec;var childWidthMeasureSpec=ViewGroup.getChildMeasureSpec(parentWidthMeasureSpec,this.mPaddingLeft + this.mPaddingRight,lp.width);var childHeightMeasureSpec=ViewGroup.getChildMeasureSpec(parentHeightMeasureSpec,this.mPaddingTop + this.mPaddingBottom,lp.height);child.measure(childWidthMeasureSpec,childHeightMeasureSpec);lp._measuringParentWidthMeasureSpec = null;lp._measuringParentHeightMeasureSpec = null;}},{key:"measureChildWithMargins",value:function measureChildWithMargins(child,parentWidthMeasureSpec,widthUsed,parentHeightMeasureSpec,heightUsed){var lp=child.getLayoutParams();lp._measuringParentWidthMeasureSpec = parentWidthMeasureSpec;lp._measuringParentHeightMeasureSpec = parentHeightMeasureSpec;if(lp instanceof ViewGroup.MarginLayoutParams){var childWidthMeasureSpec=ViewGroup.getChildMeasureSpec(parentWidthMeasureSpec,this.mPaddingLeft + this.mPaddingRight + lp.leftMargin + lp.rightMargin + widthUsed,lp.width);var childHeightMeasureSpec=ViewGroup.getChildMeasureSpec(parentHeightMeasureSpec,this.mPaddingTop + this.mPaddingBottom + lp.topMargin + lp.bottomMargin + heightUsed,lp.height);child.measure(childWidthMeasureSpec,childHeightMeasureSpec);}lp._measuringParentWidthMeasureSpec = null;lp._measuringParentHeightMeasureSpec = null;}},{key:"dispatchAttachedToWindow",value:function dispatchAttachedToWindow(info,visibility){this.mGroupFlags |= ViewGroup.FLAG_PREVENT_DISPATCH_ATTACHED_TO_WINDOW;_get(Object.getPrototypeOf(ViewGroup.prototype),"dispatchAttachedToWindow",this).call(this,info,visibility);this.mGroupFlags &= ~ViewGroup.FLAG_PREVENT_DISPATCH_ATTACHED_TO_WINDOW;var count=this.mChildrenCount;var children=this.mChildren;for(var i=0;i < count;i++) {var child=children[i];child.dispatchAttachedToWindow(info,visibility | child.mViewFlags & view_3.View.VISIBILITY_MASK);}}},{key:"onAttachedToWindow",value:function onAttachedToWindow(){_get(Object.getPrototypeOf(ViewGroup.prototype),"onAttachedToWindow",this).call(this);this.clearCachedLayoutMode();}},{key:"onDetachedFromWindow",value:function onDetachedFromWindow(){_get(Object.getPrototypeOf(ViewGroup.prototype),"onDetachedFromWindow",this).call(this);this.clearCachedLayoutMode();}},{key:"dispatchDetachedFromWindow",value:function dispatchDetachedFromWindow(){this.cancelAndClearTouchTargets(null);this.mLayoutCalledWhileSuppressed = false;this.mChildren.forEach(function(child){return child.dispatchDetachedFromWindow();});_get(Object.getPrototypeOf(ViewGroup.prototype),"dispatchDetachedFromWindow",this).call(this);}},{key:"dispatchVisibilityChanged",value:function dispatchVisibilityChanged(changedView,visibility){_get(Object.getPrototypeOf(ViewGroup.prototype),"dispatchVisibilityChanged",this).call(this,changedView,visibility);var count=this.mChildrenCount;var children=this.mChildren;for(var i=0;i < count;i++) {children[i].dispatchVisibilityChanged(changedView,visibility);}}},{key:"offsetDescendantRectToMyCoords",value:function offsetDescendantRectToMyCoords(descendant,rect){this.offsetRectBetweenParentAndChild(descendant,rect,true,false);}},{key:"offsetRectIntoDescendantCoords",value:function offsetRectIntoDescendantCoords(descendant,rect){this.offsetRectBetweenParentAndChild(descendant,rect,false,false);}},{key:"offsetRectBetweenParentAndChild",value:function offsetRectBetweenParentAndChild(descendant,rect,offsetFromChildToParent,clipToBounds){if(descendant == this){return;}var theParent=descendant.mParent;while(theParent != null && theParent instanceof view_3.View && theParent != this) {if(offsetFromChildToParent){rect.offset(descendant.mLeft - descendant.mScrollX,descendant.mTop - descendant.mScrollY);if(clipToBounds){var p=theParent;rect.intersect(0,0,p.mRight - p.mLeft,p.mBottom - p.mTop);}}else {if(clipToBounds){var p=theParent;rect.intersect(0,0,p.mRight - p.mLeft,p.mBottom - p.mTop);}rect.offset(descendant.mScrollX - descendant.mLeft,descendant.mScrollY - descendant.mTop);}descendant = theParent;theParent = descendant.mParent;}if(theParent == this){if(offsetFromChildToParent){rect.offset(descendant.mLeft - descendant.mScrollX,descendant.mTop - descendant.mScrollY);}else {rect.offset(descendant.mScrollX - descendant.mLeft,descendant.mScrollY - descendant.mTop);}}else {throw new Error("parameter must be a descendant of this view");}}},{key:"offsetChildrenTopAndBottom",value:function offsetChildrenTopAndBottom(offset){var count=this.mChildrenCount;var children=this.mChildren;for(var i=0;i < count;i++) {var v=children[i];v.mTop += offset;v.mBottom += offset;}this.invalidateViewProperty(false,false);}},{key:"suppressLayout",value:function suppressLayout(suppress){this.mSuppressLayout = suppress;if(!suppress){if(this.mLayoutCalledWhileSuppressed){this.requestLayout();this.mLayoutCalledWhileSuppressed = false;}}}},{key:"isLayoutSuppressed",value:function isLayoutSuppressed(){return this.mSuppressLayout;}},{key:"layout",value:function layout(l,t,r,b){if(!this.mSuppressLayout){_get(Object.getPrototypeOf(ViewGroup.prototype),"layout",this).call(this,l,t,r,b);}else {this.mLayoutCalledWhileSuppressed = true;}}},{key:"getChildVisibleRect",value:function getChildVisibleRect(child,r,offset){var rect=this.mAttachInfo != null?this.mAttachInfo.mTmpTransformRect:new Rect();rect.set(r);var dx=child.mLeft - this.mScrollX;var dy=child.mTop - this.mScrollY;rect.offset(dx,dy);if(offset != null){offset.x += dx;offset.y += dy;}if(rect.intersect(0,0,this.mRight - this.mLeft,this.mBottom - this.mTop)){if(this.mParent == null)return true;r.set(rect);return this.mParent.getChildVisibleRect(this,r,offset);}return false;}},{key:"dispatchDraw",value:function dispatchDraw(canvas){var count=this.mChildrenCount;var children=this.mChildren;var flags=this.mGroupFlags;var saveCount=0;var clipToPadding=(flags & ViewGroup.CLIP_TO_PADDING_MASK) == ViewGroup.CLIP_TO_PADDING_MASK;if(clipToPadding){saveCount = canvas.save();canvas.clipRect(this.mScrollX + this.mPaddingLeft,this.mScrollY + this.mPaddingTop,this.mScrollX + this.mRight - this.mLeft - this.mPaddingRight,this.mScrollY + this.mBottom - this.mTop - this.mPaddingBottom);}this.mPrivateFlags &= ~ViewGroup.PFLAG_DRAW_ANIMATION;this.mGroupFlags &= ~ViewGroup.FLAG_INVALIDATE_REQUIRED;var more=false;var drawingTime=this.getDrawingTime();var customOrder=this.isChildrenDrawingOrderEnabled();for(var i=0;i < count;i++) {var child=children[customOrder?this.getChildDrawingOrder(count,i):i];if((child.mViewFlags & view_3.View.VISIBILITY_MASK) == view_3.View.VISIBLE){more = more || this.drawChild(canvas,child,drawingTime);}}if(clipToPadding){canvas.restoreToCount(saveCount);}flags = this.mGroupFlags;if((flags & ViewGroup.FLAG_INVALIDATE_REQUIRED) == ViewGroup.FLAG_INVALIDATE_REQUIRED){this.invalidate(true);}}},{key:"drawChild",value:function drawChild(canvas,child,drawingTime){return child.drawFromParent(canvas,this,drawingTime);}},{key:"getClipChildren",value:function getClipChildren(){return (this.mGroupFlags & ViewGroup.FLAG_CLIP_CHILDREN) != 0;}},{key:"setClipChildren",value:function setClipChildren(clipChildren){var previousValue=(this.mGroupFlags & ViewGroup.FLAG_CLIP_CHILDREN) == ViewGroup.FLAG_CLIP_CHILDREN;if(clipChildren != previousValue){this.setBooleanFlag(ViewGroup.FLAG_CLIP_CHILDREN,clipChildren);}}},{key:"setClipToPadding",value:function setClipToPadding(clipToPadding){this.setBooleanFlag(ViewGroup.FLAG_CLIP_TO_PADDING,clipToPadding);}},{key:"invalidateChild",value:function invalidateChild(child,dirty){var parent=this;var attachInfo=this.mAttachInfo;if(attachInfo != null){var drawAnimation=(child.mPrivateFlags & view_3.View.PFLAG_DRAW_ANIMATION) == view_3.View.PFLAG_DRAW_ANIMATION;var childMatrix=child.getMatrix();var isOpaque=child.isOpaque() && !drawAnimation && child.getAnimation() == null && childMatrix.isIdentity();var opaqueFlag=isOpaque?view_3.View.PFLAG_DIRTY_OPAQUE:view_3.View.PFLAG_DIRTY;if(child.mLayerType != view_3.View.LAYER_TYPE_NONE){this.mPrivateFlags |= view_3.View.PFLAG_INVALIDATED;this.mPrivateFlags &= ~view_3.View.PFLAG_DRAWING_CACHE_VALID;}var _location=attachInfo.mInvalidateChildLocation;_location[0] = child.mLeft;_location[1] = child.mTop;do {var _view8=null;if(parent instanceof view_3.View){_view8 = parent;}if(_view8 != null){opaqueFlag = view_3.View.PFLAG_DIRTY;if((_view8.mPrivateFlags & view_3.View.PFLAG_DIRTY_MASK) != view_3.View.PFLAG_DIRTY){_view8.mPrivateFlags = _view8.mPrivateFlags & ~view_3.View.PFLAG_DIRTY_MASK | opaqueFlag;}}parent = parent.invalidateChildInParent(_location,dirty);if(_view8 != null){var m=_view8.getMatrix();if(!m.isIdentity()){var boundingRect=attachInfo.mTmpTransformRect;boundingRect.set(dirty);m.mapRect(boundingRect);dirty.set(boundingRect);}}}while(parent != null);}}},{key:"invalidateChildInParent",value:function invalidateChildInParent(location,dirty){if((this.mPrivateFlags & view_3.View.PFLAG_DRAWN) == view_3.View.PFLAG_DRAWN || (this.mPrivateFlags & view_3.View.PFLAG_DRAWING_CACHE_VALID) == view_3.View.PFLAG_DRAWING_CACHE_VALID){if((this.mGroupFlags & (ViewGroup.FLAG_OPTIMIZE_INVALIDATE | ViewGroup.FLAG_ANIMATION_DONE)) != ViewGroup.FLAG_OPTIMIZE_INVALIDATE){dirty.offset(location[0] - this.mScrollX,location[1] - this.mScrollY);if((this.mGroupFlags & ViewGroup.FLAG_CLIP_CHILDREN) == 0){dirty.union(0,0,this.mRight - this.mLeft,this.mBottom - this.mTop);}var left=this.mLeft;var _top9=this.mTop;if((this.mGroupFlags & ViewGroup.FLAG_CLIP_CHILDREN) == ViewGroup.FLAG_CLIP_CHILDREN){if(!dirty.intersect(0,0,this.mRight - left,this.mBottom - _top9)){dirty.setEmpty();}}this.mPrivateFlags &= ~view_3.View.PFLAG_DRAWING_CACHE_VALID;location[0] = left;location[1] = _top9;if(this.mLayerType != view_3.View.LAYER_TYPE_NONE){this.mPrivateFlags |= view_3.View.PFLAG_INVALIDATED;}return this.mParent;}else {this.mPrivateFlags &= ~view_3.View.PFLAG_DRAWN & ~view_3.View.PFLAG_DRAWING_CACHE_VALID;location[0] = this.mLeft;location[1] = this.mTop;if((this.mGroupFlags & ViewGroup.FLAG_CLIP_CHILDREN) == ViewGroup.FLAG_CLIP_CHILDREN){dirty.set(0,0,this.mRight - this.mLeft,this.mBottom - this.mTop);}else {dirty.union(0,0,this.mRight - this.mLeft,this.mBottom - this.mTop);}if(this.mLayerType != view_3.View.LAYER_TYPE_NONE){this.mPrivateFlags |= view_3.View.PFLAG_INVALIDATED;}return this.mParent;}}return null;}},{key:"invalidateChildFast",value:function invalidateChildFast(child,dirty){var parent=this;var attachInfo=this.mAttachInfo;if(attachInfo != null){var left=child.mLeft;var _top10=child.mTop;if(!child.getMatrix().isIdentity()){child.transformRect(dirty);}do {if(parent instanceof ViewGroup){var parentVG=parent;if(parentVG.mLayerType != view_3.View.LAYER_TYPE_NONE){parentVG.invalidate();parent = null;}else {parent = parentVG.invalidateChildInParentFast(left,_top10,dirty);left = parentVG.mLeft;_top10 = parentVG.mTop;}}else {var _location2=attachInfo.mInvalidateChildLocation;_location2[0] = left;_location2[1] = _top10;parent = parent.invalidateChildInParent(_location2,dirty);}}while(parent != null);}}},{key:"invalidateChildInParentFast",value:function invalidateChildInParentFast(left,top,dirty){if((this.mPrivateFlags & view_3.View.PFLAG_DRAWN) == view_3.View.PFLAG_DRAWN || (this.mPrivateFlags & view_3.View.PFLAG_DRAWING_CACHE_VALID) == view_3.View.PFLAG_DRAWING_CACHE_VALID){dirty.offset(left - this.mScrollX,top - this.mScrollY);if((this.mGroupFlags & ViewGroup.FLAG_CLIP_CHILDREN) == 0){dirty.union(0,0,this.mRight - this.mLeft,this.mBottom - this.mTop);}if((this.mGroupFlags & ViewGroup.FLAG_CLIP_CHILDREN) == 0 || dirty.intersect(0,0,this.mRight - this.mLeft,this.mBottom - this.mTop)){if(this.mLayerType != view_3.View.LAYER_TYPE_NONE){}if(!this.getMatrix().isIdentity()){this.transformRect(dirty);}return this.mParent;}}return null;}},{key:"requestTransparentRegion",value:function requestTransparentRegion(child){}},{key:"requestChildFocus",value:function requestChildFocus(child,focused){}},{key:"clearChildFocus",value:function clearChildFocus(child){}},{key:"focusSearch",value:function focusSearch(v,direction){return undefined;}},{key:"focusableViewAvailable",value:function focusableViewAvailable(v){}},{key:"childDrawableStateChanged",value:function childDrawableStateChanged(child){}},{key:"requestDisallowInterceptTouchEvent",value:function requestDisallowInterceptTouchEvent(disallowIntercept){if(disallowIntercept == ((this.mGroupFlags & ViewGroup.FLAG_DISALLOW_INTERCEPT) != 0)){return;}if(disallowIntercept){this.mGroupFlags |= ViewGroup.FLAG_DISALLOW_INTERCEPT;}else {this.mGroupFlags &= ~ViewGroup.FLAG_DISALLOW_INTERCEPT;}if(this.mParent != null){this.mParent.requestDisallowInterceptTouchEvent(disallowIntercept);}}},{key:"requestChildRectangleOnScreen",value:function requestChildRectangleOnScreen(child,rectangle,immediate){return undefined;}},{key:"childHasTransientStateChanged",value:function childHasTransientStateChanged(child,hasTransientState){}},{key:"shouldDelayChildPressedState",value:function shouldDelayChildPressedState(){return true;}},{key:"onSetLayoutParams",value:function onSetLayoutParams(child,layoutParams){}},{key:"mChildrenCount",get:function get(){return this.mChildren.length;}}],[{key:"resetCancelNextUpFlag",value:function resetCancelNextUpFlag(view){if((view.mPrivateFlags & view_3.View.PFLAG_CANCEL_NEXT_UP_EVENT) != 0){view.mPrivateFlags &= ~view_3.View.PFLAG_CANCEL_NEXT_UP_EVENT;return true;}return false;}},{key:"canViewReceivePointerEvents",value:function canViewReceivePointerEvents(child){return (child.mViewFlags & view_3.View.VISIBILITY_MASK) == view_3.View.VISIBLE;}},{key:"getChildMeasureSpec",value:function getChildMeasureSpec(spec,padding,childDimension){var MeasureSpec=view_3.View.MeasureSpec;var specMode=MeasureSpec.getMode(spec);var specSize=MeasureSpec.getSize(spec);var size=Math.max(0,specSize - padding);var resultSize=0;var resultMode=0;switch(specMode){case MeasureSpec.EXACTLY:if(childDimension >= 0){resultSize = childDimension;resultMode = MeasureSpec.EXACTLY;}else if(childDimension == ViewGroup.LayoutParams.MATCH_PARENT){resultSize = size;resultMode = MeasureSpec.EXACTLY;}else if(childDimension == ViewGroup.LayoutParams.WRAP_CONTENT){resultSize = size;resultMode = MeasureSpec.AT_MOST;}break;case MeasureSpec.AT_MOST:if(childDimension >= 0){resultSize = childDimension;resultMode = MeasureSpec.EXACTLY;}else if(childDimension == ViewGroup.LayoutParams.MATCH_PARENT){resultSize = size;resultMode = MeasureSpec.AT_MOST;}else if(childDimension == ViewGroup.LayoutParams.WRAP_CONTENT){resultSize = size;resultMode = MeasureSpec.AT_MOST;}break;case MeasureSpec.UNSPECIFIED:if(childDimension >= 0){resultSize = childDimension;resultMode = MeasureSpec.EXACTLY;}else if(childDimension == ViewGroup.LayoutParams.MATCH_PARENT){resultSize = 0;resultMode = MeasureSpec.UNSPECIFIED;}else if(childDimension == ViewGroup.LayoutParams.WRAP_CONTENT){resultSize = 0;resultMode = MeasureSpec.UNSPECIFIED;}break;}return MeasureSpec.makeMeasureSpec(resultSize,resultMode);}}]);return ViewGroup;})(view_3.View);ViewGroup.FLAG_CLIP_CHILDREN = 0x1;ViewGroup.FLAG_CLIP_TO_PADDING = 0x2;ViewGroup.FLAG_INVALIDATE_REQUIRED = 0x4;ViewGroup.FLAG_RUN_ANIMATION = 0x8;ViewGroup.FLAG_ANIMATION_DONE = 0x10;ViewGroup.FLAG_PADDING_NOT_NULL = 0x20;ViewGroup.FLAG_ANIMATION_CACHE = 0x40;ViewGroup.FLAG_OPTIMIZE_INVALIDATE = 0x80;ViewGroup.FLAG_CLEAR_TRANSFORMATION = 0x100;ViewGroup.FLAG_NOTIFY_ANIMATION_LISTENER = 0x200;ViewGroup.FLAG_USE_CHILD_DRAWING_ORDER = 0x400;ViewGroup.FLAG_SUPPORT_STATIC_TRANSFORMATIONS = 0x800;ViewGroup.FLAG_ALPHA_LOWER_THAN_ONE = 0x1000;ViewGroup.FLAG_ADD_STATES_FROM_CHILDREN = 0x2000;ViewGroup.FLAG_ALWAYS_DRAWN_WITH_CACHE = 0x4000;ViewGroup.FLAG_CHILDREN_DRAWN_WITH_CACHE = 0x8000;ViewGroup.FLAG_NOTIFY_CHILDREN_ON_DRAWABLE_STATE_CHANGE = 0x10000;ViewGroup.FLAG_MASK_FOCUSABILITY = 0x60000;ViewGroup.FOCUS_BEFORE_DESCENDANTS = 0x20000;ViewGroup.FOCUS_AFTER_DESCENDANTS = 0x40000;ViewGroup.FOCUS_BLOCK_DESCENDANTS = 0x60000;ViewGroup.FLAG_DISALLOW_INTERCEPT = 0x80000;ViewGroup.FLAG_SPLIT_MOTION_EVENTS = 0x200000;ViewGroup.FLAG_PREVENT_DISPATCH_ATTACHED_TO_WINDOW = 0x400000;ViewGroup.FLAG_LAYOUT_MODE_WAS_EXPLICITLY_SET = 0x800000;ViewGroup.LAYOUT_MODE_UNDEFINED = -1;ViewGroup.LAYOUT_MODE_CLIP_BOUNDS = 0;ViewGroup.LAYOUT_MODE_DEFAULT = ViewGroup.LAYOUT_MODE_CLIP_BOUNDS;ViewGroup.CLIP_TO_PADDING_MASK = ViewGroup.FLAG_CLIP_TO_PADDING | ViewGroup.FLAG_PADDING_NOT_NULL;view_3.ViewGroup = ViewGroup;(function(ViewGroup){var LayoutParams=(function(){function LayoutParams(){_classCallCheck(this,LayoutParams);this._width = 0;this._height = 0;this._attrChangeHandler = new view_3.View.AttrChangeHandler();for(var _len23=arguments.length,args=Array(_len23),_key23=0;_key23 < _len23;_key23++) {args[_key23] = arguments[_key23];}if(args.length === 1){var src=args[0];this._width = src._width;this._height = src._height;}else if(args.length === 2){var _args$015=args[0];var width=_args$015 === undefined?0:_args$015;var _args$115=args[1];var height=_args$115 === undefined?0:_args$115;this._width = width;this._height = height;}this._createAttrChangeHandler(this._attrChangeHandler);if(!this._attrChangeHandler.isCallSuper){throw Error('must call super when override createAttrChangeHandler!');}}_createClass(LayoutParams,[{key:"_createAttrChangeHandler",value:function _createAttrChangeHandler(mergeHandler){var params=this;mergeHandler.add(Object.defineProperties({},{width:{set:function set(value){params._width = value;},configurable:true,enumerable:true},height:{set:function set(value){params._height = value;},configurable:true,enumerable:true}}));mergeHandler.isCallSuper = true;}},{key:"width",get:function get(){if(typeof this._width === 'number')return this._width;var up=(this._width + "").toUpperCase();if(up === 'FILL_PARENT' || up === 'MATCH_PARENT')this._width = -1;else if(up === 'WRAP_CONTENT')this._width = -2;else {var parentWidth=view_3.View.MeasureSpec.getSize(this._measuringParentWidthMeasureSpec);this._width = TypedValue.complexToDimensionPixelSize(this._width,parentWidth,this._measuringMeasureSpec);}return this._width;},set:function set(value){this._width = value;}},{key:"height",get:function get(){if(typeof this._height === 'number')return this._height;var up=(this._height + "").toUpperCase();if(up === 'FILL_PARENT' || up === 'MATCH_PARENT')this._height = -1;else if(up === 'WRAP_CONTENT')this._height = -2;else {var parentHeight=view_3.View.MeasureSpec.getSize(this._measuringParentHeightMeasureSpec);this._height = TypedValue.complexToDimensionPixelSize(this._height,parentHeight,this._measuringMeasureSpec);}return this._height;},set:function set(value){this._height = value;}}]);return LayoutParams;})();LayoutParams.FILL_PARENT = -1;LayoutParams.MATCH_PARENT = -1;LayoutParams.WRAP_CONTENT = -2;ViewGroup.LayoutParams = LayoutParams;var MarginLayoutParams=(function(_LayoutParams){_inherits(MarginLayoutParams,_LayoutParams);function MarginLayoutParams(){_classCallCheck(this,MarginLayoutParams);_get(Object.getPrototypeOf(MarginLayoutParams.prototype),"constructor",this).call(this);this._leftMargin = 0;this._topMargin = 0;this._rightMargin = 0;this._bottomMargin = 0;for(var _len24=arguments.length,args=Array(_len24),_key24=0;_key24 < _len24;_key24++) {args[_key24] = arguments[_key24];}if(args.length === 1){var src=args[0];if(src instanceof MarginLayoutParams){_get(Object.getPrototypeOf(MarginLayoutParams.prototype),"constructor",this).call(this,src);this._leftMargin = src.leftMargin;this._topMargin = src.topMargin;this._rightMargin = src.rightMargin;this._bottomMargin = src.bottomMargin;}}else if(args.length == 2){_get(Object.getPrototypeOf(MarginLayoutParams.prototype),"constructor",this).call(this,args[0],args[1]);}}_createClass(MarginLayoutParams,[{key:"setMargins",value:function setMargins(left,top,right,bottom){this.leftMargin = left;this.topMargin = top;this.rightMargin = right;this.bottomMargin = bottom;}},{key:"_createAttrChangeHandler",value:function _createAttrChangeHandler(mergeHandler){_get(Object.getPrototypeOf(MarginLayoutParams.prototype),"_createAttrChangeHandler",this).call(this,mergeHandler);var params=this;mergeHandler.add(Object.defineProperties({},{marginLeft:{set:function set(value){params._leftMargin = value;},configurable:true,enumerable:true},marginTop:{set:function set(value){params._topMargin = value;},configurable:true,enumerable:true},marginRight:{set:function set(value){params._rightMargin = value;},configurable:true,enumerable:true},marginBottom:{set:function set(value){params._bottomMargin = value;},configurable:true,enumerable:true}}));}},{key:"leftMargin",get:function get(){if(typeof this._leftMargin === 'number')return this._leftMargin;var parentWidth=view_3.View.MeasureSpec.getSize(this._measuringParentWidthMeasureSpec);this._leftMargin = TypedValue.complexToDimensionPixelSize(this._leftMargin,parentWidth,this._measuringMeasureSpec);return this._leftMargin;},set:function set(value){this._leftMargin = value;}},{key:"topMargin",get:function get(){if(typeof this._topMargin === 'number')return this._topMargin;var parentWidth=view_3.View.MeasureSpec.getSize(this._measuringParentWidthMeasureSpec);this._topMargin = TypedValue.complexToDimensionPixelSize(this._topMargin,parentWidth,this._measuringMeasureSpec);return this._topMargin;},set:function set(value){this._topMargin = value;}},{key:"rightMargin",get:function get(){if(typeof this._rightMargin === 'number')return this._rightMargin;var parentWidth=view_3.View.MeasureSpec.getSize(this._measuringParentWidthMeasureSpec);this._rightMargin = TypedValue.complexToDimensionPixelSize(this._rightMargin,parentWidth,this._measuringMeasureSpec);return this._rightMargin;},set:function set(value){this._rightMargin = value;}},{key:"bottomMargin",get:function get(){if(typeof this._bottomMargin === 'number')return this._bottomMargin;var parentWidth=view_3.View.MeasureSpec.getSize(this._measuringParentWidthMeasureSpec);this._bottomMargin = TypedValue.complexToDimensionPixelSize(this._bottomMargin,parentWidth,this._measuringMeasureSpec);return this._bottomMargin;},set:function set(value){this._bottomMargin = value;}}]);return MarginLayoutParams;})(LayoutParams);ViewGroup.MarginLayoutParams = MarginLayoutParams;})(ViewGroup = view_3.ViewGroup || (view_3.ViewGroup = {}));var TouchTarget=(function(){function TouchTarget(){_classCallCheck(this,TouchTarget);}_createClass(TouchTarget,[{key:"recycle",value:function recycle(){if(TouchTarget.sRecycledCount < TouchTarget.MAX_RECYCLED){this.next = TouchTarget.sRecycleBin;TouchTarget.sRecycleBin = this;TouchTarget.sRecycledCount += 1;}else {this.next = null;}this.child = null;}}],[{key:"obtain",value:function obtain(child,pointerIdBits){var target=undefined;if(TouchTarget.sRecycleBin == null){target = new TouchTarget();}else {target = TouchTarget.sRecycleBin;TouchTarget.sRecycleBin = target.next;TouchTarget.sRecycledCount--;target.next = null;}target.child = child;target.pointerIdBits = pointerIdBits;return target;}}]);return TouchTarget;})();TouchTarget.MAX_RECYCLED = 32;TouchTarget.sRecycledCount = 0;TouchTarget.ALL_POINTER_IDS = -1;})(view = android.view || (android.view = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/10/6.
 */ ///<reference path="ViewGroup.ts"/>
///<reference path="ViewRootImpl.ts"/>
///<reference path="View.ts"/>
///<reference path="../graphics/drawable/Drawable.ts"/>
var android;(function(android){var view;(function(view){var Drawable=android.graphics.drawable.Drawable;var ViewOverlay=(function(){function ViewOverlay(hostView){_classCallCheck(this,ViewOverlay);this.mOverlayViewGroup = new ViewOverlay.OverlayViewGroup(hostView);}_createClass(ViewOverlay,[{key:"getOverlayView",value:function getOverlayView(){return this.mOverlayViewGroup;}},{key:"add",value:function add(drawable){this.mOverlayViewGroup.add(drawable);}},{key:"remove",value:function remove(drawable){}},{key:"clear",value:function clear(){this.mOverlayViewGroup.clear();}},{key:"isEmpty",value:function isEmpty(){return this.mOverlayViewGroup.isEmpty();}}]);return ViewOverlay;})();view.ViewOverlay = ViewOverlay;(function(ViewOverlay){var OverlayViewGroup=(function(_view$ViewGroup){_inherits(OverlayViewGroup,_view$ViewGroup);function OverlayViewGroup(hostView){_classCallCheck(this,OverlayViewGroup);_get(Object.getPrototypeOf(OverlayViewGroup.prototype),"constructor",this).call(this);this.mHostView = hostView;this.mAttachInfo = hostView.mAttachInfo;this.mRight = hostView.getWidth();this.mBottom = hostView.getHeight();}_createClass(OverlayViewGroup,[{key:"addDrawable",value:function addDrawable(drawable){}},{key:"addView",value:function addView(child){}},{key:"add",value:function add(arg){if(arg instanceof Drawable)this.addDrawable(arg);else if(arg instanceof view.View)this.addView(arg);}},{key:"clear",value:function clear(){}},{key:"isEmpty",value:function isEmpty(){return true;}}]);return OverlayViewGroup;})(view.ViewGroup);ViewOverlay.OverlayViewGroup = OverlayViewGroup;})(ViewOverlay = view.ViewOverlay || (view.ViewOverlay = {}));})(view = android.view || (android.view = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/10/9.
 */ ///<reference path="../view/Gravity.ts"/>
///<reference path="../view/View.ts"/>
///<reference path="../view/ViewGroup.ts"/>
///<reference path="../graphics/drawable/Drawable.ts"/>
///<reference path="../graphics/Rect.ts"/>
///<reference path="../graphics/Canvas.ts"/>
var android;(function(android){var widget;(function(widget){var Gravity=android.view.Gravity;var View=android.view.View;var ViewGroup=android.view.ViewGroup;var Rect=android.graphics.Rect;var FrameLayout=(function(_ViewGroup){_inherits(FrameLayout,_ViewGroup);function FrameLayout(){_classCallCheck(this,FrameLayout);for(var _len25=arguments.length,args=Array(_len25),_key25=0;_key25 < _len25;_key25++) {args[_key25] = arguments[_key25];}_get(Object.getPrototypeOf(FrameLayout.prototype),"constructor",this).apply(this,args);this.mMeasureAllChildren = false;this.mForegroundPaddingLeft = 0;this.mForegroundPaddingTop = 0;this.mForegroundPaddingRight = 0;this.mForegroundPaddingBottom = 0;this.mSelfBounds = new Rect();this.mOverlayBounds = new Rect();this.mForegroundGravity = Gravity.FILL;this.mForegroundInPadding = true;this.mForegroundBoundsChanged = false;this.mMatchParentChildren = new Array(1);}_createClass(FrameLayout,[{key:"createAttrChangeHandler",value:function createAttrChangeHandler(mergeHandler){_get(Object.getPrototypeOf(FrameLayout.prototype),"createAttrChangeHandler",this).call(this,mergeHandler);var frameLayout=this;mergeHandler.add(Object.defineProperties({},{foregroundGravity:{set:function set(value){frameLayout.mForegroundGravity = View.AttrChangeHandler.parseGravity(value,frameLayout.mForegroundGravity);},configurable:true,enumerable:true}}));}},{key:"getForegroundGravity",value:function getForegroundGravity(){return this.mForegroundGravity;}},{key:"setForegroundGravity",value:function setForegroundGravity(foregroundGravity){if(this.mForegroundGravity != foregroundGravity){if((foregroundGravity & Gravity.HORIZONTAL_GRAVITY_MASK) == 0){foregroundGravity |= Gravity.LEFT;}if((foregroundGravity & Gravity.VERTICAL_GRAVITY_MASK) == 0){foregroundGravity |= Gravity.TOP;}this.mForegroundGravity = foregroundGravity;if(this.mForegroundGravity == Gravity.FILL && this.mForeground != null){var padding=new Rect();if(this.mForeground.getPadding(padding)){this.mForegroundPaddingLeft = padding.left;this.mForegroundPaddingTop = padding.top;this.mForegroundPaddingRight = padding.right;this.mForegroundPaddingBottom = padding.bottom;}}else {this.mForegroundPaddingLeft = 0;this.mForegroundPaddingTop = 0;this.mForegroundPaddingRight = 0;this.mForegroundPaddingBottom = 0;}this.requestLayout();}}},{key:"verifyDrawable",value:function verifyDrawable(who){return _get(Object.getPrototypeOf(FrameLayout.prototype),"verifyDrawable",this).call(this,who) || who == this.mForeground;}},{key:"jumpDrawablesToCurrentState",value:function jumpDrawablesToCurrentState(){_get(Object.getPrototypeOf(FrameLayout.prototype),"jumpDrawablesToCurrentState",this).call(this);if(this.mForeground != null)this.mForeground.jumpToCurrentState();}},{key:"drawableStateChanged",value:function drawableStateChanged(){_get(Object.getPrototypeOf(FrameLayout.prototype),"drawableStateChanged",this).call(this);if(this.mForeground != null && this.mForeground.isStateful()){this.mForeground.setState(this.getDrawableState());}}},{key:"generateDefaultLayoutParams",value:function generateDefaultLayoutParams(){return new FrameLayout.LayoutParams(FrameLayout.LayoutParams.MATCH_PARENT,FrameLayout.LayoutParams.MATCH_PARENT);}},{key:"setForeground",value:function setForeground(drawable){}},{key:"getForeground",value:function getForeground(){return this.mForeground;}},{key:"getPaddingLeftWithForeground",value:function getPaddingLeftWithForeground(){return this.mForegroundInPadding?Math.max(this.mPaddingLeft,this.mForegroundPaddingLeft):this.mPaddingLeft + this.mForegroundPaddingLeft;}},{key:"getPaddingRightWithForeground",value:function getPaddingRightWithForeground(){return this.mForegroundInPadding?Math.max(this.mPaddingRight,this.mForegroundPaddingRight):this.mPaddingRight + this.mForegroundPaddingRight;}},{key:"getPaddingTopWithForeground",value:function getPaddingTopWithForeground(){return this.mForegroundInPadding?Math.max(this.mPaddingTop,this.mForegroundPaddingTop):this.mPaddingTop + this.mForegroundPaddingTop;}},{key:"getPaddingBottomWithForeground",value:function getPaddingBottomWithForeground(){return this.mForegroundInPadding?Math.max(this.mPaddingBottom,this.mForegroundPaddingBottom):this.mPaddingBottom + this.mForegroundPaddingBottom;}},{key:"onMeasure",value:function onMeasure(widthMeasureSpec,heightMeasureSpec){var count=this.getChildCount();var measureMatchParentChildren=View.MeasureSpec.getMode(widthMeasureSpec) != View.MeasureSpec.EXACTLY || View.MeasureSpec.getMode(heightMeasureSpec) != View.MeasureSpec.EXACTLY;this.mMatchParentChildren = [];var maxHeight=0;var maxWidth=0;var childState=0;for(var i=0;i < count;i++) {var child=this.getChildAt(i);if(this.mMeasureAllChildren || child.getVisibility() != View.GONE){this.measureChildWithMargins(child,widthMeasureSpec,0,heightMeasureSpec,0);var lp=child.getLayoutParams();maxWidth = Math.max(maxWidth,child.getMeasuredWidth() + lp.leftMargin + lp.rightMargin);maxHeight = Math.max(maxHeight,child.getMeasuredHeight() + lp.topMargin + lp.bottomMargin);childState = View.combineMeasuredStates(childState,child.getMeasuredState());if(measureMatchParentChildren){if(lp.width == FrameLayout.LayoutParams.MATCH_PARENT || lp.height == FrameLayout.LayoutParams.MATCH_PARENT){this.mMatchParentChildren.push(child);}}}}maxWidth += this.getPaddingLeftWithForeground() + this.getPaddingRightWithForeground();maxHeight += this.getPaddingTopWithForeground() + this.getPaddingBottomWithForeground();maxHeight = Math.max(maxHeight,this.getSuggestedMinimumHeight());maxWidth = Math.max(maxWidth,this.getSuggestedMinimumWidth());var drawable=this.getForeground();if(drawable != null){maxHeight = Math.max(maxHeight,drawable.getMinimumHeight());maxWidth = Math.max(maxWidth,drawable.getMinimumWidth());}this.setMeasuredDimension(View.resolveSizeAndState(maxWidth,widthMeasureSpec,childState),View.resolveSizeAndState(maxHeight,heightMeasureSpec,childState << View.MEASURED_HEIGHT_STATE_SHIFT));count = this.mMatchParentChildren.length;if(count > 1){for(var i=0;i < count;i++) {var child=this.mMatchParentChildren[i];var lp=child.getLayoutParams();var childWidthMeasureSpec=undefined;var childHeightMeasureSpec=undefined;if(lp.width == FrameLayout.LayoutParams.MATCH_PARENT){childWidthMeasureSpec = View.MeasureSpec.makeMeasureSpec(this.getMeasuredWidth() - this.getPaddingLeftWithForeground() - this.getPaddingRightWithForeground() - lp.leftMargin - lp.rightMargin,View.MeasureSpec.EXACTLY);}else {childWidthMeasureSpec = ViewGroup.getChildMeasureSpec(widthMeasureSpec,this.getPaddingLeftWithForeground() + this.getPaddingRightWithForeground() + lp.leftMargin + lp.rightMargin,lp.width);}if(lp.height == FrameLayout.LayoutParams.MATCH_PARENT){childHeightMeasureSpec = View.MeasureSpec.makeMeasureSpec(this.getMeasuredHeight() - this.getPaddingTopWithForeground() - this.getPaddingBottomWithForeground() - lp.topMargin - lp.bottomMargin,View.MeasureSpec.EXACTLY);}else {childHeightMeasureSpec = ViewGroup.getChildMeasureSpec(heightMeasureSpec,this.getPaddingTopWithForeground() + this.getPaddingBottomWithForeground() + lp.topMargin + lp.bottomMargin,lp.height);}child.measure(childWidthMeasureSpec,childHeightMeasureSpec);}}}},{key:"onLayout",value:function onLayout(changed,left,top,right,bottom){this.layoutChildren(left,top,right,bottom,false);}},{key:"layoutChildren",value:function layoutChildren(left,top,right,bottom,forceLeftGravity){var count=this.getChildCount();var parentLeft=this.getPaddingLeftWithForeground();var parentRight=right - left - this.getPaddingRightWithForeground();var parentTop=this.getPaddingTopWithForeground();var parentBottom=bottom - top - this.getPaddingBottomWithForeground();this.mForegroundBoundsChanged = true;for(var i=0;i < count;i++) {var child=this.getChildAt(i);if(child.getVisibility() != View.GONE){var lp=child.getLayoutParams();var width=child.getMeasuredWidth();var height=child.getMeasuredHeight();var childLeft=undefined;var childTop=undefined;var gravity=lp.gravity;if(gravity == -1){gravity = FrameLayout.DEFAULT_CHILD_GRAVITY;}var absoluteGravity=gravity;var verticalGravity=gravity & Gravity.VERTICAL_GRAVITY_MASK;switch(absoluteGravity & Gravity.HORIZONTAL_GRAVITY_MASK){case Gravity.CENTER_HORIZONTAL:childLeft = parentLeft + (parentRight - parentLeft - width) / 2 + lp.leftMargin - lp.rightMargin;break;case Gravity.RIGHT:if(!forceLeftGravity){childLeft = parentRight - width - lp.rightMargin;break;}case Gravity.LEFT:default:childLeft = parentLeft + lp.leftMargin;}switch(verticalGravity){case Gravity.TOP:childTop = parentTop + lp.topMargin;break;case Gravity.CENTER_VERTICAL:childTop = parentTop + (parentBottom - parentTop - height) / 2 + lp.topMargin - lp.bottomMargin;break;case Gravity.BOTTOM:childTop = parentBottom - height - lp.bottomMargin;break;default:childTop = parentTop + lp.topMargin;}child.layout(childLeft,childTop,childLeft + width,childTop + height);}}}},{key:"onSizeChanged",value:function onSizeChanged(w,h,oldw,oldh){_get(Object.getPrototypeOf(FrameLayout.prototype),"onSizeChanged",this).call(this,w,h,oldw,oldh);this.mForegroundBoundsChanged = true;}},{key:"draw",value:function draw(canvas){_get(Object.getPrototypeOf(FrameLayout.prototype),"draw",this).call(this,canvas);if(this.mForeground != null){var foreground=this.mForeground;if(this.mForegroundBoundsChanged){this.mForegroundBoundsChanged = false;var selfBounds=this.mSelfBounds;var overlayBounds=this.mOverlayBounds;var w=this.mRight - this.mLeft;var h=this.mBottom - this.mTop;if(this.mForegroundInPadding){selfBounds.set(0,0,w,h);}else {selfBounds.set(this.mPaddingLeft,this.mPaddingTop,w - this.mPaddingRight,h - this.mPaddingBottom);}Gravity.apply(this.mForegroundGravity,foreground.getIntrinsicWidth(),foreground.getIntrinsicHeight(),selfBounds,overlayBounds);foreground.setBounds(overlayBounds);}foreground.draw(canvas);}}},{key:"setMeasureAllChildren",value:function setMeasureAllChildren(measureAll){this.mMeasureAllChildren = measureAll;}},{key:"getMeasureAllChildren",value:function getMeasureAllChildren(){return this.mMeasureAllChildren;}},{key:"shouldDelayChildPressedState",value:function shouldDelayChildPressedState(){return false;}},{key:"checkLayoutParams",value:function checkLayoutParams(p){return p instanceof FrameLayout.LayoutParams;}},{key:"generateLayoutParams",value:function generateLayoutParams(p){return new FrameLayout.LayoutParams(p);}}]);return FrameLayout;})(ViewGroup);FrameLayout.DEFAULT_CHILD_GRAVITY = Gravity.TOP | Gravity.LEFT;widget.FrameLayout = FrameLayout;(function(FrameLayout){var LayoutParams=(function(_ViewGroup$MarginLayoutParams){_inherits(LayoutParams,_ViewGroup$MarginLayoutParams);function LayoutParams(){_classCallCheck(this,LayoutParams);_get(Object.getPrototypeOf(LayoutParams.prototype),"constructor",this).call(this);this.gravity = -1;for(var _len26=arguments.length,args=Array(_len26),_key26=0;_key26 < _len26;_key26++) {args[_key26] = arguments[_key26];}if(args.length === 1 && args[0] instanceof LayoutParams){_get(Object.getPrototypeOf(LayoutParams.prototype),"constructor",this).call(this,args[0]);this.gravity = args[0].gravity;}else {var width=args[0];var height=args[1];var _args$211=args[2];var gravity=_args$211 === undefined?-1:_args$211;_get(Object.getPrototypeOf(LayoutParams.prototype),"constructor",this).call(this,width,height);this.gravity = gravity;}}_createClass(LayoutParams,[{key:"_createAttrChangeHandler",value:function _createAttrChangeHandler(mergeHandler){_get(Object.getPrototypeOf(LayoutParams.prototype),"_createAttrChangeHandler",this).call(this,mergeHandler);var params=this;mergeHandler.add(Object.defineProperties({},{gravity:{set:function set(value){params.gravity = View.AttrChangeHandler.parseGravity(value,params.gravity);},configurable:true,enumerable:true}}));}}]);return LayoutParams;})(ViewGroup.MarginLayoutParams);FrameLayout.LayoutParams = LayoutParams;})(FrameLayout = widget.FrameLayout || (widget.FrameLayout = {}));})(widget = android.widget || (android.widget = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/10/23.
 */ ///<reference path="../android/view/View.ts"/>
///<reference path="../android/view/ViewGroup.ts"/>
///<reference path="../android/view/ViewRootImpl.ts"/>
///<reference path="../android/widget/FrameLayout.ts"/>
///<reference path="../android/view/MotionEvent.ts"/>
var runtime;(function(runtime){var View=android.view.View;var ViewGroup=android.view.ViewGroup;var ViewRootImpl=android.view.ViewRootImpl;var FrameLayout=android.widget.FrameLayout;var MotionEvent=android.view.MotionEvent;var AndroidUI=(function(){function AndroidUI(element){_classCallCheck(this,AndroidUI);this.element = element;if(element['AndroidUI']){throw Error('already init a AndroidUI with this element');}element['AndroidUI'] = this;this.init();}_createClass(AndroidUI,[{key:"init",value:function init(){this.viewRootImpl = new ViewRootImpl();this.viewRootImpl.mContext = this.element;this.rootLayout = new RootLayout();this.canvas = document.createElement("canvas");this.initInflateView();this.initRootElementStyle();this.initCanvasStyle();this.initBindElementStyle();this.element.innerHTML = '';this.element.appendChild(this.rootStyleElement);this.element.appendChild(this.canvas);this.element.appendChild(this.rootLayout.bindElement);this.viewRootImpl.setView(this.rootLayout);this.viewRootImpl.initSurface(this.canvas);this.initTouch();this.tryStartLayoutAfterInit();}},{key:"initInflateView",value:function initInflateView(){var _this10=this;Array.from(this.element.children).forEach(function(item){if(item.tagName === 'resources'){_this10.rootResourceElement = item;}else if(item instanceof HTMLStyleElement){_this10.rootStyleElement = item;}else if(item instanceof HTMLElement){var view=View.inflate(_this10.element,item);if(view)_this10.rootLayout.addView(view,-1,-1);}});}},{key:"initRootElementStyle",value:function initRootElementStyle(){if(!this.element.style.position){this.element.style.position = "relative";}if(!this.element.style.display || this.element.style.display == "none"){this.element.style.display = "inline-block";}this.element.style.overflow = 'hidden';}},{key:"initCanvasStyle",value:function initCanvasStyle(){var canvas=this.canvas;canvas.style.position = "absolute";canvas.style.left = '0px';canvas.style.top = '0px';}},{key:"initTouch",value:function initTouch(){var _this11=this;var motionEvent=undefined;var windowXOffset=0,windowYOffset=0;this.element.addEventListener('touchstart',function(e){e.preventDefault();e.stopPropagation();var rootViewBound=_this11.element.getBoundingClientRect();windowXOffset = rootViewBound.left;windowYOffset = rootViewBound.top;if(!motionEvent)motionEvent = MotionEvent.obtainWithTouchEvent(e,MotionEvent.ACTION_DOWN);else motionEvent.init(e,MotionEvent.ACTION_DOWN,windowXOffset,windowYOffset);_this11.rootLayout.dispatchTouchEvent(motionEvent);},true);this.element.addEventListener('touchmove',function(e){e.preventDefault();e.stopPropagation();motionEvent.init(e,MotionEvent.ACTION_MOVE,windowXOffset,windowYOffset);_this11.rootLayout.dispatchTouchEvent(motionEvent);},true);this.element.addEventListener('touchend',function(e){e.preventDefault();e.stopPropagation();motionEvent.init(e,MotionEvent.ACTION_UP);_this11.rootLayout.dispatchTouchEvent(motionEvent);},true);this.element.addEventListener('touchcancel',function(e){e.preventDefault();e.stopPropagation();motionEvent.init(e,MotionEvent.ACTION_CANCEL,windowXOffset,windowYOffset);_this11.rootLayout.dispatchTouchEvent(motionEvent);},true);}},{key:"initBindElementStyle",value:function initBindElementStyle(){if(!this.rootStyleElement)this.rootStyleElement = document.createElement("style");this.rootStyleElement.setAttribute("scoped",'');this.rootStyleElement.innerHTML += "\n                * {\n                    overflow : hidden;\n                }\n                ";var iOS=/iPad|iPhone|iPod/.test(navigator.platform);if(iOS){this.rootStyleElement.innerHTML += "\n                    android-ScrollView::-webkit-scrollbar {\n                        -webkit-appearance: none;\n                        width: 4px;\n                    }\n                    android-ScrollView::-webkit-scrollbar-thumb {\n                        border-radius: 2px;\n                        background-color: rgba(0,0,0,.3);\n                    }\n                ";}var density=android.content.res.Resources.getDisplayMetrics().density;if(density != 1){this.rootStyleElement.innerHTML += "\n                android-RootLayout {\n                    transform:scale(" + 1 / density + "," + 1 / density + ");\n                    -webkit-transform:scale(" + 1 / density + "," + 1 / density + ");\n                    transform-origin:0 0;\n                    -webkit-transform-origin:0 0;\n                }\n                ";}}},{key:"tryStartLayoutAfterInit",value:function tryStartLayoutAfterInit(){var width=this.element.offsetWidth;var height=this.element.offsetHeight;if(width > 0 && height > 0)this.notifySizeChange(width,height);}},{key:"notifySizeChange",value:function notifySizeChange(width,height){var density=android.content.res.Resources.getDisplayMetrics().density;this.viewRootImpl.mWinFrame.set(0,0,width * density,height * density);this.canvas.width = width * density;this.canvas.height = height * density;this.canvas.style.width = width + "px";this.canvas.style.height = height + "px";this.viewRootImpl.requestLayout();}},{key:"setContentView",value:function setContentView(view){this.rootLayout.removeAllViews();this.rootLayout.addView(view,-1,-1);}},{key:"addContentView",value:function addContentView(view){var params=arguments.length <= 1 || arguments[1] === undefined?new ViewGroup.LayoutParams(-1,-1):arguments[1];this.rootLayout.addView(view,params);}},{key:"findViewById",value:function findViewById(id){return this.rootLayout.findViewById(id);}}]);return AndroidUI;})();runtime.AndroidUI = AndroidUI;var RootLayout=(function(_FrameLayout){_inherits(RootLayout,_FrameLayout);function RootLayout(){_classCallCheck(this,RootLayout);_get(Object.getPrototypeOf(RootLayout.prototype),"constructor",this).apply(this,arguments);}return RootLayout;})(FrameLayout);})(runtime || (runtime = {})); /**
 * Created by linfaxin on 15/10/11.
 */ ///<reference path="../view/View.ts"/>
///<reference path="../view/ViewRootImpl.ts"/>
///<reference path="../widget/FrameLayout.ts"/>
///<reference path="../view/MotionEvent.ts"/>
///<reference path="../../runtime/AndroidUI.ts"/>
var android;(function(android){var app;(function(app){var AndroidUI=runtime.AndroidUI;if(typeof HTMLDivElement !== 'function'){var _HTMLDivElement=function _HTMLDivElement(){};_HTMLDivElement.prototype = HTMLDivElement.prototype;HTMLDivElement = _HTMLDivElement;}var Activity=(function(_HTMLDivElement2){_inherits(Activity,_HTMLDivElement2);function Activity(){_classCallCheck(this,Activity);_get(Object.getPrototypeOf(Activity.prototype),"constructor",this).apply(this,arguments);}_createClass(Activity,[{key:"onCreate",value:function onCreate(){}},{key:"createdCallback",value:function createdCallback(){this.AndroidUI = new AndroidUI(this);this.onCreate();}},{key:"attachedCallback",value:function attachedCallback(){this.AndroidUI.notifySizeChange(this.offsetWidth,this.offsetHeight);}},{key:"detachedCallback",value:function detachedCallback(){}},{key:"attributeChangedCallback",value:function attributeChangedCallback(attributeName,oldVal,newVal){}},{key:"setContentView",value:function setContentView(view){this.AndroidUI.setContentView(view);}},{key:"addContentView",value:function addContentView(view){this.AndroidUI.addContentView(view);}},{key:"findViewById",value:function findViewById(id){return this.AndroidUI.findViewById(id);}}],[{key:"registerCustomElement",value:function registerCustomElement(){document.registerElement("android-" + this.name,this);}}]);return Activity;})(HTMLDivElement);app.Activity = Activity;Activity.registerCustomElement();})(app = android.app || (android.app = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/10/17.
 */ ///<reference path="../view/ViewConfiguration.ts"/>
///<reference path="../view/animation/Interpolator.ts"/>
///<reference path="../content/res/Resources.ts"/>
///<reference path="../os/SystemClock.ts"/>
///<reference path="../util/Log.ts"/>
var android;(function(android){var widget;(function(widget){var ViewConfiguration=android.view.ViewConfiguration;var Resources=android.content.res.Resources;var SystemClock=android.os.SystemClock;var Log=android.util.Log;var OverScroller=(function(){function OverScroller(interpolator){var flywheel=arguments.length <= 1 || arguments[1] === undefined?true:arguments[1];_classCallCheck(this,OverScroller);this.mMode = 0;this.mFlywheel = true;this.mInterpolator = interpolator;this.mFlywheel = flywheel;this.mScrollerX = new SplineOverScroller();this.mScrollerY = new SplineOverScroller();}_createClass(OverScroller,[{key:"setFriction",value:function setFriction(friction){this.mScrollerX.setFriction(friction);this.mScrollerY.setFriction(friction);}},{key:"isFinished",value:function isFinished(){return this.mScrollerX.mFinished && this.mScrollerY.mFinished;}},{key:"forceFinished",value:function forceFinished(finished){this.mScrollerX.mFinished = this.mScrollerY.mFinished = finished;}},{key:"getCurrX",value:function getCurrX(){return this.mScrollerX.mCurrentPosition;}},{key:"getCurrY",value:function getCurrY(){return this.mScrollerY.mCurrentPosition;}},{key:"getCurrVelocity",value:function getCurrVelocity(){var squaredNorm=this.mScrollerX.mCurrVelocity * this.mScrollerX.mCurrVelocity;squaredNorm += this.mScrollerY.mCurrVelocity * this.mScrollerY.mCurrVelocity;return Math.sqrt(squaredNorm);}},{key:"getStartX",value:function getStartX(){return this.mScrollerX.mStart;}},{key:"getStartY",value:function getStartY(){return this.mScrollerY.mStart;}},{key:"getFinalX",value:function getFinalX(){return this.mScrollerX.mFinal;}},{key:"getFinalY",value:function getFinalY(){return this.mScrollerY.mFinal;}},{key:"computeScrollOffset",value:function computeScrollOffset(){if(this.isFinished()){return false;}switch(this.mMode){case OverScroller.SCROLL_MODE:var time=SystemClock.uptimeMillis();var elapsedTime=time - this.mScrollerX.mStartTime;var duration=this.mScrollerX.mDuration;if(elapsedTime < duration){var q=elapsedTime / duration;if(this.mInterpolator == null){q = Scroller_viscousFluid(q);}else {q = this.mInterpolator.getInterpolation(q);}this.mScrollerX.updateScroll(q);this.mScrollerY.updateScroll(q);}else {this.abortAnimation();}break;case OverScroller.FLING_MODE:if(!this.mScrollerX.mFinished){if(!this.mScrollerX.update()){if(!this.mScrollerX.continueWhenFinished()){this.mScrollerX.finish();}}}if(!this.mScrollerY.mFinished){if(!this.mScrollerY.update()){if(!this.mScrollerY.continueWhenFinished()){this.mScrollerY.finish();}}}break;}return true;}},{key:"startScroll",value:function startScroll(startX,startY,dx,dy){var duration=arguments.length <= 4 || arguments[4] === undefined?OverScroller.DEFAULT_DURATION:arguments[4];this.mMode = OverScroller.SCROLL_MODE;this.mScrollerX.startScroll(startX,dx,duration);this.mScrollerY.startScroll(startY,dy,duration);}},{key:"springBack",value:function springBack(startX,startY,minX,maxX,minY,maxY){this.mMode = OverScroller.FLING_MODE;var spingbackX=this.mScrollerX.springback(startX,minX,maxX);var spingbackY=this.mScrollerY.springback(startY,minY,maxY);return spingbackX || spingbackY;}},{key:"fling",value:function fling(startX,startY,velocityX,velocityY,minX,maxX,minY,maxY){var overX=arguments.length <= 8 || arguments[8] === undefined?0:arguments[8];var overY=arguments.length <= 9 || arguments[9] === undefined?0:arguments[9];if(this.mFlywheel && !this.isFinished()){var oldVelocityX=this.mScrollerX.mCurrVelocity;var oldVelocityY=this.mScrollerY.mCurrVelocity;if(Math_signum(velocityX) == Math_signum(oldVelocityX) && Math_signum(velocityY) == Math_signum(oldVelocityY)){velocityX += oldVelocityX;velocityY += oldVelocityY;}}this.mMode = OverScroller.FLING_MODE;this.mScrollerX.fling(startX,velocityX,minX,maxX,overX);this.mScrollerY.fling(startY,velocityY,minY,maxY,overY);}},{key:"notifyHorizontalEdgeReached",value:function notifyHorizontalEdgeReached(startX,finalX,overX){this.mScrollerX.notifyEdgeReached(startX,finalX,overX);}},{key:"notifyVerticalEdgeReached",value:function notifyVerticalEdgeReached(startY,finalY,overY){this.mScrollerY.notifyEdgeReached(startY,finalY,overY);}},{key:"isOverScrolled",value:function isOverScrolled(){return !this.mScrollerX.mFinished && this.mScrollerX.mState != SplineOverScroller.SPLINE || !this.mScrollerY.mFinished && this.mScrollerY.mState != SplineOverScroller.SPLINE;}},{key:"abortAnimation",value:function abortAnimation(){this.mScrollerX.finish();this.mScrollerY.finish();}},{key:"timePassed",value:function timePassed(){var time=SystemClock.uptimeMillis();var startTime=Math.min(this.mScrollerX.mStartTime,this.mScrollerY.mStartTime);return time - startTime;}},{key:"isScrollingInDirection",value:function isScrollingInDirection(xvel,yvel){var dx=this.mScrollerX.mFinal - this.mScrollerX.mStart;var dy=this.mScrollerY.mFinal - this.mScrollerY.mStart;return !this.isFinished() && Math_signum(xvel) == Math_signum(dx) && Math_signum(yvel) == Math_signum(dy);}}]);return OverScroller;})();OverScroller.DEFAULT_DURATION = 250;OverScroller.SCROLL_MODE = 0;OverScroller.FLING_MODE = 1;widget.OverScroller = OverScroller;var SplineOverScroller=(function(){function SplineOverScroller(){_classCallCheck(this,SplineOverScroller);this.mStart = 0;this.mCurrentPosition = 0;this.mFinal = 0;this.mVelocity = 0;this.mCurrVelocity = 0;this.mDeceleration = 0;this.mStartTime = 0;this.mDuration = 0;this.mSplineDuration = 0;this.mSplineDistance = 0;this.mFinished = false;this.mOver = 0;this.mFlingFriction = ViewConfiguration.getScrollFriction();this.mState = SplineOverScroller.SPLINE;this.mPhysicalCoeff = 0;this.mFinished = true;var ppi=Resources.getDisplayMetrics().density * 160;this.mPhysicalCoeff = 9.80665 * 39.37 * ppi * 0.84;}_createClass(SplineOverScroller,[{key:"setFriction",value:function setFriction(friction){this.mFlingFriction = friction;}},{key:"updateScroll",value:function updateScroll(q){this.mCurrentPosition = this.mStart + Math.round(q * (this.mFinal - this.mStart));}},{key:"adjustDuration",value:function adjustDuration(start,oldFinal,newFinal){var oldDistance=oldFinal - start;var newDistance=newFinal - start;var x=Math.abs(newDistance / oldDistance);var index=Number.parseInt(SplineOverScroller.NB_SAMPLES * x);if(index < SplineOverScroller.NB_SAMPLES){var x_inf=index / SplineOverScroller.NB_SAMPLES;var x_sup=(index + 1) / SplineOverScroller.NB_SAMPLES;var t_inf=SplineOverScroller.SPLINE_TIME[index];var t_sup=SplineOverScroller.SPLINE_TIME[index + 1];var timeCoef=t_inf + (x - x_inf) / (x_sup - x_inf) * (t_sup - t_inf);this.mDuration *= timeCoef;}}},{key:"startScroll",value:function startScroll(start,distance,duration){this.mFinished = false;this.mStart = start;this.mFinal = start + distance;this.mStartTime = SystemClock.uptimeMillis();this.mDuration = duration;this.mDeceleration = 0;this.mVelocity = 0;}},{key:"finish",value:function finish(){this.mCurrentPosition = this.mFinal;this.mFinished = true;}},{key:"setFinalPosition",value:function setFinalPosition(position){this.mFinal = position;this.mFinished = false;}},{key:"extendDuration",value:function extendDuration(extend){var time=SystemClock.uptimeMillis();var elapsedTime=time - this.mStartTime;this.mDuration = elapsedTime + extend;this.mFinished = false;}},{key:"springback",value:function springback(start,min,max){this.mFinished = true;this.mStart = this.mFinal = start;this.mVelocity = 0;this.mStartTime = SystemClock.uptimeMillis();this.mDuration = 0;if(start < min){this.startSpringback(start,min,0);}else if(start > max){this.startSpringback(start,max,0);}return !this.mFinished;}},{key:"startSpringback",value:function startSpringback(start,end,velocity){this.mFinished = false;this.mState = SplineOverScroller.CUBIC;this.mStart = start;this.mFinal = end;var delta=start - end;this.mDeceleration = SplineOverScroller.getDeceleration(delta);this.mVelocity = -delta;this.mOver = Math.abs(delta);this.mDuration = 1000.0 * Math.sqrt(-2.0 * delta / this.mDeceleration);}},{key:"fling",value:function fling(start,velocity,min,max,over){this.mOver = over;this.mFinished = false;this.mCurrVelocity = this.mVelocity = velocity;this.mDuration = this.mSplineDuration = 0;this.mStartTime = SystemClock.uptimeMillis();this.mCurrentPosition = this.mStart = start;if(start > max || start < min){this.startAfterEdge(start,min,max,velocity);return;}this.mState = SplineOverScroller.SPLINE;var totalDistance=0.0;if(velocity != 0){this.mDuration = this.mSplineDuration = this.getSplineFlingDuration(velocity);totalDistance = this.getSplineFlingDistance(velocity);}this.mSplineDistance = totalDistance * Math_signum(velocity);this.mFinal = start + this.mSplineDistance;if(this.mFinal < min){this.adjustDuration(this.mStart,this.mFinal,min);this.mFinal = min;}if(this.mFinal > max){this.adjustDuration(this.mStart,this.mFinal,max);this.mFinal = max;}}},{key:"getSplineDeceleration",value:function getSplineDeceleration(velocity){return Math.log(SplineOverScroller.INFLEXION * Math.abs(velocity) / (this.mFlingFriction * this.mPhysicalCoeff));}},{key:"getSplineFlingDistance",value:function getSplineFlingDistance(velocity){var l=this.getSplineDeceleration(velocity);var decelMinusOne=SplineOverScroller.DECELERATION_RATE - 1.0;return this.mFlingFriction * this.mPhysicalCoeff * Math.exp(SplineOverScroller.DECELERATION_RATE / decelMinusOne * l);}},{key:"getSplineFlingDuration",value:function getSplineFlingDuration(velocity){var l=this.getSplineDeceleration(velocity);var decelMinusOne=SplineOverScroller.DECELERATION_RATE - 1.0;return 1000.0 * Math.exp(l / decelMinusOne);}},{key:"fitOnBounceCurve",value:function fitOnBounceCurve(start,end,velocity){var durationToApex=-velocity / this.mDeceleration;var distanceToApex=velocity * velocity / 2.0 / Math.abs(this.mDeceleration);var distanceToEdge=Math.abs(end - start);var totalDuration=Math.sqrt(2.0 * (distanceToApex + distanceToEdge) / Math.abs(this.mDeceleration));this.mStartTime -= 1000 * (totalDuration - durationToApex);this.mStart = end;this.mVelocity = -this.mDeceleration * totalDuration;}},{key:"startBounceAfterEdge",value:function startBounceAfterEdge(start,end,velocity){this.mDeceleration = SplineOverScroller.getDeceleration(velocity == 0?start - end:velocity);this.fitOnBounceCurve(start,end,velocity);this.onEdgeReached();}},{key:"startAfterEdge",value:function startAfterEdge(start,min,max,velocity){if(start > min && start < max){Log.e("OverScroller","startAfterEdge called from a valid position");this.mFinished = true;return;}var positive=start > max;var edge=positive?max:min;var overDistance=start - edge;var keepIncreasing=overDistance * velocity >= 0;if(keepIncreasing){this.startBounceAfterEdge(start,edge,velocity);}else {var totalDistance=this.getSplineFlingDistance(velocity);if(totalDistance > Math.abs(overDistance)){this.fling(start,velocity,positive?min:start,positive?start:max,this.mOver);}else {this.startSpringback(start,edge,velocity);}}}},{key:"notifyEdgeReached",value:function notifyEdgeReached(start,end,over){if(this.mState == SplineOverScroller.SPLINE){this.mOver = over;this.mStartTime = SystemClock.uptimeMillis();this.startAfterEdge(start,end,end,this.mCurrVelocity);}}},{key:"onEdgeReached",value:function onEdgeReached(){var distance=this.mVelocity * this.mVelocity / (2 * Math.abs(this.mDeceleration));var sign=Math_signum(this.mVelocity);if(distance > this.mOver){this.mDeceleration = -sign * this.mVelocity * this.mVelocity / (2.0 * this.mOver);distance = this.mOver;}this.mOver = distance;this.mState = SplineOverScroller.BALLISTIC;this.mFinal = this.mStart + (this.mVelocity > 0?distance:-distance);this.mDuration = -(1000 * this.mVelocity / this.mDeceleration);}},{key:"continueWhenFinished",value:function continueWhenFinished(){switch(this.mState){case SplineOverScroller.SPLINE:if(this.mDuration < this.mSplineDuration){this.mStart = this.mFinal;this.mVelocity = this.mCurrVelocity;this.mDeceleration = SplineOverScroller.getDeceleration(this.mVelocity);this.mStartTime += this.mDuration;this.onEdgeReached();}else {return false;}break;case SplineOverScroller.BALLISTIC:this.mStartTime += this.mDuration;this.startSpringback(this.mFinal,this.mStart,0);break;case SplineOverScroller.CUBIC:return false;}this.update();return true;}},{key:"update",value:function update(){var time=SystemClock.uptimeMillis();var currentTime=time - this.mStartTime;if(currentTime > this.mDuration){return false;}var distance=0;switch(this.mState){case SplineOverScroller.SPLINE:{var t=currentTime / this.mSplineDuration;var index=Number.parseInt(SplineOverScroller.NB_SAMPLES * t);var distanceCoef=1;var velocityCoef=0;if(index < SplineOverScroller.NB_SAMPLES){var t_inf=index / SplineOverScroller.NB_SAMPLES;var t_sup=(index + 1) / SplineOverScroller.NB_SAMPLES;var d_inf=SplineOverScroller.SPLINE_POSITION[index];var d_sup=SplineOverScroller.SPLINE_POSITION[index + 1];velocityCoef = (d_sup - d_inf) / (t_sup - t_inf);distanceCoef = d_inf + (t - t_inf) * velocityCoef;}distance = distanceCoef * this.mSplineDistance;this.mCurrVelocity = velocityCoef * this.mSplineDistance / this.mSplineDuration * 1000;break;}case SplineOverScroller.BALLISTIC:{var t=currentTime / 1000;this.mCurrVelocity = this.mVelocity + this.mDeceleration * t;distance = this.mVelocity * t + this.mDeceleration * t * t / 2;break;}case SplineOverScroller.CUBIC:{var t=currentTime / this.mDuration;var t2=t * t;var sign=Math_signum(this.mVelocity);distance = sign * this.mOver * (3 * t2 - 2 * t * t2);this.mCurrVelocity = sign * this.mOver * 6 * (-t + t2);break;}}this.mCurrentPosition = this.mStart + Math.round(distance);return true;}}],[{key:"getDeceleration",value:function getDeceleration(velocity){return velocity > 0?-SplineOverScroller.GRAVITY:SplineOverScroller.GRAVITY;}}]);return SplineOverScroller;})();SplineOverScroller.DECELERATION_RATE = Math.log(0.78) / Math.log(0.9);SplineOverScroller.INFLEXION = 0.35;SplineOverScroller.START_TENSION = 0.5;SplineOverScroller.END_TENSION = 1.0;SplineOverScroller.P1 = SplineOverScroller.START_TENSION * SplineOverScroller.INFLEXION;SplineOverScroller.P2 = 1.0 - SplineOverScroller.END_TENSION * (1 - SplineOverScroller.INFLEXION);SplineOverScroller.NB_SAMPLES = 100;SplineOverScroller.SPLINE_POSITION = new Array(SplineOverScroller.NB_SAMPLES + 1);SplineOverScroller.SPLINE_TIME = new Array(SplineOverScroller.NB_SAMPLES + 1);SplineOverScroller.SPLINE = 0;SplineOverScroller.CUBIC = 1;SplineOverScroller.BALLISTIC = 2;SplineOverScroller.GRAVITY = 2000;SplineOverScroller._staticFunc = (function(){var x_min=0.0;var y_min=0.0;for(var i=0;i < SplineOverScroller.NB_SAMPLES;i++) {var alpha=i / SplineOverScroller.NB_SAMPLES;var x_max=1.0;var x=undefined,tx=undefined,coef=undefined;while(true) {x = x_min + (x_max - x_min) / 2.0;coef = 3.0 * x * (1.0 - x);tx = coef * ((1.0 - x) * SplineOverScroller.P1 + x * SplineOverScroller.P2) + x * x * x;if(Math.abs(tx - alpha) < 1E-5)break;if(tx > alpha)x_max = x;else x_min = x;}SplineOverScroller.SPLINE_POSITION[i] = coef * ((1.0 - x) * SplineOverScroller.START_TENSION + x) + x * x * x;var y_max=1.0;var y=undefined,dy=undefined;while(true) {y = y_min + (y_max - y_min) / 2.0;coef = 3.0 * y * (1.0 - y);dy = coef * ((1.0 - y) * SplineOverScroller.START_TENSION + y) + y * y * y;if(Math.abs(dy - alpha) < 1E-5)break;if(dy > alpha)y_max = y;else y_min = y;}SplineOverScroller.SPLINE_TIME[i] = coef * ((1.0 - y) * SplineOverScroller.P1 + y * SplineOverScroller.P2) + y * y * y;}SplineOverScroller.SPLINE_POSITION[SplineOverScroller.NB_SAMPLES] = SplineOverScroller.SPLINE_TIME[SplineOverScroller.NB_SAMPLES] = 1.0;})();function Math_signum(value){if(value === 0 || Number.isNaN(value))return value;return Math.abs(value) === value?1:-1;}var sViscousFluidScale=8;var sViscousFluidNormalize=1;function Scroller_viscousFluid(x){x *= sViscousFluidScale;if(x < 1){x -= 1 - Math.exp(-x);}else {var start=0.36787944117;x = 1 - Math.exp(1 - x);x = start + x * (1 - start);}x *= sViscousFluidNormalize;return x;}sViscousFluidNormalize = 1 / Scroller_viscousFluid(1);})(widget = android.widget || (android.widget = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/10/17.
 */ ///<reference path="../util/Log.ts"/>
///<reference path="../util/Pools.ts"/>
///<reference path="MotionEvent.ts"/>
var android;(function(android){var view;(function(view){var Log=android.util.Log;var Pools=android.util.Pools;var VelocityTracker=(function(){function VelocityTracker(){_classCallCheck(this,VelocityTracker);this.mLastTouchIndex = 0;this.mGeneration = 0;this.clear();}_createClass(VelocityTracker,[{key:"recycle",value:function recycle(){this.clear();VelocityTracker.sPool.release(this);}},{key:"setNextPoolable",value:function setNextPoolable(element){this.mNext = element;}},{key:"getNextPoolable",value:function getNextPoolable(){return this.mNext;}},{key:"clear",value:function clear(){VelocityTracker.releasePointerList(this.mPointerListHead);this.mPointerListHead = null;this.mLastTouchIndex = 0;}},{key:"addMovement",value:function addMovement(ev){var historySize=ev.getHistorySize();var pointerCount=ev.getPointerCount();var lastTouchIndex=this.mLastTouchIndex;var nextTouchIndex=(lastTouchIndex + 1) % VelocityTracker.NUM_PAST;var finalTouchIndex=(nextTouchIndex + historySize) % VelocityTracker.NUM_PAST;var generation=this.mGeneration++;this.mLastTouchIndex = finalTouchIndex;var previousPointer=null;for(var i=0;i < pointerCount;i++) {var pointerId=ev.getPointerId(i);var nextPointer=undefined;if(previousPointer == null || pointerId < previousPointer.id){previousPointer = null;nextPointer = this.mPointerListHead;}else {nextPointer = previousPointer.next;}var pointer=undefined;for(;;) {if(nextPointer != null){var nextPointerId=nextPointer.id;if(nextPointerId == pointerId){pointer = nextPointer;break;}if(nextPointerId < pointerId){nextPointer = nextPointer.next;continue;}}pointer = VelocityTracker.obtainPointer();pointer.id = pointerId;pointer.pastTime[lastTouchIndex] = Number.MIN_VALUE;pointer.next = nextPointer;if(previousPointer == null){this.mPointerListHead = pointer;}else {previousPointer.next = pointer;}break;}pointer.generation = generation;previousPointer = pointer;var pastX=pointer.pastX;var pastY=pointer.pastY;var pastTime=pointer.pastTime;historySize = ev.getHistorySize(pointerId);for(var j=0;j < historySize;j++) {var touchIndex=(nextTouchIndex + j) % VelocityTracker.NUM_PAST;pastX[touchIndex] = ev.getHistoricalX(i,j);pastY[touchIndex] = ev.getHistoricalY(i,j);pastTime[touchIndex] = ev.getHistoricalEventTime(i,j);}pastX[finalTouchIndex] = ev.getX(i);pastY[finalTouchIndex] = ev.getY(i);pastTime[finalTouchIndex] = ev.getEventTime();}previousPointer = null;for(var pointer=this.mPointerListHead;pointer != null;) {var nextPointer=pointer.next;if(pointer.generation != generation){if(previousPointer == null){this.mPointerListHead = nextPointer;}else {previousPointer.next = nextPointer;}VelocityTracker.releasePointer(pointer);}else {previousPointer = pointer;}pointer = nextPointer;}}},{key:"computeCurrentVelocity",value:function computeCurrentVelocity(units){var maxVelocity=arguments.length <= 1 || arguments[1] === undefined?Number.MAX_SAFE_INTEGER:arguments[1];var lastTouchIndex=this.mLastTouchIndex;for(var pointer=this.mPointerListHead;pointer != null;pointer = pointer.next) {var pastTime=pointer.pastTime;var oldestTouchIndex=lastTouchIndex;var numTouches=1;var minTime=pastTime[lastTouchIndex] - VelocityTracker.MAX_AGE_MILLISECONDS;while(numTouches < VelocityTracker.NUM_PAST) {var nextOldestTouchIndex=(oldestTouchIndex + VelocityTracker.NUM_PAST - 1) % VelocityTracker.NUM_PAST;var nextOldestTime=pastTime[nextOldestTouchIndex];if(nextOldestTime < minTime){break;}oldestTouchIndex = nextOldestTouchIndex;numTouches += 1;}if(numTouches > 3){numTouches -= 1;}var pastX=pointer.pastX;var pastY=pointer.pastY;var oldestX=pastX[oldestTouchIndex];var oldestY=pastY[oldestTouchIndex];var oldestTime=pastTime[oldestTouchIndex];var accumX=0;var accumY=0;for(var i=1;i < numTouches;i++) {var touchIndex=(oldestTouchIndex + i) % VelocityTracker.NUM_PAST;var duration=pastTime[touchIndex] - oldestTime;if(duration == 0)continue;var delta=pastX[touchIndex] - oldestX;var velocity=delta / duration * units;accumX = accumX == 0?velocity:(accumX + velocity) * .5;delta = pastY[touchIndex] - oldestY;velocity = delta / duration * units;accumY = accumY == 0?velocity:(accumY + velocity) * .5;}if(accumX < -maxVelocity){accumX = -maxVelocity;}else if(accumX > maxVelocity){accumX = maxVelocity;}if(accumY < -maxVelocity){accumY = -maxVelocity;}else if(accumY > maxVelocity){accumY = maxVelocity;}pointer.xVelocity = accumX;pointer.yVelocity = accumY;if(VelocityTracker.localLOGV){Log.v(VelocityTracker.TAG,"Pointer " + pointer.id + ": Y velocity=" + accumX + " X velocity=" + accumY + " N=" + numTouches);}}}},{key:"getXVelocity",value:function getXVelocity(){var id=arguments.length <= 0 || arguments[0] === undefined?0:arguments[0];var pointer=this.getPointer(id);return pointer != null?pointer.xVelocity:0;}},{key:"getYVelocity",value:function getYVelocity(){var id=arguments.length <= 0 || arguments[0] === undefined?0:arguments[0];var pointer=this.getPointer(id);return pointer != null?pointer.yVelocity:0;}},{key:"getPointer",value:function getPointer(id){for(var pointer=this.mPointerListHead;pointer != null;pointer = pointer.next) {if(pointer.id == id){return pointer;}}return null;}}],[{key:"obtain",value:function obtain(){var instance=VelocityTracker.sPool.acquire();return instance != null?instance:new VelocityTracker();}},{key:"obtainPointer",value:function obtainPointer(){if(VelocityTracker.sRecycledPointerCount != 0){var element=VelocityTracker.sRecycledPointerListHead;VelocityTracker.sRecycledPointerCount -= 1;VelocityTracker.sRecycledPointerListHead = element.next;element.next = null;return element;}return new Pointer();}},{key:"releasePointer",value:function releasePointer(pointer){if(VelocityTracker.sRecycledPointerCount < VelocityTracker.POINTER_POOL_CAPACITY){pointer.next = VelocityTracker.sRecycledPointerListHead;VelocityTracker.sRecycledPointerCount += 1;VelocityTracker.sRecycledPointerListHead = pointer;}}},{key:"releasePointerList",value:function releasePointerList(pointer){if(pointer != null){var count=VelocityTracker.sRecycledPointerCount;if(count >= VelocityTracker.POINTER_POOL_CAPACITY){return;}var tail=pointer;for(;;) {count += 1;if(count >= VelocityTracker.POINTER_POOL_CAPACITY){break;}var next=tail.next;if(next == null){break;}tail = next;}tail.next = VelocityTracker.sRecycledPointerListHead;VelocityTracker.sRecycledPointerCount = count;VelocityTracker.sRecycledPointerListHead = pointer;}}}]);return VelocityTracker;})();VelocityTracker.TAG = "VelocityTracker";VelocityTracker.DEBUG = Log.VelocityTracker_DBG;VelocityTracker.localLOGV = VelocityTracker.DEBUG;VelocityTracker.NUM_PAST = 10;VelocityTracker.MAX_AGE_MILLISECONDS = 200;VelocityTracker.POINTER_POOL_CAPACITY = 20;VelocityTracker.sPool = new Pools.SynchronizedPool(2);VelocityTracker.sRecycledPointerCount = 0;view.VelocityTracker = VelocityTracker;var Pointer=function Pointer(){_classCallCheck(this,Pointer);this.id = 0;this.xVelocity = 0;this.yVelocity = 0;this.pastX = new Array(VelocityTracker.NUM_PAST);this.pastY = new Array(VelocityTracker.NUM_PAST);this.pastTime = new Array(VelocityTracker.NUM_PAST);this.generation = 0;};})(view = android.view || (android.view = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/10/17.
 */ ///<reference path="../view/View.ts"/>
///<reference path="../view/ViewGroup.ts"/>
///<reference path="../view/MotionEvent.ts"/>
///<reference path="FrameLayout.ts"/>
///<reference path="OverScroller.ts"/>
///<reference path="../view/VelocityTracker.ts"/>
///<reference path="../view/ViewConfiguration.ts"/>
///<reference path="../util/Log.ts"/>
///<reference path="../os/SystemClock.ts"/>
///<reference path="../graphics/Rect.ts"/>
var android;(function(android){var widget;(function(widget){var View=android.view.View;var ViewGroup=android.view.ViewGroup;var MeasureSpec=View.MeasureSpec;var MotionEvent=android.view.MotionEvent;var VelocityTracker=android.view.VelocityTracker;var ViewConfiguration=android.view.ViewConfiguration;var Rect=android.graphics.Rect;var OverScroller=android.widget.OverScroller;var Log=android.util.Log;var SystemClock=android.os.SystemClock;var ScrollView=(function(_widget$FrameLayout){_inherits(ScrollView,_widget$FrameLayout);function ScrollView(){_classCallCheck(this,ScrollView);_get(Object.getPrototypeOf(ScrollView.prototype),"constructor",this).call(this);this.mLastScroll = 0;this.mTempRect = new Rect();this.mLastMotionY = 0;this.mIsLayoutDirty = true;this.mIsBeingDragged = false;this.mFillViewport = false;this.mSmoothScrollingEnabled = true;this.mMinimumVelocity = 0;this.mMaximumVelocity = 0;this.mOverscrollDistance = 0;this.mOverflingDistance = 0;this.mActivePointerId = ScrollView.INVALID_POINTER;this.initScrollView();}_createClass(ScrollView,[{key:"createAttrChangeHandler",value:function createAttrChangeHandler(mergeHandler){_get(Object.getPrototypeOf(ScrollView.prototype),"createAttrChangeHandler",this).call(this,mergeHandler);var scrollView=this;mergeHandler.add(Object.defineProperties({},{fillViewport:{set:function set(value){scrollView.setFillViewport(View.AttrChangeHandler.parseBoolean(value));},configurable:true,enumerable:true}}));}},{key:"shouldDelayChildPressedState",value:function shouldDelayChildPressedState(){return true;}},{key:"getMaxScrollAmount",value:function getMaxScrollAmount(){return ScrollView.MAX_SCROLL_FACTOR * (this.mBottom - this.mTop);}},{key:"initScrollView",value:function initScrollView(){this.mScroller = new OverScroller();this.setWillNotDraw(false);var configuration=ViewConfiguration.get();this.mTouchSlop = configuration.getScaledTouchSlop();this.mMinimumVelocity = configuration.getScaledMinimumFlingVelocity();this.mMaximumVelocity = configuration.getScaledMaximumFlingVelocity();this.mOverscrollDistance = configuration.getScaledOverscrollDistance();this.mOverflingDistance = configuration.getScaledOverflingDistance();this.setVerticalScrollBarEnabled(true);}},{key:"addView",value:function addView(){if(this.getChildCount() > 0){throw new Error("ScrollView can host only one direct child");}for(var _len27=arguments.length,args=Array(_len27),_key27=0;_key27 < _len27;_key27++) {args[_key27] = arguments[_key27];}return _get(Object.getPrototypeOf(ScrollView.prototype),"addView",this).apply(this,args);}},{key:"canScroll",value:function canScroll(){var child=this.getChildAt(0);if(child != null){var childHeight=child.getHeight();return this.getHeight() < childHeight + this.mPaddingTop + this.mPaddingBottom;}return false;}},{key:"isFillViewport",value:function isFillViewport(){return this.mFillViewport;}},{key:"setFillViewport",value:function setFillViewport(fillViewport){if(fillViewport != this.mFillViewport){this.mFillViewport = fillViewport;this.requestLayout();}}},{key:"isSmoothScrollingEnabled",value:function isSmoothScrollingEnabled(){return this.mSmoothScrollingEnabled;}},{key:"setSmoothScrollingEnabled",value:function setSmoothScrollingEnabled(smoothScrollingEnabled){this.mSmoothScrollingEnabled = smoothScrollingEnabled;}},{key:"onMeasure",value:function onMeasure(widthMeasureSpec,heightMeasureSpec){_get(Object.getPrototypeOf(ScrollView.prototype),"onMeasure",this).call(this,widthMeasureSpec,heightMeasureSpec);if(!this.mFillViewport){return;}var heightMode=MeasureSpec.getMode(heightMeasureSpec);if(heightMode == MeasureSpec.UNSPECIFIED){return;}if(this.getChildCount() > 0){var child=this.getChildAt(0);var height=this.getMeasuredHeight();if(child.getMeasuredHeight() < height){var lp=child.getLayoutParams();var childWidthMeasureSpec=widget.FrameLayout.getChildMeasureSpec(widthMeasureSpec,this.mPaddingLeft + this.mPaddingRight,lp.width);height -= this.mPaddingTop;height -= this.mPaddingBottom;var childHeightMeasureSpec=MeasureSpec.makeMeasureSpec(height,MeasureSpec.EXACTLY);child.measure(childWidthMeasureSpec,childHeightMeasureSpec);}}}},{key:"inChild",value:function inChild(x,y){if(this.getChildCount() > 0){var _scrollY5=this.mScrollY;var child=this.getChildAt(0);return !(y < child.getTop() - _scrollY5 || y >= child.getBottom() - _scrollY5 || x < child.getLeft() || x >= child.getRight());}return false;}},{key:"initOrResetVelocityTracker",value:function initOrResetVelocityTracker(){if(this.mVelocityTracker == null){this.mVelocityTracker = VelocityTracker.obtain();}else {this.mVelocityTracker.clear();}}},{key:"initVelocityTrackerIfNotExists",value:function initVelocityTrackerIfNotExists(){if(this.mVelocityTracker == null){this.mVelocityTracker = VelocityTracker.obtain();}}},{key:"recycleVelocityTracker",value:function recycleVelocityTracker(){if(this.mVelocityTracker != null){this.mVelocityTracker.recycle();this.mVelocityTracker = null;}}},{key:"requestDisallowInterceptTouchEvent",value:function requestDisallowInterceptTouchEvent(disallowIntercept){if(disallowIntercept){this.recycleVelocityTracker();}_get(Object.getPrototypeOf(ScrollView.prototype),"requestDisallowInterceptTouchEvent",this).call(this,disallowIntercept);}},{key:"onInterceptTouchEvent",value:function onInterceptTouchEvent(ev){ /*
                 * This method JUST determines whether we want to intercept the motion.
                 * If we return true, onMotionEvent will be called and we do the actual
                 * scrolling there.
                 */var action=ev.getAction();if(action == MotionEvent.ACTION_MOVE && this.mIsBeingDragged){return true;}if(this.getScrollY() == 0 && !this.canScrollVertically(1)){return false;}switch(action & MotionEvent.ACTION_MASK){case MotionEvent.ACTION_MOVE:{var activePointerId=this.mActivePointerId;if(activePointerId == ScrollView.INVALID_POINTER){break;}var pointerIndex=ev.findPointerIndex(activePointerId);if(pointerIndex == -1){Log.e(ScrollView.TAG,"Invalid pointerId=" + activePointerId + " in onInterceptTouchEvent");break;}var y=ev.getY(pointerIndex);var yDiff=Math.abs(y - this.mLastMotionY);if(yDiff > this.mTouchSlop){this.mIsBeingDragged = true;this.mLastMotionY = y;this.initVelocityTrackerIfNotExists();this.mVelocityTracker.addMovement(ev);var _parent3=this.getParent();if(_parent3 != null){_parent3.requestDisallowInterceptTouchEvent(true);}}break;}case MotionEvent.ACTION_DOWN:{var y=ev.getY();if(!this.inChild(ev.getX(),y)){this.mIsBeingDragged = false;this.recycleVelocityTracker();break;}this.mLastMotionY = y;this.mActivePointerId = ev.getPointerId(0);this.initOrResetVelocityTracker();this.mVelocityTracker.addMovement(ev);this.mIsBeingDragged = !this.mScroller.isFinished();break;}case MotionEvent.ACTION_CANCEL:case MotionEvent.ACTION_UP:this.mIsBeingDragged = false;this.mActivePointerId = ScrollView.INVALID_POINTER;this.recycleVelocityTracker();if(this.mScroller.springBack(this.mScrollX,this.mScrollY,0,0,0,this.getScrollRange())){this.postInvalidateOnAnimation();}break;case MotionEvent.ACTION_POINTER_UP:this.onSecondaryPointerUp(ev);break;}return this.mIsBeingDragged;}},{key:"onTouchEvent",value:function onTouchEvent(ev){this.initVelocityTrackerIfNotExists();this.mVelocityTracker.addMovement(ev);var action=ev.getAction();switch(action & MotionEvent.ACTION_MASK){case MotionEvent.ACTION_DOWN:{if(this.getChildCount() == 0){return false;}if(this.mIsBeingDragged = !this.mScroller.isFinished()){var _parent4=this.getParent();if(_parent4 != null){_parent4.requestDisallowInterceptTouchEvent(true);}}if(!this.mScroller.isFinished()){this.mScroller.abortAnimation();}this.mLastMotionY = ev.getY();this.mActivePointerId = ev.getPointerId(0);break;}case MotionEvent.ACTION_MOVE:var activePointerIndex=ev.findPointerIndex(this.mActivePointerId);if(activePointerIndex == -1){Log.e(ScrollView.TAG,"Invalid pointerId=" + this.mActivePointerId + " in onTouchEvent");break;}var y=ev.getY(activePointerIndex);var deltaY=this.mLastMotionY - y;if(!this.mIsBeingDragged && Math.abs(deltaY) > this.mTouchSlop){var _parent5=this.getParent();if(_parent5 != null){_parent5.requestDisallowInterceptTouchEvent(true);}this.mIsBeingDragged = true;if(deltaY > 0){deltaY -= this.mTouchSlop;}else {deltaY += this.mTouchSlop;}}if(this.mIsBeingDragged){this.mLastMotionY = y;var oldX=this.mScrollX;var oldY=this.mScrollY;var range=this.getScrollRange();var overscrollMode=this.getOverScrollMode();var canOverscroll=overscrollMode == ScrollView.OVER_SCROLL_ALWAYS || overscrollMode == ScrollView.OVER_SCROLL_IF_CONTENT_SCROLLS && range > 0;if(this.overScrollBy(0,deltaY,0,this.mScrollY,0,range,0,this.mOverscrollDistance,true)){this.mVelocityTracker.clear();}if(canOverscroll){var pulledToY=oldY + deltaY;if(pulledToY < 0){}else if(pulledToY > range){}}}break;case MotionEvent.ACTION_UP:if(this.mIsBeingDragged){var velocityTracker=this.mVelocityTracker;velocityTracker.computeCurrentVelocity(1000,this.mMaximumVelocity);var initialVelocity=velocityTracker.getYVelocity(this.mActivePointerId);if(this.getChildCount() > 0){if(Math.abs(initialVelocity) > this.mMinimumVelocity){this.fling(-initialVelocity);}else {if(this.mScroller.springBack(this.mScrollX,this.mScrollY,0,0,0,this.getScrollRange())){this.postInvalidateOnAnimation();}}}this.mActivePointerId = ScrollView.INVALID_POINTER;this.endDrag();}break;case MotionEvent.ACTION_CANCEL:if(this.mIsBeingDragged && this.getChildCount() > 0){if(this.mScroller.springBack(this.mScrollX,this.mScrollY,0,0,0,this.getScrollRange())){this.postInvalidateOnAnimation();}this.mActivePointerId = ScrollView.INVALID_POINTER;this.endDrag();}break;case MotionEvent.ACTION_POINTER_DOWN:{var index=ev.getActionIndex();this.mLastMotionY = ev.getY(index);this.mActivePointerId = ev.getPointerId(index);break;}case MotionEvent.ACTION_POINTER_UP:this.onSecondaryPointerUp(ev);this.mLastMotionY = ev.getY(ev.findPointerIndex(this.mActivePointerId));break;}return true;}},{key:"onSecondaryPointerUp",value:function onSecondaryPointerUp(ev){var pointerIndex=(ev.getAction() & MotionEvent.ACTION_POINTER_INDEX_MASK) >> MotionEvent.ACTION_POINTER_INDEX_SHIFT;var pointerId=ev.getPointerId(pointerIndex);if(pointerId == this.mActivePointerId){var newPointerIndex=pointerIndex == 0?1:0;this.mLastMotionY = ev.getY(newPointerIndex);this.mActivePointerId = ev.getPointerId(newPointerIndex);if(this.mVelocityTracker != null){this.mVelocityTracker.clear();}}}},{key:"onOverScrolled",value:function onOverScrolled(scrollX,scrollY,clampedX,clampedY){if(!this.mScroller.isFinished()){var oldX=this.mScrollX;var oldY=this.mScrollY;this.mScrollX = scrollX;this.mScrollY = scrollY;this.invalidateParentIfNeeded();this.onScrollChanged(this.mScrollX,this.mScrollY,oldX,oldY);if(clampedY || this.mScroller.getCurrVelocity() < this.mMinimumVelocity){this.mScroller.springBack(this.mScrollX,this.mScrollY,0,0,0,this.getScrollRange());}}else {_get(Object.getPrototypeOf(ScrollView.prototype),"scrollTo",this).call(this,scrollX,scrollY);}if(!this.awakenScrollBars()){this.postInvalidateOnAnimation();}}},{key:"getScrollRange",value:function getScrollRange(){var scrollRange=0;if(this.getChildCount() > 0){var child=this.getChildAt(0);scrollRange = Math.max(0,child.getHeight() - (this.getHeight() - this.mPaddingBottom - this.mPaddingTop));}return scrollRange;}},{key:"findFocusableViewInBounds",value:function findFocusableViewInBounds(topFocus,top,bottom){return null;}},{key:"pageScroll",value:function pageScroll(direction){var down=direction == View.FOCUS_DOWN;var height=this.getHeight();if(down){this.mTempRect.top = this.getScrollY() + height;var count=this.getChildCount();if(count > 0){var view=this.getChildAt(count - 1);if(this.mTempRect.top + height > view.getBottom()){this.mTempRect.top = view.getBottom() - height;}}}else {this.mTempRect.top = this.getScrollY() - height;if(this.mTempRect.top < 0){this.mTempRect.top = 0;}}this.mTempRect.bottom = this.mTempRect.top + height;return this.scrollAndFocus(direction,this.mTempRect.top,this.mTempRect.bottom);}},{key:"fullScroll",value:function fullScroll(direction){var down=direction == View.FOCUS_DOWN;var height=this.getHeight();this.mTempRect.top = 0;this.mTempRect.bottom = height;if(down){var count=this.getChildCount();if(count > 0){var view=this.getChildAt(count - 1);this.mTempRect.bottom = view.getBottom() + this.mPaddingBottom;this.mTempRect.top = this.mTempRect.bottom - height;}}return this.scrollAndFocus(direction,this.mTempRect.top,this.mTempRect.bottom);}},{key:"scrollAndFocus",value:function scrollAndFocus(direction,top,bottom){var handled=true;var height=this.getHeight();var containerTop=this.getScrollY();var containerBottom=containerTop + height;var up=direction == View.FOCUS_UP;var newFocused=this.findFocusableViewInBounds(up,top,bottom);if(newFocused == null){newFocused = this;}if(top >= containerTop && bottom <= containerBottom){handled = false;}else {var delta=up?top - containerTop:bottom - containerBottom;this.doScrollY(delta);}return handled;}},{key:"arrowScroll",value:function arrowScroll(direction){return false;}},{key:"isOffScreen",value:function isOffScreen(descendant){return !this.isWithinDeltaOfScreen(descendant,0,this.getHeight());}},{key:"isWithinDeltaOfScreen",value:function isWithinDeltaOfScreen(descendant,delta,height){descendant.getDrawingRect(this.mTempRect);this.offsetDescendantRectToMyCoords(descendant,this.mTempRect);return this.mTempRect.bottom + delta >= this.getScrollY() && this.mTempRect.top - delta <= this.getScrollY() + height;}},{key:"doScrollY",value:function doScrollY(delta){if(delta != 0){if(this.mSmoothScrollingEnabled){this.smoothScrollBy(0,delta);}else {this.scrollBy(0,delta);}}}},{key:"smoothScrollBy",value:function smoothScrollBy(dx,dy){if(this.getChildCount() == 0){return;}var duration=SystemClock.uptimeMillis() - this.mLastScroll;if(duration > ScrollView.ANIMATED_SCROLL_GAP){var height=this.getHeight() - this.mPaddingBottom - this.mPaddingTop;var bottom=this.getChildAt(0).getHeight();var maxY=Math.max(0,bottom - height);var _scrollY6=this.mScrollY;dy = Math.max(0,Math.min(_scrollY6 + dy,maxY)) - _scrollY6;this.mScroller.startScroll(this.mScrollX,_scrollY6,0,dy);this.postInvalidateOnAnimation();}else {if(!this.mScroller.isFinished()){this.mScroller.abortAnimation();}scrollBy(dx,dy);}this.mLastScroll = SystemClock.uptimeMillis();}},{key:"smoothScrollTo",value:function smoothScrollTo(x,y){this.smoothScrollBy(x - this.mScrollX,y - this.mScrollY);}},{key:"computeVerticalScrollRange",value:function computeVerticalScrollRange(){var count=this.getChildCount();var contentHeight=this.getHeight() - this.mPaddingBottom - this.mPaddingTop;if(count == 0){return contentHeight;}var scrollRange=this.getChildAt(0).getBottom();var scrollY=this.mScrollY;var overscrollBottom=Math.max(0,scrollRange - contentHeight);if(scrollY < 0){scrollRange -= scrollY;}else if(scrollY > overscrollBottom){scrollRange += scrollY - overscrollBottom;}return scrollRange;}},{key:"computeVerticalScrollOffset",value:function computeVerticalScrollOffset(){return Math.max(0,_get(Object.getPrototypeOf(ScrollView.prototype),"computeVerticalScrollOffset",this).call(this));}},{key:"measureChild",value:function measureChild(child,parentWidthMeasureSpec,parentHeightMeasureSpec){var lp=child.getLayoutParams();lp._measuringParentWidthMeasureSpec = parentWidthMeasureSpec;lp._measuringParentHeightMeasureSpec = parentHeightMeasureSpec;var childWidthMeasureSpec=undefined;var childHeightMeasureSpec=undefined;childWidthMeasureSpec = ViewGroup.getChildMeasureSpec(parentWidthMeasureSpec,this.mPaddingLeft + this.mPaddingRight,lp.width);childHeightMeasureSpec = MeasureSpec.makeMeasureSpec(0,MeasureSpec.UNSPECIFIED);child.measure(childWidthMeasureSpec,childHeightMeasureSpec);lp._measuringParentWidthMeasureSpec = null;lp._measuringParentHeightMeasureSpec = null;}},{key:"measureChildWithMargins",value:function measureChildWithMargins(child,parentWidthMeasureSpec,widthUsed,parentHeightMeasureSpec,heightUsed){var lp=child.getLayoutParams();lp._measuringParentWidthMeasureSpec = parentWidthMeasureSpec;lp._measuringParentHeightMeasureSpec = parentHeightMeasureSpec;var childWidthMeasureSpec=ScrollView.getChildMeasureSpec(parentWidthMeasureSpec,this.mPaddingLeft + this.mPaddingRight + lp.leftMargin + lp.rightMargin + widthUsed,lp.width);var childHeightMeasureSpec=MeasureSpec.makeMeasureSpec(lp.topMargin + lp.bottomMargin,MeasureSpec.UNSPECIFIED);child.measure(childWidthMeasureSpec,childHeightMeasureSpec);lp._measuringParentWidthMeasureSpec = null;lp._measuringParentHeightMeasureSpec = null;}},{key:"computeScroll",value:function computeScroll(){if(this.mScroller.computeScrollOffset()){var oldX=this.mScrollX;var oldY=this.mScrollY;var x=this.mScroller.getCurrX();var y=this.mScroller.getCurrY();if(oldX != x || oldY != y){var range=this.getScrollRange();var overscrollMode=this.getOverScrollMode();var canOverscroll=overscrollMode == ScrollView.OVER_SCROLL_ALWAYS || overscrollMode == ScrollView.OVER_SCROLL_IF_CONTENT_SCROLLS && range > 0;this.overScrollBy(x - oldX,y - oldY,oldX,oldY,0,range,0,this.mOverflingDistance,false);this.onScrollChanged(this.mScrollX,this.mScrollY,oldX,oldY);if(canOverscroll){if(y < 0 && oldY >= 0){}else if(y > range && oldY <= range){}}}if(!this.awakenScrollBars()){this.postInvalidateOnAnimation();}}else {}}},{key:"scrollToChild",value:function scrollToChild(child){child.getDrawingRect(this.mTempRect);this.offsetDescendantRectToMyCoords(child,this.mTempRect);var scrollDelta=this.computeScrollDeltaToGetChildRectOnScreen(this.mTempRect);if(scrollDelta != 0){this.scrollBy(0,scrollDelta);}}},{key:"scrollToChildRect",value:function scrollToChildRect(rect,immediate){var delta=this.computeScrollDeltaToGetChildRectOnScreen(rect);var scroll=delta != 0;if(scroll){if(immediate){this.scrollBy(0,delta);}else {this.smoothScrollBy(0,delta);}}return scroll;}},{key:"computeScrollDeltaToGetChildRectOnScreen",value:function computeScrollDeltaToGetChildRectOnScreen(rect){if(this.getChildCount() == 0)return 0;var height=this.getHeight();var screenTop=this.getScrollY();var screenBottom=screenTop + height;var fadingEdge=this.getVerticalFadingEdgeLength();if(rect.top > 0){screenTop += fadingEdge;}if(rect.bottom < this.getChildAt(0).getHeight()){screenBottom -= fadingEdge;}var scrollYDelta=0;if(rect.bottom > screenBottom && rect.top > screenTop){if(rect.height() > height){scrollYDelta += rect.top - screenTop;}else {scrollYDelta += rect.bottom - screenBottom;}var bottom=this.getChildAt(0).getBottom();var distanceToBottom=bottom - screenBottom;scrollYDelta = Math.min(scrollYDelta,distanceToBottom);}else if(rect.top < screenTop && rect.bottom < screenBottom){if(rect.height() > height){scrollYDelta -= screenBottom - rect.bottom;}else {scrollYDelta -= screenTop - rect.top;}scrollYDelta = Math.max(scrollYDelta,-this.getScrollY());}return scrollYDelta;}},{key:"requestChildFocus",value:function requestChildFocus(child,focused){if(!this.mIsLayoutDirty){this.scrollToChild(focused);}else {this.mChildToScrollTo = focused;}_get(Object.getPrototypeOf(ScrollView.prototype),"requestChildFocus",this).call(this,child,focused);}},{key:"onRequestFocusInDescendants",value:function onRequestFocusInDescendants(direction,previouslyFocusedRect){return false;}},{key:"requestChildRectangleOnScreen",value:function requestChildRectangleOnScreen(child,rectangle,immediate){rectangle.offset(child.getLeft() - child.getScrollX(),child.getTop() - child.getScrollY());return this.scrollToChildRect(rectangle,immediate);}},{key:"requestLayout",value:function requestLayout(){this.mIsLayoutDirty = true;_get(Object.getPrototypeOf(ScrollView.prototype),"requestLayout",this).call(this);}},{key:"onLayout",value:function onLayout(changed,l,t,r,b){_get(Object.getPrototypeOf(ScrollView.prototype),"onLayout",this).call(this,changed,l,t,r,b);this.mIsLayoutDirty = false;if(this.mChildToScrollTo != null && ScrollView.isViewDescendantOf(this.mChildToScrollTo,this)){this.scrollToChild(this.mChildToScrollTo);}this.mChildToScrollTo = null;if(!this.isLaidOut()){var childHeight=this.getChildCount() > 0?this.getChildAt(0).getMeasuredHeight():0;var scrollRange=Math.max(0,childHeight - (b - t - this.mPaddingBottom - this.mPaddingTop));if(this.mScrollY > scrollRange){this.mScrollY = scrollRange;}else if(this.mScrollY < 0){this.mScrollY = 0;}}scrollTo(this.mScrollX,this.mScrollY);}},{key:"onSizeChanged",value:function onSizeChanged(w,h,oldw,oldh){_get(Object.getPrototypeOf(ScrollView.prototype),"onSizeChanged",this).call(this,w,h,oldw,oldh);var currentFocused=this.findFocus();if(null == currentFocused || this == currentFocused)return;if(this.isWithinDeltaOfScreen(currentFocused,0,oldh)){currentFocused.getDrawingRect(this.mTempRect);this.offsetDescendantRectToMyCoords(currentFocused,this.mTempRect);var scrollDelta=this.computeScrollDeltaToGetChildRectOnScreen(this.mTempRect);this.doScrollY(scrollDelta);}}},{key:"fling",value:function fling(velocityY){if(this.getChildCount() > 0){var height=this.getHeight() - this.mPaddingBottom - this.mPaddingTop;var bottom=this.getChildAt(0).getHeight();this.mScroller.fling(this.mScrollX,this.mScrollY,0,velocityY,0,0,0,Math.max(0,bottom - height),0,height / 2);this.postInvalidateOnAnimation();}}},{key:"endDrag",value:function endDrag(){this.mIsBeingDragged = false;this.recycleVelocityTracker();}},{key:"scrollTo",value:function scrollTo(x,y){if(this.getChildCount() > 0){var child=this.getChildAt(0);x = ScrollView.clamp(x,this.getWidth() - this.mPaddingRight - this.mPaddingLeft,child.getWidth());y = ScrollView.clamp(y,this.getHeight() - this.mPaddingBottom - this.mPaddingTop,child.getHeight());if(x != this.mScrollX || y != this.mScrollY){_get(Object.getPrototypeOf(ScrollView.prototype),"scrollTo",this).call(this,x,y);}}}}],[{key:"isViewDescendantOf",value:function isViewDescendantOf(child,parent){if(child == parent){return true;}var theParent=child.getParent();return theParent instanceof ViewGroup && ScrollView.isViewDescendantOf(theParent,parent);}},{key:"clamp",value:function clamp(n,my,child){if(my >= child || n < 0){return 0;}if(my + n > child){return child - my;}return n;}}]);return ScrollView;})(widget.FrameLayout);ScrollView.ANIMATED_SCROLL_GAP = 250;ScrollView.MAX_SCROLL_FACTOR = 0.5;ScrollView.TAG = "ScrollView";ScrollView.INVALID_POINTER = -1;widget.ScrollView = ScrollView;})(widget = android.widget || (android.widget = {}));})(android || (android = {})); ///<reference path="../view/Gravity.ts"/>
///<reference path="../view/View.ts"/>
///<reference path="../view/ViewGroup.ts"/>
///<reference path="../graphics/drawable/Drawable.ts"/>
///<reference path="../graphics/Rect.ts"/>
var android;(function(android){var widget;(function(widget){var Gravity=android.view.Gravity;var View=android.view.View;var MeasureSpec=View.MeasureSpec;var ViewGroup=android.view.ViewGroup;var LinearLayout=(function(_ViewGroup2){_inherits(LinearLayout,_ViewGroup2);function LinearLayout(){_classCallCheck(this,LinearLayout);for(var _len28=arguments.length,args=Array(_len28),_key28=0;_key28 < _len28;_key28++) {args[_key28] = arguments[_key28];}_get(Object.getPrototypeOf(LinearLayout.prototype),"constructor",this).apply(this,args);this.mBaselineAligned = true;this.mBaselineAlignedChildIndex = -1;this.mBaselineChildTop = 0;this.mOrientation = 0;this.mGravity = Gravity.LEFT | Gravity.TOP;this.mTotalLength = 0;this.mWeightSum = -1;this.mUseLargestChild = false;this.mDividerWidth = 0;this.mDividerHeight = 0;this.mShowDividers = LinearLayout.SHOW_DIVIDER_NONE;this.mDividerPadding = 0;}_createClass(LinearLayout,[{key:"createAttrChangeHandler",value:function createAttrChangeHandler(mergeHandler){_get(Object.getPrototypeOf(LinearLayout.prototype),"createAttrChangeHandler",this).call(this,mergeHandler);var linearLayout=this;mergeHandler.add(Object.defineProperties({},{orientation:{set:function set(value){var isVertical=(value + "").toUpperCase() === 'VERTICAL';if(isVertical){linearLayout.setOrientation(LinearLayout.VERTICAL);return;}var isHorizontal=(value + "").toUpperCase() === 'HORIZONTAL';if(isHorizontal){linearLayout.setOrientation(LinearLayout.HORIZONTAL);}},configurable:true,enumerable:true},baselineAligned:{set:function set(value){if(!View.AttrChangeHandler.parseBoolean(value))linearLayout.setBaselineAligned(false);},configurable:true,enumerable:true},weightSum:{set:function set(value){var weightSum=Number.parseInt(value);if(Number.isSafeInteger(weightSum)){linearLayout.mWeightSum = weightSum;}},configurable:true,enumerable:true},baselineAlignedChildIndex:{set:function set(value){value = Number.parseInt(value);if(Number.isSafeInteger(value)){linearLayout.mBaselineAlignedChildIndex = value;}},configurable:true,enumerable:true},measureWithLargestChild:{set:function set(value){linearLayout.mUseLargestChild = View.AttrChangeHandler.parseBoolean(value,linearLayout.mUseLargestChild);},configurable:true,enumerable:true},divider:{set:function set(value){},configurable:true,enumerable:true},showDividers:{set:function set(value){var fieldName=('SHOW_DIVIDER_' + value).toUpperCase();if(Number.isInteger(LinearLayout[fieldName])){linearLayout.mShowDividers = LinearLayout[fieldName];}},configurable:true,enumerable:true},dividerPadding:{set:function set(value){value = Number.parseInt(value);if(Number.isInteger(value)){linearLayout.mDividerPadding = value;}},configurable:true,enumerable:true}}));}},{key:"setShowDividers",value:function setShowDividers(showDividers){if(showDividers != this.mShowDividers){this.requestLayout();}this.mShowDividers = showDividers;}},{key:"shouldDelayChildPressedState",value:function shouldDelayChildPressedState(){return false;}},{key:"getShowDividers",value:function getShowDividers(){return this.mShowDividers;}},{key:"getDividerDrawable",value:function getDividerDrawable(){return this.mDivider;}},{key:"setDividerDrawable",value:function setDividerDrawable(divider){if(divider == this.mDivider){return;}this.mDivider = divider;if(divider != null){this.mDividerWidth = divider.getIntrinsicWidth();this.mDividerHeight = divider.getIntrinsicHeight();}else {this.mDividerWidth = 0;this.mDividerHeight = 0;}this.setWillNotDraw(divider == null);this.requestLayout();}},{key:"setDividerPadding",value:function setDividerPadding(padding){this.mDividerPadding = padding;}},{key:"getDividerPadding",value:function getDividerPadding(){return this.mDividerPadding;}},{key:"getDividerWidth",value:function getDividerWidth(){return this.mDividerWidth;}},{key:"onDraw",value:function onDraw(canvas){if(this.mDivider == null){return;}if(this.mOrientation == LinearLayout.VERTICAL){this.drawDividersVertical(canvas);}else {this.drawDividersHorizontal(canvas);}}},{key:"drawDividersVertical",value:function drawDividersVertical(canvas){var count=this.getVirtualChildCount();for(var i=0;i < count;i++) {var child=this.getVirtualChildAt(i);if(child != null && child.getVisibility() != View.GONE){if(this.hasDividerBeforeChildAt(i)){var lp=child.getLayoutParams();var _top11=child.getTop() - lp.topMargin - this.mDividerHeight;this.drawHorizontalDivider(canvas,_top11);}}}if(this.hasDividerBeforeChildAt(count)){var child=this.getVirtualChildAt(count - 1);var bottom=0;if(child == null){bottom = this.getHeight() - this.getPaddingBottom() - this.mDividerHeight;}else {var lp=child.getLayoutParams();bottom = child.getBottom() + lp.bottomMargin;}this.drawHorizontalDivider(canvas,bottom);}}},{key:"drawDividersHorizontal",value:function drawDividersHorizontal(canvas){var count=this.getVirtualChildCount();var isLayoutRtl=this.isLayoutRtl();for(var i=0;i < count;i++) {var child=this.getVirtualChildAt(i);if(child != null && child.getVisibility() != View.GONE){if(this.hasDividerBeforeChildAt(i)){var lp=child.getLayoutParams();var position=undefined;if(isLayoutRtl){position = child.getRight() + lp.rightMargin;}else {position = child.getLeft() - lp.leftMargin - this.mDividerWidth;}this.drawVerticalDivider(canvas,position);}}}if(this.hasDividerBeforeChildAt(count)){var child=this.getVirtualChildAt(count - 1);var position=undefined;if(child == null){if(isLayoutRtl){position = this.getPaddingLeft();}else {position = this.getWidth() - this.getPaddingRight() - this.mDividerWidth;}}else {var lp=child.getLayoutParams();if(isLayoutRtl){position = child.getLeft() - lp.leftMargin - this.mDividerWidth;}else {position = child.getRight() + lp.rightMargin;}}this.drawVerticalDivider(canvas,position);}}},{key:"drawHorizontalDivider",value:function drawHorizontalDivider(canvas,top){this.mDivider.setBounds(this.getPaddingLeft() + this.mDividerPadding,top,this.getWidth() - this.getPaddingRight() - this.mDividerPadding,top + this.mDividerHeight);this.mDivider.draw(canvas);}},{key:"drawVerticalDivider",value:function drawVerticalDivider(canvas,left){this.mDivider.setBounds(left,this.getPaddingTop() + this.mDividerPadding,left + this.mDividerWidth,this.getHeight() - this.getPaddingBottom() - this.mDividerPadding);this.mDivider.draw(canvas);}},{key:"isBaselineAligned",value:function isBaselineAligned(){return this.mBaselineAligned;}},{key:"setBaselineAligned",value:function setBaselineAligned(baselineAligned){this.mBaselineAligned = baselineAligned;}},{key:"isMeasureWithLargestChildEnabled",value:function isMeasureWithLargestChildEnabled(){return this.mUseLargestChild;}},{key:"setMeasureWithLargestChildEnabled",value:function setMeasureWithLargestChildEnabled(enabled){this.mUseLargestChild = enabled;}},{key:"getBaseline",value:function getBaseline(){if(this.mBaselineAlignedChildIndex < 0){return _get(Object.getPrototypeOf(LinearLayout.prototype),"getBaseline",this).call(this);}if(this.getChildCount() <= this.mBaselineAlignedChildIndex){throw new Error("mBaselineAlignedChildIndex of LinearLayout " + "set to an index that is out of bounds.");}var child=this.getChildAt(this.mBaselineAlignedChildIndex);var childBaseline=child.getBaseline();if(childBaseline == -1){if(this.mBaselineAlignedChildIndex == 0){return -1;}throw new Error("mBaselineAlignedChildIndex of LinearLayout " + "points to a View that doesn't know how to get its baseline.");}var childTop=this.mBaselineChildTop;if(this.mOrientation == LinearLayout.VERTICAL){var majorGravity=this.mGravity & Gravity.VERTICAL_GRAVITY_MASK;if(majorGravity != Gravity.TOP){switch(majorGravity){case Gravity.BOTTOM:childTop = this.mBottom - this.mTop - this.mPaddingBottom - this.mTotalLength;break;case Gravity.CENTER_VERTICAL:childTop += (this.mBottom - this.mTop - this.mPaddingTop - this.mPaddingBottom - this.mTotalLength) / 2;break;}}}var lp=child.getLayoutParams();return childTop + lp.topMargin + childBaseline;}},{key:"getBaselineAlignedChildIndex",value:function getBaselineAlignedChildIndex(){return this.mBaselineAlignedChildIndex;}},{key:"setBaselineAlignedChildIndex",value:function setBaselineAlignedChildIndex(i){if(i < 0 || i >= this.getChildCount()){throw new Error("base aligned child index out " + "of range (0, " + this.getChildCount() + ")");}this.mBaselineAlignedChildIndex = i;}},{key:"getVirtualChildAt",value:function getVirtualChildAt(index){return this.getChildAt(index);}},{key:"getVirtualChildCount",value:function getVirtualChildCount(){return this.getChildCount();}},{key:"getWeightSum",value:function getWeightSum(){return this.mWeightSum;}},{key:"setWeightSum",value:function setWeightSum(weightSum){this.mWeightSum = Math.max(0,weightSum);}},{key:"onMeasure",value:function onMeasure(widthMeasureSpec,heightMeasureSpec){if(this.mOrientation == LinearLayout.VERTICAL){this.measureVertical(widthMeasureSpec,heightMeasureSpec);}else {this.measureHorizontal(widthMeasureSpec,heightMeasureSpec);}}},{key:"hasDividerBeforeChildAt",value:function hasDividerBeforeChildAt(childIndex){if(childIndex == 0){return (this.mShowDividers & LinearLayout.SHOW_DIVIDER_BEGINNING) != 0;}else if(childIndex == this.getChildCount()){return (this.mShowDividers & LinearLayout.SHOW_DIVIDER_END) != 0;}else if((this.mShowDividers & LinearLayout.SHOW_DIVIDER_MIDDLE) != 0){var hasVisibleViewBefore=false;for(var i=childIndex - 1;i >= 0;i--) {if(this.getChildAt(i).getVisibility() != LinearLayout.GONE){hasVisibleViewBefore = true;break;}}return hasVisibleViewBefore;}return false;}},{key:"measureVertical",value:function measureVertical(widthMeasureSpec,heightMeasureSpec){this.mTotalLength = 0;var maxWidth=0;var childState=0;var alternativeMaxWidth=0;var weightedMaxWidth=0;var allFillParent=true;var totalWeight=0;var count=this.getVirtualChildCount();var widthMode=MeasureSpec.getMode(widthMeasureSpec);var heightMode=MeasureSpec.getMode(heightMeasureSpec);var matchWidth=false;var baselineChildIndex=this.mBaselineAlignedChildIndex;var useLargestChild=this.mUseLargestChild;var largestChildHeight=Number.MIN_SAFE_INTEGER;for(var i=0;i < count;++i) {var child=this.getVirtualChildAt(i);if(child == null){this.mTotalLength += this.measureNullChild(i);continue;}if(child.getVisibility() == View.GONE){i += this.getChildrenSkipCount(child,i);continue;}if(this.hasDividerBeforeChildAt(i)){this.mTotalLength += this.mDividerHeight;}var lp=child.getLayoutParams();totalWeight += lp.weight;if(heightMode == MeasureSpec.EXACTLY && lp.height == 0 && lp.weight > 0){var totalLength=this.mTotalLength;this.mTotalLength = Math.max(totalLength,totalLength + lp.topMargin + lp.bottomMargin);}else {var oldHeight=Number.MIN_SAFE_INTEGER;if(lp.height == 0 && lp.weight > 0){oldHeight = 0;lp.height = LinearLayout.LayoutParams.WRAP_CONTENT;}this.measureChildBeforeLayout(child,i,widthMeasureSpec,0,heightMeasureSpec,totalWeight == 0?this.mTotalLength:0);if(oldHeight != Number.MIN_SAFE_INTEGER){lp.height = oldHeight;}var childHeight=child.getMeasuredHeight();var totalLength=this.mTotalLength;this.mTotalLength = Math.max(totalLength,totalLength + childHeight + lp.topMargin + lp.bottomMargin + this.getNextLocationOffset(child));if(useLargestChild){largestChildHeight = Math.max(childHeight,largestChildHeight);}}if(baselineChildIndex >= 0 && baselineChildIndex == i + 1){this.mBaselineChildTop = this.mTotalLength;}if(i < baselineChildIndex && lp.weight > 0){throw new Error("A child of LinearLayout with index " + "less than mBaselineAlignedChildIndex has weight > 0, which " + "won't work.  Either remove the weight, or don't set " + "mBaselineAlignedChildIndex.");}var matchWidthLocally=false;if(widthMode != MeasureSpec.EXACTLY && lp.width == LinearLayout.LayoutParams.MATCH_PARENT){matchWidth = true;matchWidthLocally = true;}var margin=lp.leftMargin + lp.rightMargin;var measuredWidth=child.getMeasuredWidth() + margin;maxWidth = Math.max(maxWidth,measuredWidth);childState = LinearLayout.combineMeasuredStates(childState,child.getMeasuredState());allFillParent = allFillParent && lp.width == LinearLayout.LayoutParams.MATCH_PARENT;if(lp.weight > 0){weightedMaxWidth = Math.max(weightedMaxWidth,matchWidthLocally?margin:measuredWidth);}else {alternativeMaxWidth = Math.max(alternativeMaxWidth,matchWidthLocally?margin:measuredWidth);}i += this.getChildrenSkipCount(child,i);}if(this.mTotalLength > 0 && this.hasDividerBeforeChildAt(count)){this.mTotalLength += this.mDividerHeight;}if(useLargestChild && (heightMode == MeasureSpec.AT_MOST || heightMode == MeasureSpec.UNSPECIFIED)){this.mTotalLength = 0;for(var i=0;i < count;++i) {var child=this.getVirtualChildAt(i);if(child == null){this.mTotalLength += this.measureNullChild(i);continue;}if(child.getVisibility() == View.GONE){i += this.getChildrenSkipCount(child,i);continue;}var lp=child.getLayoutParams();var totalLength=this.mTotalLength;this.mTotalLength = Math.max(totalLength,totalLength + largestChildHeight + lp.topMargin + lp.bottomMargin + this.getNextLocationOffset(child));}}this.mTotalLength += this.mPaddingTop + this.mPaddingBottom;var heightSize=this.mTotalLength;heightSize = Math.max(heightSize,this.getSuggestedMinimumHeight());var heightSizeAndState=LinearLayout.resolveSizeAndState(heightSize,heightMeasureSpec,0);heightSize = heightSizeAndState & View.MEASURED_SIZE_MASK;var delta=heightSize - this.mTotalLength;if(delta != 0 && totalWeight > 0){var weightSum=this.mWeightSum > 0?this.mWeightSum:totalWeight;this.mTotalLength = 0;for(var i=0;i < count;++i) {var child=this.getVirtualChildAt(i);if(child.getVisibility() == View.GONE){continue;}var lp=child.getLayoutParams();var childExtra=lp.weight;if(childExtra > 0){var share=childExtra * delta / weightSum;weightSum -= childExtra;delta -= share;var childWidthMeasureSpec=LinearLayout.getChildMeasureSpec(widthMeasureSpec,this.mPaddingLeft + this.mPaddingRight + lp.leftMargin + lp.rightMargin,lp.width);if(lp.height != 0 || heightMode != MeasureSpec.EXACTLY){var childHeight=child.getMeasuredHeight() + share;if(childHeight < 0){childHeight = 0;}child.measure(childWidthMeasureSpec,MeasureSpec.makeMeasureSpec(childHeight,MeasureSpec.EXACTLY));}else {child.measure(childWidthMeasureSpec,MeasureSpec.makeMeasureSpec(share > 0?share:0,MeasureSpec.EXACTLY));}childState = LinearLayout.combineMeasuredStates(childState,child.getMeasuredState() & View.MEASURED_STATE_MASK >> View.MEASURED_HEIGHT_STATE_SHIFT);}var margin=lp.leftMargin + lp.rightMargin;var measuredWidth=child.getMeasuredWidth() + margin;maxWidth = Math.max(maxWidth,measuredWidth);var matchWidthLocally=widthMode != MeasureSpec.EXACTLY && lp.width == LinearLayout.LayoutParams.MATCH_PARENT;alternativeMaxWidth = Math.max(alternativeMaxWidth,matchWidthLocally?margin:measuredWidth);allFillParent = allFillParent && lp.width == LinearLayout.LayoutParams.MATCH_PARENT;var totalLength=this.mTotalLength;this.mTotalLength = Math.max(totalLength,totalLength + child.getMeasuredHeight() + lp.topMargin + lp.bottomMargin + this.getNextLocationOffset(child));}this.mTotalLength += this.mPaddingTop + this.mPaddingBottom;}else {alternativeMaxWidth = Math.max(alternativeMaxWidth,weightedMaxWidth);if(useLargestChild && heightMode != MeasureSpec.EXACTLY){for(var i=0;i < count;i++) {var child=this.getVirtualChildAt(i);if(child == null || child.getVisibility() == View.GONE){continue;}var lp=child.getLayoutParams();var childExtra=lp.weight;if(childExtra > 0){child.measure(MeasureSpec.makeMeasureSpec(child.getMeasuredWidth(),MeasureSpec.EXACTLY),MeasureSpec.makeMeasureSpec(largestChildHeight,MeasureSpec.EXACTLY));}}}}if(!allFillParent && widthMode != MeasureSpec.EXACTLY){maxWidth = alternativeMaxWidth;}maxWidth += this.mPaddingLeft + this.mPaddingRight;maxWidth = Math.max(maxWidth,this.getSuggestedMinimumWidth());this.setMeasuredDimension(LinearLayout.resolveSizeAndState(maxWidth,widthMeasureSpec,childState),heightSizeAndState);if(matchWidth){this.forceUniformWidth(count,heightMeasureSpec);}}},{key:"forceUniformWidth",value:function forceUniformWidth(count,heightMeasureSpec){var uniformMeasureSpec=MeasureSpec.makeMeasureSpec(this.getMeasuredWidth(),MeasureSpec.EXACTLY);for(var i=0;i < count;++i) {var child=this.getVirtualChildAt(i);if(child.getVisibility() != View.GONE){var lp=child.getLayoutParams();if(lp.width == LinearLayout.LayoutParams.MATCH_PARENT){var oldHeight=lp.height;lp.height = child.getMeasuredHeight();this.measureChildWithMargins(child,uniformMeasureSpec,0,heightMeasureSpec,0);lp.height = oldHeight;}}}}},{key:"measureHorizontal",value:function measureHorizontal(widthMeasureSpec,heightMeasureSpec){this.mTotalLength = 0;var maxHeight=0;var childState=0;var alternativeMaxHeight=0;var weightedMaxHeight=0;var allFillParent=true;var totalWeight=0;var count=this.getVirtualChildCount();var widthMode=MeasureSpec.getMode(widthMeasureSpec);var heightMode=MeasureSpec.getMode(heightMeasureSpec);var matchHeight=false;if(this.mMaxAscent == null || this.mMaxDescent == null){this.mMaxAscent = new Array(LinearLayout.VERTICAL_GRAVITY_COUNT);this.mMaxDescent = new Array(LinearLayout.VERTICAL_GRAVITY_COUNT);}var maxAscent=this.mMaxAscent;var maxDescent=this.mMaxDescent;maxAscent[0] = maxAscent[1] = maxAscent[2] = maxAscent[3] = -1;maxDescent[0] = maxDescent[1] = maxDescent[2] = maxDescent[3] = -1;var baselineAligned=this.mBaselineAligned;var useLargestChild=this.mUseLargestChild;var isExactly=widthMode == MeasureSpec.EXACTLY;var largestChildWidth=Number.MAX_SAFE_INTEGER;for(var i=0;i < count;++i) {var child=this.getVirtualChildAt(i);if(child == null){this.mTotalLength += this.measureNullChild(i);continue;}if(child.getVisibility() == View.GONE){i += this.getChildrenSkipCount(child,i);continue;}if(this.hasDividerBeforeChildAt(i)){this.mTotalLength += this.mDividerWidth;}var lp=child.getLayoutParams();totalWeight += lp.weight;if(widthMode == MeasureSpec.EXACTLY && lp.width == 0 && lp.weight > 0){if(isExactly){this.mTotalLength += lp.leftMargin + lp.rightMargin;}else {var totalLength=this.mTotalLength;this.mTotalLength = Math.max(totalLength,totalLength + lp.leftMargin + lp.rightMargin);}if(baselineAligned){var freeSpec=MeasureSpec.makeMeasureSpec(0,MeasureSpec.UNSPECIFIED);child.measure(freeSpec,freeSpec);}}else {var oldWidth=Number.MIN_SAFE_INTEGER;if(lp.width == 0 && lp.weight > 0){oldWidth = 0;lp.width = LinearLayout.LayoutParams.WRAP_CONTENT;}this.measureChildBeforeLayout(child,i,widthMeasureSpec,totalWeight == 0?this.mTotalLength:0,heightMeasureSpec,0);if(oldWidth != Number.MIN_SAFE_INTEGER){lp.width = oldWidth;}var childWidth=child.getMeasuredWidth();if(isExactly){this.mTotalLength += childWidth + lp.leftMargin + lp.rightMargin + this.getNextLocationOffset(child);}else {var totalLength=this.mTotalLength;this.mTotalLength = Math.max(totalLength,totalLength + childWidth + lp.leftMargin + lp.rightMargin + this.getNextLocationOffset(child));}if(useLargestChild){largestChildWidth = Math.max(childWidth,largestChildWidth);}}var matchHeightLocally=false;if(heightMode != MeasureSpec.EXACTLY && lp.height == LinearLayout.LayoutParams.MATCH_PARENT){matchHeight = true;matchHeightLocally = true;}var margin=lp.topMargin + lp.bottomMargin;var childHeight=child.getMeasuredHeight() + margin;childState = LinearLayout.combineMeasuredStates(childState,child.getMeasuredState());if(baselineAligned){var childBaseline=child.getBaseline();if(childBaseline != -1){var gravity=(lp.gravity < 0?this.mGravity:lp.gravity) & Gravity.VERTICAL_GRAVITY_MASK;var index=(gravity >> Gravity.AXIS_Y_SHIFT & ~Gravity.AXIS_SPECIFIED) >> 1;maxAscent[index] = Math.max(maxAscent[index],childBaseline);maxDescent[index] = Math.max(maxDescent[index],childHeight - childBaseline);}}maxHeight = Math.max(maxHeight,childHeight);allFillParent = allFillParent && lp.height == LinearLayout.LayoutParams.MATCH_PARENT;if(lp.weight > 0){weightedMaxHeight = Math.max(weightedMaxHeight,matchHeightLocally?margin:childHeight);}else {alternativeMaxHeight = Math.max(alternativeMaxHeight,matchHeightLocally?margin:childHeight);}i += this.getChildrenSkipCount(child,i);}if(this.mTotalLength > 0 && this.hasDividerBeforeChildAt(count)){this.mTotalLength += this.mDividerWidth;}if(maxAscent[LinearLayout.INDEX_TOP] != -1 || maxAscent[LinearLayout.INDEX_CENTER_VERTICAL] != -1 || maxAscent[LinearLayout.INDEX_BOTTOM] != -1 || maxAscent[LinearLayout.INDEX_FILL] != -1){var ascent=Math.max(maxAscent[LinearLayout.INDEX_FILL],Math.max(maxAscent[LinearLayout.INDEX_CENTER_VERTICAL],Math.max(maxAscent[LinearLayout.INDEX_TOP],maxAscent[LinearLayout.INDEX_BOTTOM])));var descent=Math.max(maxDescent[LinearLayout.INDEX_FILL],Math.max(maxDescent[LinearLayout.INDEX_CENTER_VERTICAL],Math.max(maxDescent[LinearLayout.INDEX_TOP],maxDescent[LinearLayout.INDEX_BOTTOM])));maxHeight = Math.max(maxHeight,ascent + descent);}if(useLargestChild && (widthMode == MeasureSpec.AT_MOST || widthMode == MeasureSpec.UNSPECIFIED)){this.mTotalLength = 0;for(var i=0;i < count;++i) {var child=this.getVirtualChildAt(i);if(child == null){this.mTotalLength += this.measureNullChild(i);continue;}if(child.getVisibility() == View.GONE){i += this.getChildrenSkipCount(child,i);continue;}var lp=child.getLayoutParams();if(isExactly){this.mTotalLength += largestChildWidth + lp.leftMargin + lp.rightMargin + this.getNextLocationOffset(child);}else {var totalLength=this.mTotalLength;this.mTotalLength = Math.max(totalLength,totalLength + largestChildWidth + lp.leftMargin + lp.rightMargin + this.getNextLocationOffset(child));}}}this.mTotalLength += this.mPaddingLeft + this.mPaddingRight;var widthSize=this.mTotalLength;widthSize = Math.max(widthSize,this.getSuggestedMinimumWidth());var widthSizeAndState=LinearLayout.resolveSizeAndState(widthSize,widthMeasureSpec,0);widthSize = widthSizeAndState & View.MEASURED_SIZE_MASK;var delta=widthSize - this.mTotalLength;if(delta != 0 && totalWeight > 0){var weightSum=this.mWeightSum > 0?this.mWeightSum:totalWeight;maxAscent[0] = maxAscent[1] = maxAscent[2] = maxAscent[3] = -1;maxDescent[0] = maxDescent[1] = maxDescent[2] = maxDescent[3] = -1;maxHeight = -1;this.mTotalLength = 0;for(var i=0;i < count;++i) {var child=this.getVirtualChildAt(i);if(child == null || child.getVisibility() == View.GONE){continue;}var lp=child.getLayoutParams();var childExtra=lp.weight;if(childExtra > 0){var share=childExtra * delta / weightSum;weightSum -= childExtra;delta -= share;var childHeightMeasureSpec=LinearLayout.getChildMeasureSpec(heightMeasureSpec,this.mPaddingTop + this.mPaddingBottom + lp.topMargin + lp.bottomMargin,lp.height);if(lp.width != 0 || widthMode != MeasureSpec.EXACTLY){var childWidth=child.getMeasuredWidth() + share;if(childWidth < 0){childWidth = 0;}child.measure(MeasureSpec.makeMeasureSpec(childWidth,MeasureSpec.EXACTLY),childHeightMeasureSpec);}else {child.measure(MeasureSpec.makeMeasureSpec(share > 0?share:0,MeasureSpec.EXACTLY),childHeightMeasureSpec);}childState = LinearLayout.combineMeasuredStates(childState,child.getMeasuredState() & View.MEASURED_STATE_MASK);}if(isExactly){this.mTotalLength += child.getMeasuredWidth() + lp.leftMargin + lp.rightMargin + this.getNextLocationOffset(child);}else {var totalLength=this.mTotalLength;this.mTotalLength = Math.max(totalLength,totalLength + child.getMeasuredWidth() + lp.leftMargin + lp.rightMargin + this.getNextLocationOffset(child));}var matchHeightLocally=heightMode != MeasureSpec.EXACTLY && lp.height == LinearLayout.LayoutParams.MATCH_PARENT;var margin=lp.topMargin + lp.bottomMargin;var childHeight=child.getMeasuredHeight() + margin;maxHeight = Math.max(maxHeight,childHeight);alternativeMaxHeight = Math.max(alternativeMaxHeight,matchHeightLocally?margin:childHeight);allFillParent = allFillParent && lp.height == LinearLayout.LayoutParams.MATCH_PARENT;if(baselineAligned){var childBaseline=child.getBaseline();if(childBaseline != -1){var gravity=(lp.gravity < 0?this.mGravity:lp.gravity) & Gravity.VERTICAL_GRAVITY_MASK;var index=(gravity >> Gravity.AXIS_Y_SHIFT & ~Gravity.AXIS_SPECIFIED) >> 1;maxAscent[index] = Math.max(maxAscent[index],childBaseline);maxDescent[index] = Math.max(maxDescent[index],childHeight - childBaseline);}}}this.mTotalLength += this.mPaddingLeft + this.mPaddingRight;if(maxAscent[LinearLayout.INDEX_TOP] != -1 || maxAscent[LinearLayout.INDEX_CENTER_VERTICAL] != -1 || maxAscent[LinearLayout.INDEX_BOTTOM] != -1 || maxAscent[LinearLayout.INDEX_FILL] != -1){var ascent=Math.max(maxAscent[LinearLayout.INDEX_FILL],Math.max(maxAscent[LinearLayout.INDEX_CENTER_VERTICAL],Math.max(maxAscent[LinearLayout.INDEX_TOP],maxAscent[LinearLayout.INDEX_BOTTOM])));var descent=Math.max(maxDescent[LinearLayout.INDEX_FILL],Math.max(maxDescent[LinearLayout.INDEX_CENTER_VERTICAL],Math.max(maxDescent[LinearLayout.INDEX_TOP],maxDescent[LinearLayout.INDEX_BOTTOM])));maxHeight = Math.max(maxHeight,ascent + descent);}}else {alternativeMaxHeight = Math.max(alternativeMaxHeight,weightedMaxHeight);if(useLargestChild && widthMode != MeasureSpec.EXACTLY){for(var i=0;i < count;i++) {var child=this.getVirtualChildAt(i);if(child == null || child.getVisibility() == View.GONE){continue;}var lp=child.getLayoutParams();var childExtra=lp.weight;if(childExtra > 0){child.measure(MeasureSpec.makeMeasureSpec(largestChildWidth,MeasureSpec.EXACTLY),MeasureSpec.makeMeasureSpec(child.getMeasuredHeight(),MeasureSpec.EXACTLY));}}}}if(!allFillParent && heightMode != MeasureSpec.EXACTLY){maxHeight = alternativeMaxHeight;}maxHeight += this.mPaddingTop + this.mPaddingBottom;maxHeight = Math.max(maxHeight,this.getSuggestedMinimumHeight());this.setMeasuredDimension(widthSizeAndState | childState & View.MEASURED_STATE_MASK,LinearLayout.resolveSizeAndState(maxHeight,heightMeasureSpec,childState << View.MEASURED_HEIGHT_STATE_SHIFT));if(matchHeight){this.forceUniformHeight(count,widthMeasureSpec);}}},{key:"forceUniformHeight",value:function forceUniformHeight(count,widthMeasureSpec){var uniformMeasureSpec=MeasureSpec.makeMeasureSpec(this.getMeasuredHeight(),MeasureSpec.EXACTLY);for(var i=0;i < count;++i) {var child=this.getVirtualChildAt(i);if(child.getVisibility() != View.GONE){var lp=child.getLayoutParams();if(lp.height == LinearLayout.LayoutParams.MATCH_PARENT){var oldWidth=lp.width;lp.width = child.getMeasuredWidth();this.measureChildWithMargins(child,widthMeasureSpec,0,uniformMeasureSpec,0);lp.width = oldWidth;}}}}},{key:"getChildrenSkipCount",value:function getChildrenSkipCount(child,index){return 0;}},{key:"measureNullChild",value:function measureNullChild(childIndex){return 0;}},{key:"measureChildBeforeLayout",value:function measureChildBeforeLayout(child,childIndex,widthMeasureSpec,totalWidth,heightMeasureSpec,totalHeight){this.measureChildWithMargins(child,widthMeasureSpec,totalWidth,heightMeasureSpec,totalHeight);}},{key:"getLocationOffset",value:function getLocationOffset(child){return 0;}},{key:"getNextLocationOffset",value:function getNextLocationOffset(child){return 0;}},{key:"onLayout",value:function onLayout(changed,l,t,r,b){if(this.mOrientation == LinearLayout.VERTICAL){this.layoutVertical(l,t,r,b);}else {this.layoutHorizontal(l,t,r,b);}}},{key:"layoutVertical",value:function layoutVertical(left,top,right,bottom){var paddingLeft=this.mPaddingLeft;var childTop=undefined;var childLeft=undefined;var width=right - left;var childRight=width - this.mPaddingRight;var childSpace=width - paddingLeft - this.mPaddingRight;var count=this.getVirtualChildCount();var majorGravity=this.mGravity & Gravity.VERTICAL_GRAVITY_MASK;var minorGravity=this.mGravity & Gravity.HORIZONTAL_GRAVITY_MASK;switch(majorGravity){case Gravity.BOTTOM:childTop = this.mPaddingTop + bottom - top - this.mTotalLength;break;case Gravity.CENTER_VERTICAL:childTop = this.mPaddingTop + (bottom - top - this.mTotalLength) / 2;break;case Gravity.TOP:default:childTop = this.mPaddingTop;break;}for(var i=0;i < count;i++) {var child=this.getVirtualChildAt(i);if(child == null){childTop += this.measureNullChild(i);}else if(child.getVisibility() != View.GONE){var childWidth=child.getMeasuredWidth();var childHeight=child.getMeasuredHeight();var lp=child.getLayoutParams();var gravity=lp.gravity;if(gravity < 0){gravity = minorGravity;}var absoluteGravity=gravity;switch(absoluteGravity & Gravity.HORIZONTAL_GRAVITY_MASK){case Gravity.CENTER_HORIZONTAL:childLeft = paddingLeft + (childSpace - childWidth) / 2 + lp.leftMargin - lp.rightMargin;break;case Gravity.RIGHT:childLeft = childRight - childWidth - lp.rightMargin;break;case Gravity.LEFT:default:childLeft = paddingLeft + lp.leftMargin;break;}if(this.hasDividerBeforeChildAt(i)){childTop += this.mDividerHeight;}childTop += lp.topMargin;this.setChildFrame(child,childLeft,childTop + this.getLocationOffset(child),childWidth,childHeight);childTop += childHeight + lp.bottomMargin + this.getNextLocationOffset(child);i += this.getChildrenSkipCount(child,i);}}}},{key:"layoutHorizontal",value:function layoutHorizontal(left,top,right,bottom){var isLayoutRtl=this.isLayoutRtl();var paddingTop=this.mPaddingTop;var childTop=undefined;var childLeft=undefined;var height=bottom - top;var childBottom=height - this.mPaddingBottom;var childSpace=height - paddingTop - this.mPaddingBottom;var count=this.getVirtualChildCount();var majorGravity=this.mGravity & Gravity.HORIZONTAL_GRAVITY_MASK;var minorGravity=this.mGravity & Gravity.VERTICAL_GRAVITY_MASK;var baselineAligned=this.mBaselineAligned;var maxAscent=this.mMaxAscent;var maxDescent=this.mMaxDescent;var absoluteGravity=majorGravity;switch(absoluteGravity){case Gravity.RIGHT:childLeft = this.mPaddingLeft + right - left - this.mTotalLength;break;case Gravity.CENTER_HORIZONTAL:childLeft = this.mPaddingLeft + (right - left - this.mTotalLength) / 2;break;case Gravity.LEFT:default:childLeft = this.mPaddingLeft;break;}var start=0;var dir=1;if(isLayoutRtl){start = count - 1;dir = -1;}for(var i=0;i < count;i++) {var childIndex=start + dir * i;var child=this.getVirtualChildAt(childIndex);if(child == null){childLeft += this.measureNullChild(childIndex);}else if(child.getVisibility() != View.GONE){var childWidth=child.getMeasuredWidth();var childHeight=child.getMeasuredHeight();var childBaseline=-1;var lp=child.getLayoutParams();if(baselineAligned && lp.height != LinearLayout.LayoutParams.MATCH_PARENT){childBaseline = child.getBaseline();}var gravity=lp.gravity;if(gravity < 0){gravity = minorGravity;}switch(gravity & Gravity.VERTICAL_GRAVITY_MASK){case Gravity.TOP:childTop = paddingTop + lp.topMargin;if(childBaseline != -1){childTop += maxAscent[LinearLayout.INDEX_TOP] - childBaseline;}break;case Gravity.CENTER_VERTICAL:childTop = paddingTop + (childSpace - childHeight) / 2 + lp.topMargin - lp.bottomMargin;break;case Gravity.BOTTOM:childTop = childBottom - childHeight - lp.bottomMargin;if(childBaseline != -1){var descent=child.getMeasuredHeight() - childBaseline;childTop -= maxDescent[LinearLayout.INDEX_BOTTOM] - descent;}break;default:childTop = paddingTop;break;}if(this.hasDividerBeforeChildAt(childIndex)){childLeft += this.mDividerWidth;}childLeft += lp.leftMargin;this.setChildFrame(child,childLeft + this.getLocationOffset(child),childTop,childWidth,childHeight);childLeft += childWidth + lp.rightMargin + this.getNextLocationOffset(child);i += this.getChildrenSkipCount(child,childIndex);}}}},{key:"setChildFrame",value:function setChildFrame(child,left,top,width,height){child.layout(left,top,left + width,top + height);}},{key:"setOrientation",value:function setOrientation(orientation){if(typeof orientation === 'string'){if('VERTICAL' === (orientation + '').toUpperCase())orientation = LinearLayout.VERTICAL;else if('HORIZONTAL' === (orientation + '').toUpperCase())orientation = LinearLayout.HORIZONTAL;}if(this.mOrientation != orientation){this.mOrientation = orientation;this.requestLayout();}}},{key:"getOrientation",value:function getOrientation(){return this.mOrientation;}},{key:"setGravity",value:function setGravity(gravity){if(this.mGravity != gravity){if((gravity & Gravity.HORIZONTAL_GRAVITY_MASK) == 0){gravity |= Gravity.LEFT;}if((gravity & Gravity.VERTICAL_GRAVITY_MASK) == 0){gravity |= Gravity.TOP;}this.mGravity = gravity;this.requestLayout();}}},{key:"setHorizontalGravity",value:function setHorizontalGravity(horizontalGravity){var gravity=horizontalGravity & Gravity.HORIZONTAL_GRAVITY_MASK;if((this.mGravity & Gravity.HORIZONTAL_GRAVITY_MASK) != gravity){this.mGravity = this.mGravity & ~Gravity.HORIZONTAL_GRAVITY_MASK | gravity;this.requestLayout();}}},{key:"setVerticalGravity",value:function setVerticalGravity(verticalGravity){var gravity=verticalGravity & Gravity.VERTICAL_GRAVITY_MASK;if((this.mGravity & Gravity.VERTICAL_GRAVITY_MASK) != gravity){this.mGravity = this.mGravity & ~Gravity.VERTICAL_GRAVITY_MASK | gravity;this.requestLayout();}}},{key:"generateDefaultLayoutParams",value:function generateDefaultLayoutParams(){var LayoutParams=LinearLayout.LayoutParams;if(this.mOrientation == LinearLayout.HORIZONTAL){return new LayoutParams(LayoutParams.WRAP_CONTENT,LayoutParams.WRAP_CONTENT);}else if(this.mOrientation == LinearLayout.VERTICAL){return new LayoutParams(LayoutParams.MATCH_PARENT,LayoutParams.WRAP_CONTENT);}return _get(Object.getPrototypeOf(LinearLayout.prototype),"generateDefaultLayoutParams",this).call(this);}},{key:"generateLayoutParams",value:function generateLayoutParams(p){return new LinearLayout.LayoutParams(p);}},{key:"checkLayoutParams",value:function checkLayoutParams(p){return p instanceof LinearLayout.LayoutParams;}}]);return LinearLayout;})(ViewGroup);LinearLayout.HORIZONTAL = 0;LinearLayout.VERTICAL = 1;LinearLayout.SHOW_DIVIDER_NONE = 0;LinearLayout.SHOW_DIVIDER_BEGINNING = 1;LinearLayout.SHOW_DIVIDER_MIDDLE = 2;LinearLayout.SHOW_DIVIDER_END = 4;LinearLayout.VERTICAL_GRAVITY_COUNT = 4;LinearLayout.INDEX_CENTER_VERTICAL = 0;LinearLayout.INDEX_TOP = 1;LinearLayout.INDEX_BOTTOM = 2;LinearLayout.INDEX_FILL = 3;widget.LinearLayout = LinearLayout;(function(LinearLayout){var LayoutParams=(function(_android$view$ViewGroup$MarginLayoutParams){_inherits(LayoutParams,_android$view$ViewGroup$MarginLayoutParams);function LayoutParams(){_classCallCheck(this,LayoutParams);_get(Object.getPrototypeOf(LayoutParams.prototype),"constructor",this).call(this);this.weight = 0;this.gravity = -1;for(var _len29=arguments.length,args=Array(_len29),_key29=0;_key29 < _len29;_key29++) {args[_key29] = arguments[_key29];}if(args.length === 1 && args[0] instanceof LayoutParams){this.gravity = args[0].gravity;}else {var width=args[0];var height=args[1];var _args$212=args[2];var weight=_args$212 === undefined?0:_args$212;_get(Object.getPrototypeOf(LayoutParams.prototype),"constructor",this).call(this,width,height);this.weight = weight;}}_createClass(LayoutParams,[{key:"_createAttrChangeHandler",value:function _createAttrChangeHandler(mergeHandler){_get(Object.getPrototypeOf(LayoutParams.prototype),"_createAttrChangeHandler",this).call(this,mergeHandler);var params=this;mergeHandler.add(Object.defineProperties({},{gravity:{set:function set(value){params.gravity = View.AttrChangeHandler.parseGravity(value,params.gravity);},configurable:true,enumerable:true},weight:{set:function set(value){value = Number.parseInt(value);if(Number.isInteger(value))params.weight = value;},configurable:true,enumerable:true}}));}}]);return LayoutParams;})(android.view.ViewGroup.MarginLayoutParams);LinearLayout.LayoutParams = LayoutParams;})(LinearLayout = widget.LinearLayout || (widget.LinearLayout = {}));})(widget = android.widget || (android.widget = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/10/26.
 */ ///<reference path="../view/View.ts"/>
///<reference path="../view/Gravity.ts"/>
///<reference path="../content/res/Resources.ts"/>
///<reference path="../graphics/Color.ts"/>
///<reference path="../content/res/ColorStateList.ts"/>
///<reference path="../util/TypedValue.ts"/>
var android;(function(android){var widget;(function(widget){var View=android.view.View;var Gravity=android.view.Gravity;var Resources=android.content.res.Resources;var Color=android.graphics.Color;var ColorStateList=android.content.res.ColorStateList;var MeasureSpec=View.MeasureSpec;var TypedValue=android.util.TypedValue;var TextView=(function(_View){_inherits(TextView,_View);function TextView(){_classCallCheck(this,TextView);_get(Object.getPrototypeOf(TextView.prototype),"constructor",this).call(this);this.mSingleLine = false;this.mTextColor = ColorStateList.valueOf(Color.BLACK);this.mCurTextColor = Color.BLACK;this.mHintColor = Color.LTGRAY;this.mSpacingMult = 1.2;this.mSpacingAdd = 0;this.mMaxWidth = Number.MAX_SAFE_INTEGER;this.mMaxHeight = Number.MAX_SAFE_INTEGER;this.mMaxLineCount = Number.MAX_SAFE_INTEGER;this.mMinLineCount = 0;this.initTextElement();this.setTextSize(TextView.Default_TextSize);this.setGravity(Gravity.TOP | Gravity.LEFT);}_createClass(TextView,[{key:"createAttrChangeHandler",value:function createAttrChangeHandler(mergeHandler){_get(Object.getPrototypeOf(TextView.prototype),"createAttrChangeHandler",this).call(this,mergeHandler);var textView=this;mergeHandler.add(Object.defineProperties({},{textColorHighlight:{set:function set(value){},configurable:true,enumerable:true},textColor:{set:function set(value){if(value.startsWith('@')){}else if(value.startsWith('rgb(')){value = value.replace('rgb(','').replace(')','');var parts=value.split(',');textView.setTextColor(Color.rgb(Number.parseInt(parts[0]),Number.parseInt(parts[1]),Number.parseInt(parts[2])));}else if(value.startsWith('rgba(')){value = value.replace('rgba(','').replace(')','');var parts=value.split(',');textView.setTextColor(Color.rgba(Number.parseInt(parts[0]),Number.parseInt(parts[1]),Number.parseInt(parts[2]),Number.parseInt(parts[2])));}else {if(value.startsWith('#') && value.length === 4){value = '#' + value[1] + value[1] + value[2] + value[2] + value[2] + value[2];}try{textView.setTextColor(Color.parseColor(value));}catch(e) {}}},configurable:true,enumerable:true},textColorHint:{set:function set(value){},configurable:true,enumerable:true},textSize:{set:function set(value){value = TypedValue.complexToDimensionPixelSize(value,0,Resources.getDisplayMetrics());textView.setTextSize(value);},configurable:true,enumerable:true},textStyle:{set:function set(value){},configurable:true,enumerable:true},textAllCaps:{set:function set(value){},configurable:true,enumerable:true},drawableLeft:{set:function set(value){},configurable:true,enumerable:true},drawableTop:{set:function set(value){},configurable:true,enumerable:true},drawableRight:{set:function set(value){},configurable:true,enumerable:true},drawableBottom:{set:function set(value){},configurable:true,enumerable:true},drawablePadding:{set:function set(value){},configurable:true,enumerable:true},maxLines:{set:function set(value){value = Number.parseInt(value);if(Number.isInteger(value))textView.setMaxLines(value);},configurable:true,enumerable:true},maxHeight:{set:function set(value){value = Number.parseInt(value);if(Number.isInteger(value))textView.setMaxHeight(value);},configurable:true,enumerable:true},lines:{set:function set(value){value = Number.parseInt(value);if(Number.isInteger(value))textView.setLines(value);},configurable:true,enumerable:true},height:{set:function set(value){value = Number.parseInt(value);if(Number.isInteger(value))textView.setHeight(value);},configurable:true,enumerable:true},minLines:{set:function set(value){value = Number.parseInt(value);if(Number.isInteger(value))textView.setMinLines(value);},configurable:true,enumerable:true},minHeight:{set:function set(value){value = Number.parseInt(value);if(Number.isInteger(value))textView.setMinimumHeight(value);},configurable:true,enumerable:true},maxWidth:{set:function set(value){value = Number.parseInt(value);if(Number.isInteger(value))textView.setMaxWidth(value);},configurable:true,enumerable:true},width:{set:function set(value){value = Number.parseInt(value);if(Number.isInteger(value))textView.setWidth(value);},configurable:true,enumerable:true},minWidth:{set:function set(value){value = Number.parseInt(value);if(Number.isInteger(value))textView.setMinimumWidth(value);},configurable:true,enumerable:true},gravity:{set:function set(value){textView.setGravity(View.AttrChangeHandler.parseGravity(value,textView.mGravity));},configurable:true,enumerable:true},text:{set:function set(value){textView.setText(value);},configurable:true,enumerable:true},singleLine:{set:function set(value){if(View.AttrChangeHandler.parseBoolean(value,false))textView.setSingleLine();},configurable:true,enumerable:true},textScaleX:{set:function set(value){},configurable:true,enumerable:true},lineSpacingExtra:{set:function set(value){value = Number.parseInt(value);if(Number.isInteger(value))textView.setLineSpacing(value,textView.mSpacingMult);},configurable:true,enumerable:true},lineSpacingMultiplier:{set:function set(value){value = Number.parseInt(value);if(Number.isInteger(value))textView.setLineSpacing(textView.mSpacingAdd,value);},configurable:true,enumerable:true}}));}},{key:"initTextElement",value:function initTextElement(){this.mTextElement = document.createElement('div');this.mTextElement.style.position = "absolute";this.mTextElement.style.boxSizing = "border-box";this.mTextElement.style.overflow = "hidden";this.mTextElement.style.opacity = "0";}},{key:"onLayout",value:function onLayout(changed,left,top,right,bottom){_get(Object.getPrototypeOf(TextView.prototype),"onLayout",this).call(this,changed,left,top,right,bottom);this.mTextElement.style.opacity = "";}},{key:"onFinishInflate",value:function onFinishInflate(){var _this12=this;_get(Object.getPrototypeOf(TextView.prototype),"onFinishInflate",this).call(this);Array.from(this.bindElement.childNodes).forEach(function(item){_this12.bindElement.removeChild(item);_this12.mTextElement.appendChild(item);});this.bindElement.appendChild(this.mTextElement);}},{key:"onMeasure",value:function onMeasure(widthMeasureSpec,heightMeasureSpec){var widthMode=MeasureSpec.getMode(widthMeasureSpec);var heightMode=MeasureSpec.getMode(heightMeasureSpec);var widthSize=MeasureSpec.getSize(widthMeasureSpec);var heightSize=MeasureSpec.getSize(heightMeasureSpec);var width=undefined,height=undefined;var padLeft=this.getCompoundPaddingLeft();var padTop=this.getCompoundPaddingTop();var padRight=this.getCompoundPaddingRight();var padBottom=this.getCompoundPaddingBottom();this.mTextElement.style.height = "";this.mTextElement.style.width = "";if(widthMode == MeasureSpec.EXACTLY){width = widthSize;}else {width = this.mTextElement.offsetWidth;width += padLeft + padRight;width = Math.min(width,this.mMaxWidth);width = Math.max(width,this.getSuggestedMinimumWidth());if(widthMode == MeasureSpec.AT_MOST){width = Math.min(widthSize,width);}}var unpaddedWidth=width - padLeft - padRight;this.mTextElement.style.width = unpaddedWidth + 2 + "px";this.mTextElement.style.left = padLeft + 1 + "px";if(heightMode == MeasureSpec.EXACTLY){height = heightSize;var pad=this.getCompoundPaddingTop() + this.getCompoundPaddingBottom();if(this.mMaxLineCount < Number.MAX_SAFE_INTEGER){var maxHeightWithLineCount=pad + this.mMaxLineCount * this.getLineHeight();height = Math.min(maxHeightWithLineCount,height);}}else {var desired=this.getDesiredHeight();height = desired;if(heightMode == MeasureSpec.AT_MOST){height = Math.min(desired,heightSize);}}var contextHeight=height - padTop - padBottom;var textHeight=this.mTextElement.offsetHeight;var finalTop=padTop;if(textHeight < contextHeight){var verticalGravity=this.mGravity & Gravity.VERTICAL_GRAVITY_MASK;switch(verticalGravity){case Gravity.CENTER_VERTICAL:finalTop += (contextHeight - textHeight) / 2;break;case Gravity.BOTTOM:finalTop += contextHeight - textHeight;break;case Gravity.TOP:break;}contextHeight = textHeight;}this.mTextElement.style.height = contextHeight + "px";this.mTextElement.style.top = finalTop + "px";this.setMeasuredDimension(width,height);}},{key:"getDesiredHeight",value:function getDesiredHeight(){var desired=this.mTextElement.offsetHeight;var pad=this.getCompoundPaddingTop() + this.getCompoundPaddingBottom();desired += pad;desired = Math.min(this.mMaxHeight,desired);if(this.mMaxLineCount < Number.MAX_SAFE_INTEGER){var maxHeightWithLineCount=pad + this.mMaxLineCount * this.getLineHeight();desired = Math.min(maxHeightWithLineCount,desired);}if(this.mMinLineCount > 0){var minHeightWithLineCount=pad + this.mMinLineCount * this.getLineHeight();desired = Math.max(minHeightWithLineCount,desired);}desired = Math.max(desired,this.getSuggestedMinimumHeight());return desired;}},{key:"onDraw",value:function onDraw(canvas){var r=Color.red(this.mCurTextColor);var g=Color.green(this.mCurTextColor);var b=Color.blue(this.mCurTextColor);var a=Color.alpha(this.mCurTextColor);this.mTextElement.style.color = "rgba(" + r + ", " + g + ", " + b + ", " + a / 255 + ")";return _get(Object.getPrototypeOf(TextView.prototype),"onDraw",this).call(this,canvas);}},{key:"setTextColor",value:function setTextColor(color){if(Number.isInteger(color)){this.mTextColor = ColorStateList.valueOf(color);}else {if(color === null || color === undefined){throw new Error('colors is null');}this.mTextColor = color;}this.updateTextColors();}},{key:"getTextColors",value:function getTextColors(){return this.mTextColor;}},{key:"getCurrentTextColor",value:function getCurrentTextColor(){return this.mCurTextColor;}},{key:"updateTextColors",value:function updateTextColors(){var inval=false;var color=this.mTextColor.getColorForState(this.getDrawableState(),0);if(color != this.mCurTextColor){this.mCurTextColor = color;inval = true;}if(inval){this.invalidate();}}},{key:"getCompoundPaddingTop",value:function getCompoundPaddingTop(){return this.mPaddingTop;}},{key:"getCompoundPaddingBottom",value:function getCompoundPaddingBottom(){return this.mPaddingBottom;}},{key:"getCompoundPaddingLeft",value:function getCompoundPaddingLeft(){return this.mPaddingLeft;}},{key:"getCompoundPaddingRight",value:function getCompoundPaddingRight(){return this.mPaddingRight;}},{key:"setGravity",value:function setGravity(gravity){switch(gravity & Gravity.HORIZONTAL_GRAVITY_MASK){case Gravity.CENTER_HORIZONTAL:this.mTextElement.style.textAlign = "center";break;case Gravity.RIGHT:this.mTextElement.style.textAlign = "right";break;case Gravity.LEFT:this.mTextElement.style.textAlign = "left";break;}if((gravity & Gravity.VERTICAL_GRAVITY_MASK) != (this.mGravity & Gravity.VERTICAL_GRAVITY_MASK)){this.requestLayout();}this.mGravity = gravity;}},{key:"setLineSpacing",value:function setLineSpacing(add,mult){if(this.mSpacingAdd != add || this.mSpacingMult != mult){this.mSpacingAdd = add;this.mSpacingMult = mult;this.setTextSize(this.mTextSize);}}},{key:"setTextSize",value:function setTextSize(size){var sizeInPx=size * Resources.getDisplayMetrics().density;this.mTextSize = sizeInPx;this.mTextElement.style.fontSize = sizeInPx + "px";this.mTextElement.style.lineHeight = this.getLineHeight() + "px";}},{key:"getLineHeight",value:function getLineHeight(){return Math.ceil(this.mTextSize * this.mSpacingMult + this.mSpacingAdd);}},{key:"setHeight",value:function setHeight(pixels){this.mMaxHeight = pixels;this.setMinimumHeight(pixels);this.requestLayout();this.invalidate();}},{key:"setMaxLines",value:function setMaxLines(max){this.mMaxLineCount = max;this.requestLayout();this.invalidate();}},{key:"getMaxLines",value:function getMaxLines(){return this.mMaxLineCount;}},{key:"setMaxHeight",value:function setMaxHeight(maxHeight){this.mMaxHeight = maxHeight;this.requestLayout();this.invalidate();}},{key:"getMaxHeight",value:function getMaxHeight(){return this.mMaxHeight;}},{key:"setMaxWidth",value:function setMaxWidth(maxpixels){this.mMaxWidth = maxpixels;this.requestLayout();this.invalidate();}},{key:"getMaxWidth",value:function getMaxWidth(){return this.mMaxWidth;}},{key:"setWidth",value:function setWidth(pixels){this.mMaxWidth = pixels;this.setMinimumWidth(pixels);this.requestLayout();this.invalidate();}},{key:"setMinLines",value:function setMinLines(min){this.mMinLineCount = min;this.requestLayout();this.invalidate();}},{key:"getMinLines",value:function getMinLines(){return this.mMinLineCount;}},{key:"setSingleLine",value:function setSingleLine(){var singleLine=arguments.length <= 0 || arguments[0] === undefined?true:arguments[0];if(singleLine)this.setLines(1);else {this.mMaxLineCount = Number.MAX_SAFE_INTEGER;this.mMinLineCount = 0;this.requestLayout();this.invalidate();}}},{key:"setLines",value:function setLines(lines){this.mMaxLineCount = this.mMinLineCount = lines;this.requestLayout();this.invalidate();}},{key:"setText",value:function setText(){var text=arguments.length <= 0 || arguments[0] === undefined?'':arguments[0];this.mTextElement.innerText = text;this.requestLayout();}},{key:"setHtml",value:function setHtml(html){this.mTextElement.innerHTML = html;this.requestLayout();}}]);return TextView;})(View);TextView.Default_TextSize = 14;widget.TextView = TextView;})(widget = android.widget || (android.widget = {}));})(android || (android = {})); /**
 * Created by linfaxin on 15/10/6.
 */ //use the deepest sub class as enter
///<reference path="android/view/ViewOverlay.ts"/>
///<reference path="android/app/Activity.ts"/>
///<reference path="android/widget/FrameLayout.ts"/>
///<reference path="android/widget/ScrollView.ts"/>
///<reference path="android/widget/LinearLayout.ts"/>
///<reference path="android/widget/TextView.ts"/>
///<reference path="runtime/AndroidUI.ts"/>
window["android"] = android;window["java"] = java;window["runtime"] = runtime;

//# sourceMappingURL=android-web-widget.es5.js.map